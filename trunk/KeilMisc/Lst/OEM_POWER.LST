C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 1   


C51 COMPILER V8.12, COMPILATION OF MODULE OEM_POWER
OBJECT MODULE PLACED IN Code\OEM\OEM_POWER.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Code\OEM\OEM_POWER.C LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Code\CORE\I
                    -NCLUDE\;.\Code\OEM\INCLUDE\;.\Code\CHIP\INCLUDE\)

line level    source

   1          /*----------------------------------------------------------------------------
   2           * Filename: OEM_Power.C  For Chipset: ITE.IT85XX
   3           *
   4           * Function: Power sequnce control function example
   5           *
   6           * Author  : Dino
   7           *
   8           * Copyright (c) 2009 - , ITE Tech. Inc. All Rights Reserved.
   9           *
  10           * Note : These functions are reference only.
  11           *        Please follow your project software specification to do some modification.
  12           *---------------------------------------------------------------------------*/
  13          
  14          #include <CORE_INCLUDE.H>
  15          #include <OEM_INCLUDE.H>
  16          
  17          
  18          void S5S0_AC_PRESENT_EN(void) ;
  19          
  20          
  21          // ----------------------------------------------------------------------------
  22          // To read variable [RSTStatus] to get EC reset source
  23          // ----------------------------------------------------------------------------
  24          void CheckResetSource(void)
  25          {
  26   1      //add debug information for EC reset status(1.external watch-dog, 2.internal watch-dog; 3. EC VSTBY or WRS
             -T reset,4.EC code reset).
  27   1              RamDebug(0xBB); //ANGELAS089:add
  28   1              RamDebug(RSTStatus);
  29   1              RamDebug(GPCRA0);
  30   1              RamDebug(PWRSW8SRST);  //ANGELAS089:add
  31   1              RamDebug(0xBB);     //ANGELAS089:add
  32   1              switch(RSTStatus&0x03)
  33   1              {
  34   2              case 0:
  35   2              case 1:
  36   2                      if(GPCRA0==0x80)
  37   2                      {
  38   3                              ShutDnCause = SC_ECColdBoot;
  39   3                      }
  40   2                      else
  41   2                      {
  42   3                              ShutDnCause = SC_EC_0x0000;
  43   3                      }
  44   2                      break;
  45   2                                      
  46   2              case 2:
  47   2                      if(GPCRA0==0x80)
  48   2                      {
  49   3                              ShutDnCause = SC_IntWatchDog;
  50   3                      }
  51   2                      else
  52   2                      {
  53   3                              ShutDnCause = SC_EC_0x0000;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 2   

  54   3                      }
  55   2                      break;             
  56   2              
  57   2              case 3:
  58   2                      if(GPCRA0==0x80)
  59   2                      {
  60   3                              ShutDnCause = SC_ExtWatchDog;
  61   3                      }
  62   2                      else
  63   2                      {
  64   3                              ShutDnCause = SC_EC_0x0000;
  65   3                      }
  66   2                      break;
  67   2              }
  68   1              
  69   1              //ANGELAS089 add start
  70   1              if(IS_MASK_SET(PWRSW8SRST,BIT(1)))
  71   1              {
  72   2              ShutDnCause = SC_EC8SRESET;
  73   2              }
  74   1              //ANGELAS089 add end
  75   1              
  76   1      //add debug information for EC reset status(1.external watch-dog, 2.internal watch-dog; 3. EC VSTBY or WRS
             -T reset,4.EC code reset).             
  77   1      }
  78          
  79          void Check_LPC_Reset(void)
  80          {
  81   1              if(!Read_LPC_RST())
  82   1              {
  83   2                      //GATEA20_HI();
  84   2                      CLEAR_MASK(KBHISR,SYSF);
  85   2                  CLEAR_MASK(SYS_MISC1,ACPI_OS);
  86   2                      OEM_LPC_Reset();        // initial OEM status.
  87   2                      //fixed reboot systen TP device lost when disable TP without driver
  88   2                      TPCLK_OUTPUT;
  89   2              TPCLK_HI();
  90   2              TPCLK_ALT;
  91   2                      //LPCRSTCnt++;
  92   2              }
  93   1      }
  94          
  95          void OEM_LPC_Reset(void)
  96          {
  97   1              BYTE BSLI_Det;
  98   1              uReserve07.fbit.nTPDriverIn = 0;
  99   1              uReserve07.fbit.nVPCDriverIn = 0;
 100   1              uReserve07.fbit.nFanManual = 0; //ANGELAS030:Clear thermal tool flag under S3/S4/S5. return EC control
 101   1              //SYS_STATUS &= 0xF8;                   // Clear OS mode.
 102   1              CPU_TYPE &= 0x3f;//CLEAR BIT6 and BIT7 Unit abnormal shuntdown will not clear GPU flag,so when enter S5,W
             -B and S3 we clear GPU flag to not read GPU temperature.
 103   1              SET_MASK(pDevStus, pENABLE_TP); // Turn on TouchPad.
 104   1              //CMOS_Cam_ON();                                        // Turn on Camera power.
 105   1              CLR_MASK(cCmd, b3BkOff);                // Turn on backlight.
 106   1              CLR_MASK(OEMControl, b1BkOff);  //ANGELAG005:add
 107   1              SMartNoise = 0x04;                              // Stop Fan Dust mode.
 108   1              BackLight_En_Delay = 40;                        //:Increase lit backlight time for reboot.//:Panel background light delay abou
             -t 1s after Lenovo logo show out when reboot change 40 to 3. //:Remove  CHANGE 3 TO 40 
 109   1              //if (IS_MASK_SET(LENOVOPMFW,BATTERY_MAIN_CAL))
 110   1              //{
 111   1                      CLEAR_MASK(LENOVOPMFW,BATTERY_MAIN_CAL);
 112   1                      CLEAR_MASK(LENOVOPMFW,BATTERY_CAL_END);
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 3   

 113   1                      LENOVOPMFW_Temp = 0;
 114   1              CLEAR_MASK(ACOFF_SOURCE, BATTLEARN);
 115   1              // ACOFF_LOW();
 116   1              //}
 117   1              //uNovoVPCCount = 0;                    // Clear NOVO VPC status.    ANGELAS004 Remove  clear novo button status when LPC 
             -reset function.
 118   1      
 119   1              //#if SupportReadTPID
 120   1              //ReadTPid();
 121   1              //#endif
 122   1      //ANGELAG008: add start
 123   1                      CLEAR_MASK(pDevStatus3,b6EnDisTPSend);
 124   1              CLEAR_MASK(pDevStatus3,b7TPStateFormer);
 125   1      
 126   1              
 127   1                      CLEAR_MASK(pDevStatus1,b0F6ScanCodeSend);
 128   1      
 129   1                      CLEAR_MASK(pDevStatus1,b1F6DisableTP);
 130   1      
 131   1              CLEAR_MASK(pDevStatus1,b4LNVAPP_STATUS);
 132   1                CLEAR_MASK(pDevStatus1,b5TPDRIVER_STATUS);
 133   1              CLEAR_MASK(pDevStatus1,b6MODE_STATUS);
 134   1              CLEAR_MASK(pDevStatus1,b7DisableTP);
 135   1      //ANGELAG008: add end
 136   1              //GPU_Prochot = 0; //ANGELAG033: remove //ANGELAG028: add
 137   1              DisCPUTurboFor90s=90;                         //COKEYXU029:add
 138   1              CLR_MASK(uVGATurboFun, uDisCPUTurboOK);      //COKEYXU029: add
 139   1      }
 140          
 141          void Charge_inhibit2sec(void)
 142          {
 143   1              inhibit2sec = 20;               // 100ms*20 = 2000ms
 144   1              SET_MASK(nStopChgStat3L,ENCHARGESUSP);          // use for detect battery charging suspend
 145   1              CHGIC_ptr = 2;
 146   1              WriteSmartChgIC();
 147   1      }
 148          
 149          void CHK_SUSACK(void)
 150          {
 151   1      #if 0
                      if(!Read_SUSWARN())
                      {
                              if (Read_SUSACK())
                              {
                                      if (SUSACK_LOW_CNT > 500)  //for DS3 test
                                      {
                                              SUSACK_LOW();
                                      }
                                      else
                                      {
                                              SUSACK_LOW_CNT++;
                                      }
                              }
                              else
                              {       SUSACK_LOW_CNT = 0;     }
                      }
                      else
                      {
                              if (!Read_SUSACK())
                              {
                                      if (SUSACK_HI_CNT > 20)
                                      {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 4   

                                              SUSACK_HI();
                                      }
                                      else
                                      {
                                              SUSACK_HI_CNT++;
                                      }
                              }
                              else
                              {       SUSACK_HI_CNT = 0;              }
                      }
              #endif
 185   1      }
 186          
 187          #if 0
              void CHK_DRAMRST_CNTRL(void)
              {
                      if (Read_VR_ON())
                      {
                              if (!Read_DRAMRST_CNTRL_EC())
                              {
                                      if (DRAMRST_CNTRL_CNT > 200)
                                      {
                                              DRAMRST_CNTRL_EC_HI();
                                      }
                                      else
                                      {
                                              DRAMRST_CNTRL_CNT++;
                                      }
                              }
                      }
                      else
                      { DRAMRST_CNTRL_CNT = 0; }
              
                      if (!Read_SLPS3())
                      {
                              if ( SysPowState != SYSTEM_S5_S0 )
                              {
                                      DRAMRST_CNTRL_EC_LOW();
                                      DRAMRST_CNTRL_CNT = 0;
                              }
              /*
                              if (DRAMRST_CNTRL_LOW_CNT > 20)
                              {
                                      DRAMRST_CNTRL_EC_LOW();
                              }
                              else
                              {
                                      DRAMRST_CNTRL_LOW_CNT++;
                              }
              */
                      }
                      else
                      { DRAMRST_CNTRL_LOW_CNT = 0; }
              }
              #endif
 229          
 230          
 231          //============S5 -> DSX==========================================================
 232          
 233          void S5DSX_RSMRST_LOW()
 234          {
 235   1          RSMRST_LOW();
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 5   

 236   1      }
 237          
 238          void S5DSX_PCH_PWR_EN_OFF()
 239          {
 240   1          PCH_PWR_EN_OFF();
 241   1      
 242   1      }
 243          
 244          void S5DSX_EC_ON_LOW()
 245          {
 246   1          EC_ON_LOW(); 
 247   1      }
 248          
 249          void S5DSX_PWR_BTN_LOW()
 250          {
 251   1          PM_PWRBTN_LOW();
 252   1      }
 253          
 254          
 255          void Enter_ShipMode()
 256          {
 257   1      #if shipmodesupport
 258   1          if((ShipModeEn == 0xA5) || IS_MASK_SET(EMStatusBit2, b0SetBatteryShipMode)) 
 259   1          {
 260   2              //JIMAPLO022     ShipModeEn=0x00;
 261   2              SET_MASK(BATTUPDATEFW, PriBattInhib);//JIMAPLO042
 262   2              Delay1MS(200); //JIMAPLO042
 263   2              Delay1MS(100); //JIMAPLO042
 264   2              Delay1MS(250); //MARTINO004:add
 265   2              Delay1MS(250); //MARTINO004:add
 266   2              Delay1MS(250); //MARTINO004:add
 267   2              Delay1MS(250); //MARTINO004:add
 268   2              Lock_ShipMode();
 269   2              //MARTINO016:add start
 270   2              Delay1MS(250);  
 271   2              Delay1MS(250);  
 272   2              Delay1MS(250);  
 273   2              Delay1MS(250);  
 274   2              //MARTINO016:add end
 275   2          }
 276   1      #endif
 277   1      }
 278          
 279          void RecordenEnterShipMode()
 280          {
 281   1      #if shipmodesupport
 282   1          if((ShipModeEn==0xA5)||IS_MASK_SET(EMStatusBit2,b0SetBatteryShipMode))
 283   1          {
 284   2              ShipModeEn=0x00; 
 285   2              ProcessSID(0xA6);
 286   2              if(nBattGasgauge < 95)
 287   2              {
 288   3                  ProcessSID(0xA8);
 289   3                  while(1);
 290   3              }
 291   2              CLEAR_MASK(BATTUPDATEFW,PriBattInhib);//JIMAPLO042:add  
 292   2          }
 293   1      #endif
 294   1      }
 295          
 296          void S5DSX_Init_Status()
 297          {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 6   

 298   1          //Check_G3_S0_Delay = 0;//JIMAPLO00F
 299   1          PowerInitOK=0;
 300   1          SysPowState = SYSTEM_DSX;
 301   1          RamDebug(0x0C);
 302   1      }
 303          
 304          const sPowerSEQ code asPowerSEQS5DSX[]=
 305          {
 306              {0x0000,                        0,        0,    },
 307              {S5DSX_RSMRST_LOW,        5,        0,    },
 308              {S5DSX_PCH_PWR_EN_OFF,    2,        0,    },
 309              {S5DSX_EC_ON_LOW,        0,        0,    },
 310              //{S5DSX_PMIC_Disable,        0,        0,    },
 311              {S5DSX_PWR_BTN_LOW,        5,        0,    },
 312              
 313              {Enter_ShipMode,            120,        0,    },
 314              {RecordenEnterShipMode,        20,        0,    },
 315              {S5DSX_Init_Status,            0,        0,    },
 316          };
 317          
 318          void Oem_S5DSXSequence(void)
 319          {
 320   1          if(PowSeqDelay != 0x00 )
 321   1          {
 322   2              PowSeqDelay--;
 323   2              if(PowSeqDelay != 0x00 )
 324   2              {
 325   3                  return;
 326   3              }
 327   2          }
 328   1      
 329   1          while(PWSeqStep<(sizeof(asPowerSEQS5DSX)/sizeof(sPowerSEQ)))
 330   1          {
 331   2              if(asPowerSEQS5DSX[PWSeqStep].checkstatus==0x00) // Do function
 332   2              {
 333   3                  (asPowerSEQS5DSX[PWSeqStep].func)();
 334   3                  PowSeqDelay = asPowerSEQS5DSX[PWSeqStep].delay;
 335   3                  PWSeqStep++;
 336   3                  if(PowSeqDelay!=0x00)
 337   3                  {
 338   4                      break;
 339   4                  }
 340   3              }
 341   2              else    // Check input status pin
 342   2              {
 343   3                  if((asPowerSEQS5DSX[PWSeqStep].func)())
 344   3                  {
 345   4                      PowSeqDelay = asPowerSEQS5DSX[PWSeqStep].delay;
 346   4                      PWSeqStep++;
 347   4                  }
 348   3                  break;
 349   3              }
 350   2          }
 351   1      }
 352          
 353          
 354          //============DSX -> S5==========================================================
 355          void DSXS5_EC_ON_HI(void)
 356          {
 357   1          EC_ON_HI(); 
 358   1      }
 359          
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 7   

 360          BYTE DSXS5_PMIC_Init(void)
 361          {
 362   1          InitPMIC(); 
 363   1          return PowerInitOK;
 364   1       
 365   1      }
 366          
 367          void DSXS5_PWR_BTN_HI(void)
 368          {
 369   1          PM_PWRBTN_HI(); 
 370   1      }
 371          
 372          void DSXS5_PCH_PWR_EN(void)
 373          {
 374   1          PCH_PWR_EN_ON(); 
 375   1      }
 376          
 377          void DSXS5_RSMRST_HI(void)
 378          {
 379   1          RSMRST_HI(); 
 380   1      }
 381          
 382          void DSXS5_Init_Status(void)
 383          {  
 384   1          if(IS_MASK_SET(SYS_STATUS, AC_ADP))
 385   1          {
 386   2              if(SystemIsS0)
 387   2              {
 388   3                  AC_PRESENT_HI();
 389   3      
 390   3              }
 391   2          }
 392   1      
 393   1          SysPowState = SYSTEM_S5;
 394   1          RamDebug(0x0B);
 395   1      }
 396          
 397          const sPowerSEQ code asPowerSEQDSXS5[]=
 398          {
 399              { 0x0000,                    0,        0,    },
 400              { DSXS5_EC_ON_HI,            0,        0,    },
 401          
 402              { DSXS5_PMIC_Init,        0,        1,    },
 403              { DSXS5_PWR_BTN_HI,        1,        0,    },
 404          
 405              { DSXS5_PCH_PWR_EN,        30,        0,    },
 406          
 407              { DSXS5_RSMRST_HI,            20,        0,    },
 408              
 409              { S5S0_AC_PRESENT_EN,            1,        0,    },
 410              
 411              { DSXS5_Init_Status,            0,        0,    },
 412          };
 413          
 414          void Oem_DSXS5Sequence(void)
 415          {
 416   1          if(PowSeqDelay != 0x00 )
 417   1          {
 418   2              PowSeqDelay--;
 419   2              if(PowSeqDelay != 0x00 )
 420   2              {
 421   3                  return;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 8   

 422   3              }
 423   2          }
 424   1      
 425   1          while(PWSeqStep<(sizeof(asPowerSEQDSXS5)/sizeof(sPowerSEQ)))
 426   1          {
 427   2              if(asPowerSEQDSXS5[PWSeqStep].checkstatus==0x00) // Do function
 428   2              {
 429   3                  (asPowerSEQDSXS5[PWSeqStep].func)();
 430   3                  PowSeqDelay = asPowerSEQDSXS5[PWSeqStep].delay;
 431   3                  PWSeqStep++;
 432   3                  if(PowSeqDelay!=0x00)
 433   3                  {
 434   4                      break;
 435   4                  }
 436   3              }
 437   2              else    // Check input status pin
 438   2              {
 439   3                  if((asPowerSEQDSXS5[PWSeqStep].func)())
 440   3                  {
 441   4                      PowSeqDelay = asPowerSEQDSXS5[PWSeqStep].delay;
 442   4                      PWSeqStep++;
 443   4                  }
 444   3                  break;
 445   3              }
 446   2          }
 447   1      }
 448          
 449          
 450          //-----------------------------------------------------------------------------
 451          // Handle System Power Control
 452          // Called by service_1mS -> Timer1msEvent -> Hook_Timer1msEvent
 453          //-----------------------------------------------------------------------------
 454          void Oem_SysPowerContrl(void)
 455          {
 456   1              //CHK_SUSACK();
 457   1              //CHK_DRAMRST_CNTRL();
 458   1      
 459   1          // Check current System PowerState to see what should we do.
 460   1          switch (SysPowState)
 461   1          {
 462   2              case SYSTEM_S0:
 463   2                      if(!Read_SLPS3())
 464   2                      {
 465   3                              if (S3S4DelayCnt > 10)
 466   3                              {
 467   4                      PWSeqStep = 1;
 468   4                                      PowSeqDelay = 00;
 469   4                      RamDebug(0xD0);        
 470   4                      SysPowState=SYSTEM_S0_S3;
 471   4                                      //S0S3_VR_ON(); // include SYS_PWROK, PCH_PWROK,VR_ON enable orderly.
 472   4                                      if (!Read_SLPS4())
 473   4                                      {
 474   5                                              PWSeqStep = 1;
 475   5                                              PowSeqDelay = 0x00;
 476   5                          RamDebug(0x0D);
 477   5                                      SysPowState=SYSTEM_S0_S5;
 478   5                                      }
 479   4                                      else if (IS_MASK_SET(SysStatus,CloseLid))
 480   4                                      {
 481   5                                              //CLEAR_MASK(SysStatus,CloseLid);
 482   5                                              SET_MASK(SysStatus,EnterS3Lid);
 483   5                                      }
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 9   

 484   4                              }
 485   3                              else
 486   3                              {       
 487   4                                      S3S4DelayCnt++; 
 488   4                              }
 489   3                      }
 490   2                      else
 491   2                      {       
 492   3                              S3S4DelayCnt = 0;               
 493   3                      }
 494   2                      Check_LPC_Reset();
 495   2                      break;
 496   2      
 497   2              case SYSTEM_S3:
 498   2                              
 499   2                      //S34toDSx();        
 500   2                      //DSxtoS34();      
 501   2              if(Read_SLPS3())  //S3 to S0
 502   2              {
 503   3                  PWSeqStep = 3;
 504   3                          PowSeqDelay = 20;
 505   3                  RamDebug(0x33);   
 506   3                      SysPowState=SYSTEM_S3_S0;
 507   3              }
 508   2                      //ANGELAS025:S+Modify power off sequence.
 509   2                      /*ANGELAS066:remove start
 510   2                      if (!Read_SLPS4())
 511   2                      {
 512   2                              PWSeqStep = 1;
 513   2                              PowSeqDelay = 0x00;
 514   2                              RamDebug(0x0D);
 515   2                              SysPowState=SYSTEM_S0_S5;
 516   2                      }*///ANGELAS066:remove end
 517   2                      //ANGELAS025:S-Modify power off sequence.
 518   2                      // for EM9 adapter detection and protection       
 519   2              if(IS_MASK_SET(SYS_STATUS,b4IllegalAdp)&&Read_AC_IN())
 520   2              {
 521   3                          SET_MASK(SYS_STATUS,AC_ADP);        //set AC in  flag
 522   3                          //ACOFF_LOW();
 523   3                              BATT_LEN_OFF();//JERRYCRZ030¡êo
 524   3              }
 525   2                      //for EM9 adapter detection and protection 
 526   2                      /*
 527   2                      if (!Read_SLPS4() && (DSxPowState == SYSTEM_S3S4))
 528   2                      {
 529   2                              if (S3S4DelayCnt > 100)
 530   2                              {
 531   2                                      PWSeqStep = 1;
 532   2                                      PowSeqDelay = 0x00;
 533   2                                      SysPowState=SYSTEM_S0_S5;
 534   2                              }
 535   2                              else
 536   2                              {       S3S4DelayCnt++; }
 537   2                      }
 538   2                      else
 539   2                      {       S3S4DelayCnt = 0;               }
 540   2                      */
 541   2              break;
 542   2      
 543   2          case SYSTEM_S4:
 544   2          case SYSTEM_S5:
 545   2                      if((Read_SLPS3() && Read_SLPS4())) 
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 10  

 546   2                      {
 547   3                              PWSeqStep = 1;
 548   3                              PowSeqDelay = 0x00;
 549   3                  RamDebug(0x53);
 550   3                              SysPowState=SYSTEM_S5_S0;
 551   3                      }
 552   2                      CheckAutoPowerOn();
 553   2                      // (remove to avoid turn off EC_ON)                     Check_EC_ON();
 554   2                      //ANGELAS031 Check_EC_ON(); //martin0313C+
 555   2                      //ANGELAS032:add start
 556   2      #if shipmodesupport
 557   2                      if((ShipModeEn==0xA5)||IS_MASK_SET(EMStatusBit2,b0SetBatteryShipMode))
 558   2                      {
 559   3                              CLEAR_MASK(ACPI_HOTKEY, b7BIOS_NoShut);
 560   3                              CLEAR_MASK(ACPI_HOTKEY, b6Cmd_NoShut);
 561   3                      }
 562   2                      //ANGELAS032:add end
 563   2      #endif
 564   2                      //MEILING002: S+
 565   2              
 566   2                      if(PowerOTP_REG)
 567   2                      {
 568   3                              if ( IS_MASK_CLEAR(SysStatus, ERR_ShuntDownFlag) ) //ANGELAG007: add
 569   3                              { 
 570   4                              ProcessSID(PMIC_Shutdown_ID); } //ANGELAG007: add
 571   3                              OTP_TEMP = PowerOTP_REG;
 572   3                              PowerOTP_REG = 0;
 573   3                              RSMRST_LOW();
 574   3                              Delay1MS(12);
 575   3                              EC_ON_LOW();
 576   3                              PowerInitOK = 0;
 577   3                              
 578   3                      }
 579   2                      //MEILING002: E+
 580   2              if ((IS_MASK_CLEAR(ACPI_HOTKEY, b7BIOS_NoShut)) && (IS_MASK_CLEAR(ACPI_HOTKEY, b6Cmd_NoShut)) && (
             -LOWBATT_3TIMES==0))
 581   2              {
 582   3                  if ((!Read_AC_IN()) && IS_MASK_CLEAR(cCmd, bPCHPWR_Keep)) 
 583   3                  {
 584   4                      //COKEYXU007:Enable SYSTEM_S5_DSX.
 585   4                      PWSeqStep = 1;
 586   4                      PowSeqDelay = 0x40;
 587   4                      SysPowState=SYSTEM_S5_DSX;
 588   4                  }
 589   3              }
 590   2                      //ANGELAS031:add start
 591   2              /*if(( IS_MASK_CLEAR(ACPI_HOTKEY, b7BIOS_NoShut))&& (IS_MASK_CLEAR(ACPI_HOTKEY, b6Cmd_NoShut))) 
 592   2                      { 
 593   2                          S34toDSx();  
 594   2                      }
 595   2                      DSxtoS34(); 
 596   2              */
 597   2                      //ANGELAS031:add end
 598   2                      //for EM9 adapter detection and protection       
 599   2              if(IS_MASK_SET(SYS_STATUS,b4IllegalAdp)&&Read_AC_IN())
 600   2              {
 601   3                          SET_MASK(SYS_STATUS,AC_ADP);        //set AC in  flag
 602   3                          //   ACOFF_LOW();
 603   3                              BATT_LEN_OFF();//JERRYCRZ030
 604   3              }
 605   2                      //for EM9 adapter detection and protection 
 606   2              break;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 11  

 607   2              
 608   2          case SYSTEM_DSX:
 609   2              CheckAutoPowerOn();
 610   2              if((Read_AC_IN()) || (LOWBATT_3TIMES != 0))
 611   2              {  
 612   3                  PWSeqStep = 1;
 613   3                  PowSeqDelay = 0x00;
 614   3                  SysPowState=SYSTEM_DSX_S5;
 615   3                              //SET_MASK(UMA_ONLY_FLAG, SET_VGA_WA_FLAG);
 616   3              }
 617   2              break;
 618   2          case SYSTEM_DSX_S5:
 619   2              Oem_DSXS5Sequence();
 620   2              break;
 621   2          case SYSTEM_S5_DSX:
 622   2              Oem_S5DSXSequence();
 623   2              break;
 624   2      
 625   2          case SYSTEM_S5_S0:
 626   2                      Oem_S5S0Sequence();
 627   2                      break;
 628   2      
 629   2          case SYSTEM_S3_S0:
 630   2                      Oem_S3S0Sequence();
 631   2              break;
 632   2      
 633   2          case SYSTEM_S0_S3:
 634   2                      Oem_S0S3Sequence();
 635   2                      /*                       
 636   2                      if (!Read_SLPS4())
 637   2                      {
 638   2                              PWSeqStep = 1;
 639   2                              PowSeqDelay = 0x00;
 640   2                              SysPowState=SYSTEM_S0_S5;
 641   2                      }
 642   2                      */
 643   2              break;
 644   2      
 645   2          case SYSTEM_S0_S4:
 646   2              break;
 647   2      
 648   2          case SYSTEM_S0_S5:
 649   2                      Oem_S0S5Sequence();
 650   2              break;
 651   2      
 652   2              case SYSTEM_EC_WDTRST:
 653   2                      break;
 654   2      
 655   2              default:
 656   2              SysPowState=SYSTEM_DSX;     
 657   2                      if(!Read_AC_IN()) 
 658   2                  {
 659   3                  PWSeqStep = 1;
 660   3                  PowSeqDelay = 0x00;
 661   3                  SysPowState = SYSTEM_S5_DSX;
 662   3              }
 663   2                      else 
 664   2                  {
 665   3                  PWSeqStep = 1;
 666   3                  PowSeqDelay = 0x00;
 667   3                  SysPowState = SYSTEM_DSX_S5;
 668   3              }
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 12  

 669   2              break;
 670   2          }
 671   1      }
 672          
 673          void SetS3GPIO(void)
 674          {/*
 675   1              TP_CLK_INDW;            // TP_CLK to Input+pull_DW pin
 676   1              TP_DATA_INDW;           // TP_DATA to Input+pull_DW pin
 677   1              SMBus2_CLK_INDW;        // SMBus2 CLK to Input+pull_DW pin
 678   1              SMBus2_DAT_INDW;        // SMBus2 DATA to Input+pull_DW pin
 679   1              FAN_PWM_INDW;           // Set FAN_PWM input+pull_dw.
 680   1              FAN_SPEED_INDW;         // Set FAN Speed input+pull_dw.
 681   1              //ODD_DA_INDW;          // Set ODD_DA input+pull_dw.
 682   1      */}
 683          
 684          void SetS0GPIO(void)
 685          {
 686   1              SCI_HI();                               //RUNSCI Hi
 687   1              //SMI_HI();                             //GA20 Hi
 688   1              //GATEA20_HI();
 689   1              RCING_HI();
 690   1      
 691   1              //VGA_AC_DET_HI();
 692   1              //LAN_PWR_ON_LO();
 693   1              //CMOS_Cam_ON();                        // Turn on Camera power.
 694   1              //SUSACK_HI();
 695   1              // AOAC_PWRON();                        // Turn on WLAN power.
 696   1              //LED_KB_PWM_ALT;
 697   1      
 698   1              TPCLK_ALT;                              // TP_CLK to alternate pin
 699   1              TP_DATA_ALT;                    // TP_DATA to alternate pin
 700   1              SMBus2_CLK_ALT;                 // SMBus2 CLK to alternate pin
 701   1              SMBus2_DAT_ALT;                 // SMBus2 DATA to alternate pin
 702   1      
 703   1              #if FAN_TABLE_Already
 704   1              FAN_PWM_ALT;                    // Set FAN_PWM Alt.
 705   1              FAN2_PWM_ALT;//JERRYCH00:Modify the fan control from linear to the ladder.
 706   1              #else
                      FAN_PWM_OUT;                    // Set FAN_PWM OUTPUT.
                      EC_FAN_PWM_HI();       
                  FAN2_PWM_OUT;           //ELMERZH002:FAN 2 running at full speed.
                  EC_FAN2_PWM_HI();       //ELMERZH002:FAN 2 running at full speed.
                      #endif  // FAN_TABLE_Already
 712   1      
 713   1              FAN_SPEED_ALT;                  // Set FAN Speed Alt.
 714   1              //ODD_DA_INPUT;
 715   1              InitSio();
 716   1      
 717   1              KBHISR = 0x00;
 718   1              KBHIKDOR = 0x00;
 719   1              CLEAR_MASK(KBHISR,SYSF);
 720   1      
 721   1              SPCTRL1 = 0x83;                 //msmart test
 722   1              BRAM3E =0;
 723   1              BRAM3F =0;
 724   1      
 725   1              PECIDelayCnt = 0x04;
 726   1      
 727   1              Fan_Init();
 728   1              //pDevStus=Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03|0x07),0xE1);
 729   1              //Charge_inhibit2sec();  //LMLKBL0010:remove.
 730   1      
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 13  

 731   1      #if UCS1022_Support
                      USB_CH_OUTPUT;
                      //if ( IS_MASK_CLEAR(USB_Charger, b0USB_EN) )
                      if ( IS_MASK_CLEAR(EMStatusBit, b1SetUSBChgEn) )
                      { USB_CH_LOW(); }
                      CLR_MASK(USB_Charger, b1USB_initOK);
              #endif  // UCS1022_Support
 738   1      
 739   1              if ( IS_MASK_SET(SYS_MISC1, b1Num_LED) )
 740   1              { NUMLED_ON(); }
 741   1              else
 742   1              { NUMLED_OFF(); }
 743   1      }
 744          
 745          void SetS5GPIO(void)
 746          {
 747   1              SCI_LOW();                      //RUNSCI Hi
 748   1              //SMI_LOW();                    //GA20 Hi
 749   1              //GATEA20_LOW();
 750   1              RCING_LOW();
 751   1      
 752   1              TP_CLK_INDW;            // TP_CLK to Input+pull_DW pin
 753   1              TP_DATA_INDW;           // TP_DATA to Input+pull_DW pin
 754   1              SMBus2_CLK_INDW;        // SMBus2 CLK to Input+pull_DW pin
 755   1              SMBus2_DAT_INDW;        // SMBus2 DATA to Input+pull_DW pin
 756   1              FAN_PWM_INDW;           // Set FAN_PWM input+pull_dw.
 757   1              FAN_SPEED_INDW;         // Set FAN Speed input+pull_dw.
 758   1              //ODD_DA_INDW;          // Set ODD_DA input+pull_dw.
 759   1      
 760   1              //VGA_AC_DET_LO();
 761   1              // AOAC_PWROFF();               // Turn off WLAN power.
 762   1              //CMOS_Cam_OFF();               // Turn off Camera power.
 763   1              CAPLED_OFF();           // Turn off Cap LED.
 764   1              NUMLED_OFF();           // Turn off Num LED.
 765   1      
 766   1              //LED_KB_PWM_INPUT;
 767   1      
 768   1              //if ( SysPowState != SYSTEM_S0_S3 ) //ANGELAS063:remove
 769   1              if ( SysPowState == SYSTEM_S0_S5 ) //ANGELAS063:add
 770   1              {
 771   2                      USB_ON_INPUT;   // Disable USB wake.
 772   2              //USB_ON_OUTPUT;   
 773   2              //USB_ON_LOW();     
 774   2                      //LAN_PWR_ON_HI();
 775   2              }
 776   1              else
 777   1              {
 778   2                      if ( IS_MASK_CLEAR(SYS_STATUS,AC_ADP) )
 779   2                      { 
 780   3                              //LAN_PWR_ON_HI(); 
 781   3              }       // turn off LAN power.
 782   2                      else
 783   2                      { 
 784   3                              //LAN_PWR_ON_LO(); 
 785   3              }       // Turn on LAN power.
 786   2                      //Remove turn off USB power enter S3. 
 787   2                      /*if ( IS_MASK_CLEAR(WAKEUP_ENABLE, USBWAKE) )
 788   2                      { 
 789   2                              USB_ON_INPUT; 
 790   2                              //USB_ON_OUTPUT;   
 791   2                              //USB_ON_LOW();             
 792   2                    } // turn off USB power.
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 14  

 793   2                      else*///Remove turn off USB power enter S3. 
 794   2                      {
 795   3                              USB_ON_OUTPUT;
 796   3                              USB_ON_LOW();   // Turn on USB power.
 797   3                      }
 798   2              }
 799   1              AC_IN_INPUT;
 800   1      
 801   1      #if UCS1022_Support
                      //if ( IS_MASK_SET(USB_Charger, b0USB_EN) )
                      if ( IS_MASK_SET(EMStatusBit, b1SetUSBChgEn) )
                      { UCS1002HCACharger_Init(); }
                      else 
                      {
                              if ( SysPowState != SYSTEM_S0_S5 )
                              { UCS1002HCACharger_Init(); }   // Entry S3 status.
                      }
              #endif  // UCS1022_Support
 811   1              CLR_MASK(SYS_MISC1,b5Crisis_LED);       // Clear Crisis LED.
 812   1      }
 813          
 814          //============S5 -> S0==========================================================
 815          BYTE S5S0_STEP1(void)
 816          {
 817   1          CLR_MASK(cCmd, bPCHPWR_Keep);    
 818   1          AutoTimer=0x00; 
 819   1          if(IS_MASK_SET(SysStatus2, b3EC8S_Reset)) 
 820   1              {
 821   2                      CLEAR_MASK(SysStatus2, b3EC8S_Reset);
 822   2              }
 823   1                
 824   1              EC_ON_HI(); //ANGELAS038:add
 825   1              PM_PWRBTN_HI();
 826   1          RamDebug(0x80);
 827   1              return(1);
 828   1      }
 829          
 830          //MEILING002: S+
 831          BYTE S5S0_PMIC_Initial(void)
 832          {
 833   1              InitPMIC(); 
 834   1          RamDebug(0x81);
 835   1              if(!PowerInitOK)
 836   1                      return 0;
 837   1              else
 838   1                      return 1;
 839   1      }
 840          //MEILING002: E+
 841          
 842          
 843          void S5S0_AC_PRESENT_EN(void) 
 844          {
 845   1              uPGID= Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03 | 0x07) ,0xE0); //:Add the difference between G and Z proj
             -ect
 846   1          MBID_FB=uPGID;       
 847   1              PM_PWRBTN_HI();
 848   1          if(IS_MASK_SET(SYS_STATUS,AC_ADP)) 
 849   1          {
 850   2                 AC_PRESENT_HI();
 851   2          } 
 852   1          
 853   1          RamDebug(0x82);
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 15  

 854   1      }
 855          
 856          void S5S0_PCH_PWR_EN(void)
 857          {
 858   1              PCH_PWR_EN_ON();
 859   1          
 860   1          RamDebug(0x83);
 861   1      }
 862          
 863          void S5S0_RSMRST_EN(void)
 864          {
 865   1              RSMRST_HI();
 866   1          RamDebug(0x84);
 867   1      }
 868          
 869          void S5S0_PM_PWER_BTN2(void)
 870          {
 871   1              PM_PWRBTN_LOW();
 872   1              SET_MASK(CMOS_TEST,BIT2); //ANGELAS052:add
 873   1          RamDebug(0x85);
 874   1      }
 875          // open
 876          void S5S0_PM_PWER_BTN3(void)
 877          {
 878   1              PM_PWRBTN_HI();
 879   1          RamDebug(0x86);
 880   1      }
 881          
 882          BYTE S5S0_CHK_S4(void)
 883          {
 884   1              if(Read_SLPS4())
 885   1              {
 886   2                  PM_PWRBTN_HI(); 
 887   2                      //SYSON_HI(); //ANGELAS063:remove
 888   2                      EC_VCCST_EN_HI(); //ANGELAS063:add
 889   2              RamDebug(0x87);
 890   2                      return(1);
 891   2              }
 892   1          //Reset_Delay=0x44; //:Remove work around
 893   1          PM_PWRBTN_LOW(); 
 894   1          
 895   1          RamDebug(0x88);
 896   1              return(0);
 897   1      }
 898          
 899          BYTE S5S0_CHK_S3(void)
 900          {
 901   1              if(Read_SLPS3())
 902   1              {
 903   2                      //if( Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03|0x00),0xEE) )
 904   2                      //{
 905   2                      //      SET_MASK(EMStatusBit, b4RdKBLEDFun);    // default support KB LED.
 906   2                      //}
 907   2                      
 908   2              RamDebug(0x89);
 909   2                      return(1);
 910   2              }
 911   1          RamDebug(0x8A);
 912   1              //Reset_Delay=0x55;  //Remove work around
 913   1              return(0);
 914   1      }
 915          
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 16  

 916          void S5S0_EC_VCCST_EN(void)
 917          {
 918   1              EC_VCCST_EN_HI();
 919   1          
 920   1          RamDebug(0x8B);
 921   1      }
 922          
 923          //MEILING001:S+
 924          void S5S0_EC_VPP_PWREN(void)
 925          {
 926   1              EC_VPP_PWREN_HI();
 927   1          
 928   1          RamDebug(0x8C);
 929   1      }
 930          //MEILING001:E+
 931          
 932          //ANGELAS063:add start
 933          void S5S0_SYSON(void)
 934          {
 935   1              SYSON_HI();
 936   1          RamDebug(0x8D);
 937   1      }
 938          //ANGELAS063:add end
 939          void S5S0_GPO7(void)
 940          {
 941   1      //      VGA_AC_DET_HI();
 942   1      }
 943          void S5S0_SUSP(void)
 944          {
 945   1              SUSP_ON();
 946   1          //ROMPWREN_HIGH(); 
 947   1              CURRENT_STATUS &= 0xC0; //Clear flags of entering and resuming from S3 & S4 &S5
 948   1          //LAN_PWR_IN; 
 949   1              SetS0GPIO();
 950   1      }
 951          
 952          void S5S0_EC_VCCIO_EN(void)
 953          {
 954   1              EC_VCCIO_EN_HI();
 955   1      }
 956          
 957          void S5S0_NVDD_PWR(void)
 958          {
 959   1              #if     Support_External_IO
                  NVDD_PWR_EN_HI();
                      S_NVDD_PWR_EN_HI();
                      #endif  // Support_External_IO
 963   1      }
 964          
 965          void S5S0_USBON(void)
 966          {
 967   1              USB_ON_OUTPUT;
 968   1              USB_ON_LOW();
 969   1          //Remove read projectID for this project.
 970   1              /*nKbProjectID = Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03|0x00),0xF0);   // read KB Type.
 971   1              switch( nKbProjectID )
 972   1              {
 973   1                      case 'K':       // UK keyboard  ascii=4b
 974   1                              cKBStatus &= 0xFC;
 975   1                              cKBStatus |= 0x01;      // Set UK keyboard.
 976   1                              break;
 977   1                      case 'J':       // JP keyboard   ascii=4a
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 17  

 978   1                              cKBStatus &= 0xFC;
 979   1                              cKBStatus |= 0x02;      // Set JP keyboard.
 980   1                              break;
 981   1                      case 'E':       // EX keyboard   ascii=45
 982   1                              cKBStatus |= 0x03;      // Set BR keyboard.
 983   1                              break;
 984   1                      case 'S':       // US keyboard   ascii=53
 985   1                      default:        // Other character then set US matrix for default
 986   1                              cKBStatus &= 0xFC;      // Set US keyboard.
 987   1                              break;
 988   1              }
 989   1              LoadKBMatrixToRAM();
 990   1              SET_MASK(EMStatusBit, b4RdKBLEDFun);    // default support KB LED.
 991   1              *///Remove read projectID for this project.
 992   1              SET_MASK(EMStatusBit, b7RdUSBChgEn);    // default support USB charger S4/S5.
 993   1      }
 994          
 995          void S5S0_VCCST_PWRGD(void)
 996          {
 997   1              //EC_VCCST_PWRGD_HI();
 998   1      }
 999          
1000          //same as S5S0_CHK_SA_PWRGOOD, only change name for clear read.
1001          
1002          BYTE S5S0_CHK_VDDQ_PWRGOOD(void)
1003          {
1004   1              BYTE BPwrDate=0x03;
1005   1          // Reset_Delay=0x00;  //Remove work around
1006   1              if(Read_VDDQ_PGOOD())
1007   1              {
1008   2                      //bRWSMBus(SMbusCh4, SMbusWB, TmlIC_Addr, TmlIC_Rate, &BPwrDate, SMBus_NoPEC);
1009   2                      //LED_KB_PWM_Step=Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03|0x07),0xE2);//JERRYCH004:Enable keyboard backl
             -ight.
1010   2              RamDebug(0x8E);
1011   2      
1012   2              return(1);
1013   2              }
1014   1          RamDebug(0x8F);
1015   1              return(0);
1016   1      }
1017          /*
1018          BYTE S5S0_CHK_SA_PWRGOOD(void)
1019          {
1020                  BYTE BPwrDate=0x03;
1021                  if(Read_VDDQ_PGOOD())
1022                  {
1023                          //bRWSMBus(SMbusCh4, SMbusWB, TmlIC_Addr, TmlIC_Rate, &BPwrDate, SMBus_NoPEC);
1024                          LED_KB_PWM_Step=Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03|0x07),0xE2);
1025                          return(1);
1026                  }
1027                  return(0);
1028          }
1029          */
1030          
1031          
1032          void S5S0_VR_ON(void)
1033          {
1034   1              Clr_UEFIStatus();       // Clear UEFI status for BIOS used.
1035   1              VR_ON_ON();
1036   1              /*  
1037   1             if (IS_MASK_SET(SYS_STATUS,AC_ADP)) 
1038   1             {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 18  

1039   1                  ADAPTERIDON_LOW();
1040   1             }
1041   1              */       
1042   1              // for EM9 adapter detection and protection     
1043   1          //SetPowerBatteryparameter(); 
1044   1          if (IS_MASK_SET(SYS_STATUS,AC_ADP))   
1045   1          {
1046   2                      //ADAPTERIDON_LOW();  //MEILING001:remove.
1047   2                      AdapterIDOn_Flag = 0x01; //MEILING001:add.
1048   2                      ADPIDON10MS_NUM=0xa0;  // Modify read adapter ID time, in order to enter S4 under DC mode ,then plug in
             - AC and wake up from S4 not pop up limited support.
1049   2          } 
1050   1              //:for EM9 adapter detection and protection   
1051   1              MuteCount = 4;
1052   1      }
1053          
1054          BYTE S5S0_CHK_VRREADY(void)
1055          {
1056   1              if(Read_CPU_VR_READY())
1057   1              {
1058   2                      return(1);
1059   2              }
1060   1              return(0);
1061   1      }
1062          
1063          void S5S0_PCH_PWROK(void)
1064          {
1065   1              PCH_PWROK_HI();
1066   1          PwrOnDly5Sec =5;    //optimize PwrOnDly5Sec,from 40 to 5.
1067   1      }
1068          
1069          void S5S0_SYS_PWROK(void)
1070          {
1071   1              SYS_PWROK_HI();
1072   1      }
1073          
1074          void LPC_RST(void)
1075          {
1076   1              #if     Support_External_IO
                      DGPU_HOLD_RST_HI();
                      S_DGPU_RST_HI();
                      #endif  // Support_External_IO
1080   1      }
1081          
1082          
1083          void S5S0_Init_Status(void)
1084          {
1085   1              CLEAR_MASK(ACPI_HOTKEY, b7BIOS_NoShut); //support RTC wake and psw can wake during RTC wake enable  in DC
             - mode except ship mode enable //ANGELAS031
1086   1              CLEAR_MASK(ACPI_HOTKEY, b6Cmd_NoShut); //ANGELAS031
1087   1              ShipModeEn=0x00; //ANGELAS037: add 
1088   1              Fan_ON_Count = FAN_Boot_On;     // Turn on Fan 3 Sec.
1089   1              disable_turbo_counter=60; //ANGELAG050: add
1090   1              nBrightValue = 17;                      // Default WIN8 brightness 110~130 nit.
1091   1              nCpuTemp = VGA_TEMP = EXTVGA_TEMP = nSKINTemp90 = 32;   // Default temperature value.
1092   1              ThermistorCPU_TEMP=32;  //ANGELAS070:add
1093   1              //ANGELAS033:Add start  
1094   1              if(IS_MASK_SET(SEL_STATE0,PRESENT_A))
1095   1              {
1096   2              batteryFirstUsedDateL = batteryFirstUsedDateH = 0x00;
1097   2                      if(bRWSMBus(SMbusChB,SMbusRW,SmBat_Addr,FirstUsedDate,&batteryFirstUsedDateL,SMBus_NeedPEC))
1098   2                      {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 19  

1099   3                              if(batteryFirstUsedDateL || batteryFirstUsedDateH )
1100   3                                      CLEAR_MASK(pProject0,b3uBatteryTimeNoOK);
1101   3                              else
1102   3                                      SET_MASK(pProject0,b3uBatteryTimeNoOK);
1103   3                              RamDebug(0xAE);
1104   3                      }
1105   2              }                       
1106   1              //ANGELAS033:Add end
1107   1               InitThermalTable1();//JERRYCH00:Modify the fan control from linear to the ladder.
1108   1          InitThermalTable2();//JERRYCH00:Modify the fan control from linear to the ladder.
1109   1              //SysPowState = SYSTEM_S0;      // Set System S0 status. //ANGELAS045:remove
1110   1              LED_KB_PWM_Count = 10;  // Turn on KB BL LED.  //MEILING030:change 3 to 10(1.5s to 5s).
1111   1              ACPI_HOTKEY &= 0x1F;    // Clear bit6,7, can cut power in the battery mode.
1112   1              SYS_STATUS &= 0xF8;             // Clear OS mode.
1113   1              //DSxPowState = SYSTEM_S3S4;    // Clear Deep status. //ANGELAS045:remove
1114   1              CLR_MASK(cCmd, b3BkOff);        // Turn on backlight.
1115   1              CLR_MASK(OEMControl, b1BkOff); //ANGELAG005:add
1116   1              BackLight_En_Delay =16; // Delay 280msec turn on backlight.//reduce light backlight time for clodboot.fro
             -m 28 to 16.
1117   1          delayEDPTm = 5;                             // Delay 50ms to initial EDP.   // CMW Temp
1118   1              //SetACIN_Int(); //ANGELAS079:remove
1119   1              SET_MASK(pDevStus, pENABLE_TP); // Turn on TouchPad.
1120   1              //turn on touch sensor power
1121   1              //if ( uMBID & 0x08 )  // add MBID judge.
1122   1          //add lid flag to BIOS, whether need to open  backlight.
1123   1          if(Read_LID_SW_IN())
1124   1              SET_MASK(SWI_EVENT,LID);
1125   1          else
1126   1              CLEAR_MASK(SWI_EVENT,LID);
1127   1          {
1128   2              //EC_TS_ON_OUTPUT;
1129   2              // EC_TS_ON_LOW();//Add touch panel control signal.//remove  for SIT unit. 
1130   2              EC_TS_ON_HI();//Add touch panel control signal.  //MEILING001:add.
1131   2          }    
1132   1          #if SupportReadTPID
                  ReadTPid();
                  #endif
1135   1          uReserve07.fbit.uACInOutBeep = 1;
1136   1              //CLEAR_MASK(BATTUPDATEFW,BIT0); //ANGELAS054:add //ANGELAS083:remove
1137   1              Lowpower_DISfunction(); //ANGELAS047:add
1138   1              //PECIBIOSTEST=2;//when enter S3/S4/CB,BIOS sent B4 CMD to EC from 66port for peci fail.// : CHANGE FROM 
             -0 TO 2//remove 
1139   1              CPUThrottlingDelayTime = 60; //MEILING052:add delay time 1 minute to send 0x1D event.
1140   1              SysPowState = SYSTEM_S0;        //ANGELAS045:add set S0 power state.
1141   1              //DSxPowState = SYSTEM_S3S4;    // Clear Deep status. //ANGELAS045:add
1142   1      }
1143          
1144          /* follow ITE EVB Power Sequence 20111202.pdf
1145          ;===========================================================================================
1146          ; Power On (DC mode)
1147          ;===========================================================================================
1148          ;
1149          ;S5_ENABLE(O)   +----------------------------------------------------------------------------
1150          ;--------------+(1)Always power group 3,5VA (if Adapter in,this signal will exist always)
1151          ;
1152          ;PM_Power_BTN(O)            +----------------------+    ~       +-----------------------
1153          ;----------------------+                                       +--~----+
1154          ;
1155          ;RSMRST(O)                           +----------------------------------------
1156          ;-------------------------+
1157          ;
1158          ;AC_Present (Intel Only and if AC attached)(O)   +----------------------------------------
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 20  

1159          ;----------------------------------------+
1160          ;
1161          ;                                                                                                        +
             ----------------------
1162          ;SLP_S4#(I) SLP4(I)-------------------------------------------+
1163          ;
1164          ;                                                                                                         
             -      +---------------------
1165          ;IMVP_PWRGD (I)  ------------------------------------------------+
1166          ;                                                                                                         
             -                  +------------------
1167          ;S0_Power_Good(O)------------------------------------------------------+
1168          ;========================================================================
1169          */
1170          
1171          //-------------------------------------------------------------------------------------
1172          //  Do S5 -> S0 power sequnce
1173          //-------------------------------------------------------------------------------------
1174          const sPowerSEQ code asPowerSEQS5S0[]=
1175          {
1176                  { 0x0000,                               0,              0,  },  //Dummy step always in the top of tabel
1177                  { S5S0_STEP1,                   0,              1,      },  //MEILING002:change delay time from 10 to 1. //MEILING010:change 1 to 0.
1178                  { S5S0_PMIC_Initial,    1,              1,      },  //MEILING002: add  //MEILING010:change 10 to 1.
1179                  { S5S0_PCH_PWR_EN,              30,             0,  },
1180                  { S5S0_RSMRST_EN,               20,             0,  },
1181                  { S5S0_AC_PRESENT_EN,   76,             0,  }, // 20+76>95
1182                  { S5S0_PM_PWER_BTN2,    20,             0,  },
1183                  { S5S0_PM_PWER_BTN3,    0,      0,  },  
1184                  { S5S0_CHK_S4,                  0,              1,      }, //ANGELAS063: 2 to 1 //MEILING001:change 2 to 0.
1185                  { S5S0_EC_VPP_PWREN,    2,      0,  }, //MEILING001:add.
1186                  { S5S0_SYSON,                   0,              0,      }, //    ANGELAS063:add
1187                  //{ S5S0_CHK_S3,                1,      1,      }, //ANGELAS063:remove
1188                  { S5S0_CHK_VDDQ_PWRGOOD,0,              1,      },
1189                  { S5S0_CHK_S3,                  0,      1,  }, //ANGELAS063:add
1190                  { SLPS3_Sleep_En,       0,      0,  }, //ANGELAS063:add
1191                  { SLPS4_Sleep_En,       0,      0,  }, //ANGELAS063:add
1192                  //{ S5S0_EC_VCCST_EN,   2,              0,      }, //ANGELAS063:remove
1193                  { S5S0_SUSP,                    0,              0,      },  //ANGELAS063: 2 to 0
1194                  { S5S0_EC_VCCIO_EN,             8,              0,      },  //   syson to vccio <25
1195              { S5S0_USBON,                       50,             0,      },
1196              { S5S0_VCCST_PWRGD,         5,              0,      },
1197                  { S5S0_VR_ON,                   0,              0,      },    
1198                  { S5S0_CHK_VRREADY,             10,             1,      },
1199                  { S5S0_PCH_PWROK,               100,    0,      },  // check VR_ON  //MEILING010:change 85 to 100.
1200                  { S5S0_SYS_PWROK,               49,             0,      },      
1201                  { S5S0_Init_Status,             0,              0,      },
1202          };
1203          
1204          //----------------------------------------------------------------------------
1205          // S5 to S0 sequnce
1206          //----------------------------------------------------------------------------
1207          void Oem_S5S0Sequence(void)
1208          {
1209   1          if ( PowSeqDelay != 0x00 )
1210   1          {
1211   2              PowSeqDelay--;                                                                  //1m Sec count base
1212   2              if ( PowSeqDelay != 0x00 )      return;
1213   2          }
1214   1      
1215   1              while(PWSeqStep<(sizeof(asPowerSEQS5S0)/sizeof(sPowerSEQ)))
1216   1              {
1217   2                      if(asPowerSEQS5S0[PWSeqStep].checkstatus==0x00) // Do function
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 21  

1218   2                      {
1219   3                              (asPowerSEQS5S0[PWSeqStep].func)();
1220   3                              PowSeqDelay = asPowerSEQS5S0[PWSeqStep].delay;
1221   3                              PWSeqStep++;
1222   3                              if(PowSeqDelay!=0x00)
1223   3                              {
1224   4                                      break;
1225   4                              }
1226   3                      }
1227   2                      else    // Check input status pin
1228   2                      {
1229   3                              if((asPowerSEQS5S0[PWSeqStep].func)())
1230   3                              {
1231   4                                      PowSeqDelay = asPowerSEQS5S0[PWSeqStep].delay;
1232   4                                  PWSeqStep++;
1233   4                              }
1234   3                              break;
1235   3                      }
1236   2              }
1237   1      }
1238          
1239          //============S0 -> S5==========================================================
1240          void S0S5_VR_ON(void)
1241          {
1242   1              SYS_PWROK_LOW();
1243   1              PCH_PWROK_LOW();
1244   1              VR_ON_OFF();
1245   1              //EC_VCCST_PWRGD_LOW();
1246   1              USB_ON_INPUT; //ANGELAS031: add
1247   1              EC_VCCIO_EN_LOW();
1248   1              #if     Support_External_IO
                      DGPU_HOLD_RST_LOW();
                      S_DGPU_RST_LOW();
                      #endif  // Support_External_IO
1252   1      }
1253          
1254          void S0S5_NVDD_OFF(void)
1255          {
1256   1              #if     Support_External_IO
                      NVDD_PWR_EN_LOW();
                      S_NVDD_PWR_EN_LOW();
                      #endif  // Support_External_IO
1260   1      }
1261          
1262          void S0S5_SUSP(void)
1263          {
1264   1          EC_LID_OUT_LOW(); //ANGELAG008: add
1265   1              SUSP_OFF();
1266   1              SetS5GPIO();
1267   1      }
1268          void S0S5_EC_VCCST_EN(void)
1269          {
1270   1              EC_VCCST_EN_LOW();
1271   1      }
1272          
1273          //MEILING001:S+
1274          void S0S5_EC_VPP_PWREN(void)
1275          {
1276   1              EC_VPP_PWREN_LOW();
1277   1      }
1278          //MEILING001:E+
1279          
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 22  

1280          void S0S5_GPO7(void)
1281          {
1282   1              //VGA_AC_DET_LO();
1283   1      }
1284          
1285          void S0S5_SYS_ON(void)
1286          {
1287   1              SYSON_LOW();
1288   1              Write_NOVOS4();
1289   1      }
1290          void S0S5_DPWROK_OFF(void)
1291          {
1292   1              if(IS_MASK_CLEAR(cCmd, bPCHPWR_Keep))
1293   1              {
1294   2                  // DPWROK_EC_LOW();
1295   2              RSMRST_LOW(); 
1296   2          }
1297   1      }
1298          
1299          
1300          void S0S5_Init_Status(void)
1301          {
1302   1              //GPU_Prochot = 0; //ANGELAG033: remove //ANGELAG028: add
1303   1              F2_Pressed=0; //ANGELAG001: ADD
1304   1              //DSxPowState = SYSTEM_S3S4; //ANGELAS045:remove
1305   1      //Y7JERRY085:Add CMD for press power button 4s don't shutdown when flash bios.
1306   1              #if chPWSW1WDT
1307   1             CLEAR_MASK(pProject4,pPWSWdisable);
1308   1          #endif  //chPWSW1WDT 
1309   1      //Y7JERRY085:Add CMD for press power button 4s don't shutdown when flash bios.    
1310   1              //ANGELAS033:Add start                  
1311   1              if(IS_MASK_SET(SEL_STATE0,PRESENT_A))
1312   1              {
1313   2              if(IS_MASK_SET(pProject0,b1uFUdayClr))
1314   2              {
1315   3                      batteryFirstUsedDateH = 0x00;
1316   3                              batteryFirstUsedDateL = 0x00;
1317   3                      if(bRWSMBus(SMbusChB,SMbusWW,SmBat_Addr,FirstUsedDate,&batteryFirstUsedDateL,SMBus_NeedPEC))
1318   3                      {
1319   4                              CLEAR_MASK(pProject0,b1uFUdayClr);
1320   4                              RamDebug(0xAD);
1321   4                      }
1322   3              }
1323   2              }
1324   1              //ANGELAS033:Add end
1325   1              Bioswatchdog=0;////ANGELAS106:Optimize ANGELAS094 clear time.
1326   1              //SysPowState = SYSTEM_S5; //ANGELAS045:remove
1327   1              uNovoVPCCount = 0;                              // Clear NOVO VPC status.
1328   1              nCpuTemp = TEMP_Buff_1 = TEMP_Buff_2 = TEMP_Buff_3=0x00; //:Clear CPU & VGA & thermal IC temp after syste
             -m shutdown or enter s3.
1329   1              VGA_TEMP = VGA_TBuff3 = VGA_TBuff2 = VGA_TBuff1 = 0x00; //:Clear CPU & VGA & thermal IC temp after system
             - shutdown or enter s3.
1330   1              nNBTemp = nRamTemp =0;//:Clear CPU & VGA & thermal IC temp after system shutdown or enter s3.
1331   1              CLEAR_MASK(nBatteryStatH, CMBS_CRITICALLOW); 
1332   1          // if(AutoTimer&0x7F)
1333   1          //  SET_MASK(AutoTimer,b7AutoBootTm);
1334   1              CPU_TYPE &= 0x3f;//:CLEAR BIT6 and BIT7 Unit abnormal shuntdown will not clear GPU flag,so when enter S5,
             -WB and S3 we clear GPU flag to not read GPU temperature.
1335   1              CPU_Shut_Cnt = VGA_Shut_Cnt = EXTVGA_Shut_Cnt = 0;      // Clear shutdown conunt.
1336   1              ERR_THMSTS = 0;                                 // Clear thermal status fail bit.
1337   1              Thro_Status = Thro_Status2 = 0; // clear Throttling status.
1338   1              ECSleepCount = 3;                               // Delay entry EC sleep.
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 23  

1339   1      #if TouchPad_only
1340   1          PowerOffClearTPPendingData();
1341   1      #endif
1342   1          if(Read_LID_SW_IN())
1343   1              SET_MASK(SWI_EVENT,LID);
1344   1          else
1345   1              CLEAR_MASK(SWI_EVENT,LID);
1346   1          //EC_TS_ON_INPUT;     //   turn ooff touch sensor power
1347   1          EC_TS_ON_LOW();//Turn off touch pad sensor power in s5/s3.  //MEILING001:add.
1348   1             
1349   1              if (cSysActionFlag == SysAction_EC_Restart || cSysActionFlag == SysAction_SysShutdown_EC_AutoBoot)
1350   1              {
1351   2                  WinFlashMark = 0x53;
1352   2              WinFlashMark2 = 0x35;
1353   2                      InternalWDTNow();
1354   2              }
1355   1              //else if(( (WinFlashMark == 0xFC)&&(WinFlashMark1==0x55)) || (cSysActionFlag == SysAction_EC_Shutdown)) 
             -//ANGELAG012:remove.
1356   1              else if(cSysActionFlag == SysAction_EC_Shutdown) //ANGELAG012:add.
1357   1              {
1358   2                      ProcessSID(FLASH_ID);
1359   2                      WinFlashMark = 0xAA;
1360   2                      WinFlashMark1=0x88;
1361   2                      InternalWDTNow();
1362   2              }
1363   1      
1364   1              //Clr_Thermal_Tab();    // Clear Thermal table value.//JERRYCH00:Modify the fan control from linear to the l
             -adder.
1365   1      
1366   1              if(IS_MASK_SET(SysStatus,LidKBIgnore))
1367   1              {
1368   2                      Ccb42_DISAB_KEY = 0;
1369   2                      Flag.SCAN_INH = 0;      // not Inhibit scanner (internal keyboard).
1370   2                      Unlock_Scan();          // UnLock scanner
1371   2                      CLEAR_MASK(SysStatus,LidKBIgnore);
1372   2              }
1373   1              //ANGELAG007: add start
1374   1              if(PowerOVP_REG|PowerUVP_REG|PowerOCP_REG|PowerOTP_REG)
1375   1              {
1376   2                      if ( IS_MASK_CLEAR(SysStatus, ERR_ShuntDownFlag) )
1377   2                      { ProcessSID(PMIC_Shutdown_ID); }
1378   2              }
1379   1              //ANGELAG007: add end
1380   1      
1381   1              PollingOTP();//MEILING002:add.
1382   1      
1383   1              if ( IS_MASK_CLEAR(SysStatus, ERR_ShuntDownFlag) )
1384   1              { ProcessSID(S5_ID); }
1385   1              CLEAR_MASK(SysStatus,ERR_ShuntDownFlag);        // Clear Shutdown ID bit.
1386   1              initMark = 0x00;        // CMW 20121203 for PS8625 translator
1387   1              TEMP_Error = 0x00; // CMW 20121203 for PS8625 translator
1388   1              PECI_Err_CNT=0;//When enter S3/S4/S4,clear PECI fail count.
1389   1              // PECI_INDW;                   // Set PECI pin to ALT.//Change PECI initialize after S0 states.//: +remove  AND 
1390   1          //CLR_MASK(GCR2, PECIE);     // Enable PECI//Change PECI initialize after S0 states.//: +remove  AND 
1391   1              Lowpower_ENfunction(); 
1392   1      //ANGELAG008: add start
1393   1              CLEAR_MASK(pDevStatus3,b6EnDisTPSend);
1394   1              CLEAR_MASK(pDevStatus3,b7TPStateFormer);
1395   1              CLEAR_MASK(pDevStatus1,b0F6ScanCodeSend);
1396   1              CLEAR_MASK(pDevStatus1,b1F6DisableTP);
1397   1              CLEAR_MASK(pDevStatus1,b4LNVAPP_STATUS);
1398   1              CLEAR_MASK(pDevStatus1,b5TPDRIVER_STATUS);
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 24  

1399   1              CLEAR_MASK(pDevStatus1,b6MODE_STATUS);
1400   1              CLEAR_MASK(pDevStatus1,b7DisableTP);
1401   1      //ANGELAG008: add end
1402   1              //DSxPowState = SYSTEM_S3S4; 
1403   1              PM_PWRBTN_HI();
1404   1              SysPowState = SYSTEM_S5;
1405   1              
1406   1                
1407   1      }
1408          
1409          //-------------------------------------------------------------------------------------
1410          //  Do S0 -> S5 power sequnce
1411          //-------------------------------------------------------------------------------------
1412          const sPowerSEQ code asPowerSEQS0S5[]=
1413          {
1414                  { 0x0000,                               0,              0,  },  // Dummy step always in the top of tabel
1415                  { S0S5_VR_ON,                   0,              0,      },  
1416                  { S0S5_SUSP,                    0,              0,  },
1417                  //{ S0S5_EC_VCCST_EN,   0,              0,      },  //ANGELAS063:remove
1418                  //{ S0S5_SYS_ON,                30,             0,      }, //ANGELAS063:remove
1419                  { S0S5_SYS_ON,                  0,              0,      }, //ANGELAS063:add
1420                  { S0S5_EC_VCCST_EN,             30,             0,      }, //ANGELAS063:add
1421                  { S0S5_EC_VPP_PWREN,    10,     0,  }, //MEILING001:add.
1422                  { S0S5_Init_Status,             0,              0,      },
1423          };
1424          
1425          //----------------------------------------------------------------------------
1426          // S0 to S5 sequnce
1427          //----------------------------------------------------------------------------
1428          void Oem_S0S5Sequence(void)
1429          {
1430   1              if ( PowSeqDelay != 0x00 )
1431   1              {
1432   2                      PowSeqDelay--;                          //1m Sec count base
1433   2                      if ( PowSeqDelay != 0x00 )
1434   2                      {
1435   3                              return;
1436   3                      }
1437   2              }
1438   1      
1439   1              while(PWSeqStep<(sizeof(asPowerSEQS0S5)/sizeof(sPowerSEQ)))
1440   1              {
1441   2                      if(asPowerSEQS0S5[PWSeqStep].checkstatus==0x00) // Do function
1442   2                      {
1443   3                              (asPowerSEQS0S5[PWSeqStep].func)();
1444   3                              PowSeqDelay = asPowerSEQS0S5[PWSeqStep].delay;
1445   3                              PWSeqStep++;
1446   3                              if(PowSeqDelay!=0x00)
1447   3                              {
1448   4                                      break;
1449   4                              }
1450   3                      }
1451   2                      else                                                                                    // Check input status pin
1452   2                      {
1453   3                              if((asPowerSEQS0S5[PWSeqStep].func)())
1454   3                              {
1455   4                                      PowSeqDelay = asPowerSEQS0S5[PWSeqStep].delay;
1456   4                                      PWSeqStep++;
1457   4                              }
1458   3                              break;
1459   3                      }
1460   2              }
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 25  

1461   1      }
1462          
1463          //============S0 -> S3==========================================================
1464          void S0S3_VR_ON(void)
1465          {
1466   1              SYS_PWROK_LOW();
1467   1              PCH_PWROK_LOW();
1468   1              VR_ON_OFF();    
1469   1              //EC_VCCST_PWRGD_LOW();
1470   1              EC_VCCIO_EN_LOW();
1471   1              #if     Support_External_IO     //cwy
                      NVDD_PWR_EN_LOW();
                      S_NVDD_PWR_EN_LOW();
                      S_DGPU_PWR_EN_LOW();
                      DGPU_PWR_EN_LOW();
                      #endif  // Support_External_IO
1477   1      }
1478          
1479          void S0S3_SUSP(void)
1480          {
1481   1          EC_LID_OUT_LOW(); //ANGELAG008: add 
1482   1              SUSP_OFF();
1483   1              #if     Support_External_IO
                      DGPU_HOLD_RST_LOW();
                      S_DGPU_RST_LOW();
                      #endif  // Support_External_IO
1487   1              SetS5GPIO();
1488   1      }
1489          void S0S3_EC_VCCST_EN(void)
1490          {
1491   1              EC_VCCST_EN_LOW();
1492   1      }
1493          void S0S3_GPO7(void)
1494          {
1495   1      //      VGA_AC_DET_LO();
1496   1      }
1497          void S0S3_Init_Status(void)
1498          {
1499   1              //GPU_Prochot = 0; //ANGELAG033: remove //ANGELAG028: add
1500   1              #if     Support_External_IO
                      Init_IT8302();  //cwy
                      #endif  // Support_External_IO
1503   1              CPU_TYPE &= 0x3f;//:CLEAR BIT6 and BIT7 Unit abnormal shuntdown will not clear GPU flag,so when enter S5,
             -WB and S3 we clear GPU flag to not read GPU temperature.
1504   1              CPU_Shut_Cnt = VGA_Shut_Cnt = EXTVGA_Shut_Cnt = 0;      // Clear shutdown conunt.
1505   1              nCpuTemp = TEMP_Buff_1 = TEMP_Buff_2 = TEMP_Buff_3=0x00; //:Clear CPU & VGA & thermal IC temp after syste
             -m shutdown or enter s3.
1506   1              VGA_TEMP = VGA_TBuff3 = VGA_TBuff2 = VGA_TBuff1 = 0x00; //:Clear CPU & VGA & thermal IC temp after system
             - shutdown or enter s3.
1507   1              nNBTemp = nRamTemp =0;//:Clear CPU & VGA & thermal IC temp after system shutdown or enter s3.
1508   1              //SysPowState=SYSTEM_S3;  //ANGELAS045:remove
1509   1              //DSxPowState = SYSTEM_S3S4;  //ANGELAS045:remove
1510   1      #if TouchPad_only
1511   1          PowerOffClearTPPendingData();
1512   1      #endif  
1513   1              //Clr_Thermal_Tab();                            // Clear Thermal table value.//JERRYCH00:Modify the fan control from linear to th
             -e ladder.
1514   1              ERR_THMSTS = 0;                                 // Clear thermal status fail bit.
1515   1              Thro_Status = Thro_Status2 = 0; // clear Throttling status.  
1516   1              AOAC_STATUS &= 0x10;                    // Clear ISCT status.
1517   1              initMark = 0x00;        // CMW 20121203
1518   1              TEMP_Error = 0x00;      // CMW 20121203
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 26  

1519   1              // EC_TS_ON_INPUT;   //   turn off touch sensor power
1520   1          EC_TS_ON_LOW();//Turn off touch pad sensor power in s5/s3.  //MEILING001:add.
1521   1          PECI_Err_CNT=0;//:When enter S3/S4/S4,clear PECI fail count.
1522   1              // PECI_INDW;                   // Set PECI pin to ALT.//:Change PECI initialize after S0 states.//: +remove  AND 
1523   1              // CLR_MASK(GCR2, PECIE);     // Enable PECI//:Change PECI initialize after S0 states.//: +remove  AND
1524   1              Lowpower_ENfunction(); //ANGELAS047:add
1525   1      //ANGELAG008: add start
1526   1              CLEAR_MASK(pDevStatus3,b6EnDisTPSend);
1527   1              CLEAR_MASK(pDevStatus3,b7TPStateFormer);
1528   1              CLEAR_MASK(pDevStatus1,b0F6ScanCodeSend);
1529   1              CLEAR_MASK(pDevStatus1,b1F6DisableTP);
1530   1              CLEAR_MASK(pDevStatus1,b4LNVAPP_STATUS);
1531   1              CLEAR_MASK(pDevStatus1,b5TPDRIVER_STATUS);
1532   1                      CLEAR_MASK(pDevStatus1,b6MODE_STATUS);
1533   1      
1534   1                      CLEAR_MASK(pDevStatus1,b7DisableTP);
1535   1      //ANGELAG008: add end
1536   1              SysPowState=SYSTEM_S3;  //ANGELAS045:add
1537   1              //DSxPowState = SYSTEM_S3S4;  //ANGELAS045:add
1538   1      }
1539          
1540          //-------------------------------------------------------------------------------------
1541          //  Do S0 -> S3 power sequnce
1542          //-------------------------------------------------------------------------------------
1543          const sPowerSEQ code asPowerSEQS0S3[]=
1544          {
1545                  { 0x0000,                       0,      0,  },  // Dummy step always in the top of tabel
1546                  { S0S3_VR_ON,           0,      0,  }, 
1547                  { S0S3_SUSP,                    0,      0,  },  
1548                  { S0S3_Init_Status,             0,              0,      },
1549          };
1550          
1551          //----------------------------------------------------------------------------
1552          // S0 to S3 sequnce
1553          //----------------------------------------------------------------------------
1554          void Oem_S0S3Sequence(void)
1555          {
1556   1              if(PowSeqDelay != 0x00 )
1557   1              {
1558   2              PowSeqDelay--;        //1m Sec count base
1559   2              if(PowSeqDelay != 0x00 )
1560   2              {
1561   3                      return;
1562   3              }
1563   2              }
1564   1      
1565   1              while(PWSeqStep<(sizeof(asPowerSEQS0S3)/sizeof(sPowerSEQ)))
1566   1              {
1567   2              if(asPowerSEQS0S3[PWSeqStep].checkstatus==0x00) // Do function
1568   2              {
1569   3                      (asPowerSEQS0S3[PWSeqStep].func)();
1570   3                      PowSeqDelay = asPowerSEQS0S3[PWSeqStep].delay;
1571   3                      PWSeqStep++;
1572   3                      if(PowSeqDelay!=0x00)
1573   3                      {
1574   4                              break;
1575   4                      }
1576   3              }
1577   2              else                      // Check input status pin
1578   2              {
1579   3                      if((asPowerSEQS0S3[PWSeqStep].func)())
1580   3                      {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 27  

1581   4                              PowSeqDelay = asPowerSEQS0S3[PWSeqStep].delay;
1582   4                              PWSeqStep++;
1583   4                      }
1584   3                      break;
1585   3              }
1586   2              }
1587   1      }
1588          
1589          //============S3 -> S0==========================================================
1590          void S3S0_PM_PWER_BTN1(void)
1591          {
1592   1              PM_PWRBTN_LOW();
1593   1      }
1594          
1595          void S3S0_PM_PWER_BTN2(void)
1596          {
1597   1              PM_PWRBTN_HI();
1598   1              SysPowState=SYSTEM_S3;
1599   1      }
1600          void S3S0_EC_VCCST_EN(void)
1601          {
1602   1              EC_VCCST_EN_HI();
1603   1      }
1604          void S3S0_GPO7(void)
1605          {
1606   1      //VGA_AC_DET_HI();
1607   1      }
1608          void S3S0_SUSP(void)
1609          {
1610   1              PM_PWRBTN_HI();
1611   1              SUSP_ON();
1612   1              SetS0GPIO();
1613   1              USB_ON_OUTPUT;
1614   1              USB_ON_LOW();
1615   1          //LAN_PWR_IN; 
1616   1              #if     Support_External_IO
                      DGPU_PWR_EN_HI();
                      S_DGPU_PWR_EN_HI();
                      Delay1MS(7);
                      NVDD_PWR_EN_HI();
                      S_NVDD_PWR_EN_HI();
                      #endif  // Support_External_IO
1623   1      }
1624          
1625          void S3S0_EC_VCCIO_EN(void)
1626          {
1627   1              EC_VCCIO_EN_HI();
1628   1      }
1629          
1630          void S3S0_VCCST_PWRGD(void)
1631          {
1632   1              //EC_VCCST_PWRGD_HI();
1633   1      }
1634          
1635          void S3S0_VR_ON(void)
1636          {
1637   1              VR_ON_ON();
1638   1              MuteCount = 18;  
1639   1              //: for EM9 adapter detection and protection    
1640   1          if (IS_MASK_SET(SYS_STATUS,AC_ADP))   
1641   1          {
1642   2                      //ADAPTERIDON_LOW(); //MEILINNG001:remove.
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 28  

1643   2                      AdapterIDOn_Flag = 0x01; //MEILING001:add.
1644   2                      ADPIDON10MS_NUM=0x20;
1645   2          }
1646   1              //:for EM9 adapter detection and protection 
1647   1      }
1648          void PCH_PWROK(void)
1649          {
1650   1              PCH_PWROK_HI();
1651   1      }
1652          
1653          
1654          void S3S0_Init_Status(void)
1655          {
1656   1              Fan_ON_Count = FAN_Boot_On;     // Turn on Fan 3 Sec.
1657   1              disable_turbo_counter=60; //ANGELAG050: add
1658   1              //SysPowState = SYSTEM_S0; //ANGELAS045:remove
1659   1              //DSxPowState = SYSTEM_S3S4;    // Clear Deep status. //ANGELAS045:remove
1660   1          RamDebug(0x9B);
1661   1          // AOAC_INPUT();   
1662   1              //LED_KB_PWM_Count = 3; // Turn on KB BL LED.  //MEILING030:remove.
1663   1              CLR_MASK(cCmd, b3BkOff);        // Turn on backlight.
1664   1              CLR_MASK(OEMControl, b1BkOff); //ANGELAG005:add
1665   1              BackLight_En_Delay = 3;         // Delay 30msec turn on backlight.
1666   1          delayEDPTm = 40;                           // Delay 100ms to initial EDP. // CMW Temp
1667   1              //SetACIN_Int(); //ANGELAS079:remove
1668   1              SET_MASK(pDevStus, pENABLE_TP); // Turn on TouchPad.
1669   1              CURRENT_STATUS &= 0xC0;                 //(JSN20120614) Clear flags of entering and resuming from S3 & S4 &S5
1670   1              //turn on touch sensor power
1671   1              //if ( uMBID & 0x08 )  //T28A +: add MBID judge.
1672   1              //if ( uMBID & 0x08 )  //T28A +: add MBID judge.  //T028C+
1673   1           {
1674   2                //EC_TS_ON_OUTPUT;
1675   2                //EC_TS_ON_LOW();//Remove  for SIT unit.//:-Add touch panel control signal. 
1676   2                EC_TS_ON_HI(); //MEILING001:add.
1677   2           }      
1678   1              //if ( (IS_MASK_SET(ACPI_HOTKEY,b5BIOS_IFFS)) )
1679   1              //{ EC_LID_OUT_HI(); }
1680   1              Lowpower_DISfunction(); //ANGELAS047:add
1681   1              SysPowState = SYSTEM_S0;   //ANGELAS045:add
1682   1              //DSxPowState = SYSTEM_S3S4;    // Clear Deep status. //ANGELAS045:add
1683   1      
1684   1      }
1685          
1686          //-------------------------------------------------------------------------------------
1687          //  Do S3 -> S0 power sequnce
1688          //-------------------------------------------------------------------------------------
1689          const sPowerSEQ code asPowerSEQS3S0[]=
1690          {
1691                  { 0x0000,                       0,      0,  },  // Dummy step always in the top of tabel
1692                  { S3S0_PM_PWER_BTN1,    20,             0,  },
1693                  { S3S0_PM_PWER_BTN2,    2,      0,  },
1694                  { S3S0_SUSP,                    2,      0,  },          
1695                  { S3S0_EC_VCCIO_EN,     50,     0,  },          
1696                  { S3S0_VCCST_PWRGD,     5,      0,  },          
1697                  { S3S0_VR_ON,                   0,              0,      },
1698                  { SLPS3_Sleep_En,       0,      0,  }, //ANGELAS063:add
1699                  { SLPS4_Sleep_En,       0,      0,  }, //ANGELAS063:add
1700                  { S5S0_CHK_VRREADY,             10,             1,      },      //  there S5S0... same as S3S0... 
1701                  { S5S0_PCH_PWROK,               100,    0,      },      //  there S5S0... same as S3S0...  //LMLKBL0013:modify delay time from 85 
             -to 100.
1702                  { S5S0_SYS_PWROK,               110,    0,      },      //  there S5S0... same as S3S0...
1703                  { S3S0_Init_Status,             0,              0,      },
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 29  

1704          };
1705          
1706          //----------------------------------------------------------------------------
1707          //S3 to S0 Sequence
1708          //----------------------------------------------------------------------------
1709          void Oem_S3S0Sequence(void)
1710          {
1711   1              if(PowSeqDelay != 0x00 )
1712   1              {
1713   2              PowSeqDelay--;        //1m Sec count base
1714   2              if(PowSeqDelay != 0x00 )
1715   2              {
1716   3                      return;
1717   3              }
1718   2              }
1719   1      
1720   1              while(PWSeqStep<(sizeof(asPowerSEQS3S0)/sizeof(sPowerSEQ)))
1721   1              {
1722   2              if(asPowerSEQS3S0[PWSeqStep].checkstatus==0x00) // Do function
1723   2              {
1724   3                      (asPowerSEQS3S0[PWSeqStep].func)();
1725   3                      PowSeqDelay = asPowerSEQS3S0[PWSeqStep].delay;
1726   3                      PWSeqStep++;
1727   3                      if(PowSeqDelay!=0x00)
1728   3                      {
1729   4                              break;
1730   4                      }
1731   3              }
1732   2              else    // Check input status pin
1733   2              {
1734   3                      if((asPowerSEQS3S0[PWSeqStep].func)())
1735   3                      {
1736   4                              PowSeqDelay = asPowerSEQS3S0[PWSeqStep].delay;
1737   4                              PWSeqStep++;
1738   4                      }
1739   3                      break;
1740   3              }
1741   2              }
1742   1      }
1743          //=============================================================================
1744          void CheckAutoPowerOn(void)
1745          {
1746   1              if ((WinFlashMark == 0x53) && (WinFlashMark2 == 0x35) &&( SystemIsS5|| (SystemIsDSX && (!Read_AC_IN()) ) 
             -))
1747   1              {
1748   2                      //AutoTimer = 0x01;
1749   2                      AutoTimer = 0x83;
1750   2                      WinFlashMark = 0;
1751   2              WinFlashMark2 = 0;
1752   2              }
1753   1      }
1754          
1755          void Check_EC_ON()
1756          {
1757   1              //if ( IS_MASK_CLEAR(ACPI_HOTKEY, b7BIOS_NoShut)&&(LOWBATT_3TIMES==0)&&((SysStatus2&0x03)== 0))         // Not 
             -cut power in the battery mode for BIOS used.
1758   1              if ( IS_MASK_CLEAR(ACPI_HOTKEY, b7BIOS_NoShut)&&(LOWBATT_3TIMES==0))  
1759   1              {
1760   2                      if ( IS_MASK_CLEAR(ACPI_HOTKEY, b6Cmd_NoShut) ) // Not cut power in the battery mode for command used.
1761   2                      {
1762   3                  //if (!Read_AC_IN())   
1763   3                  //if (!Read_AC_IN()&& (DSxPowState == SYSTEM_DSxOK))//SysPowState
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 30  

1764   3                  if (!Read_AC_IN()&& (SysPowState == SYSTEM_S5))
1765   3                  {
1766   4                                  //T31- EC_ON_LOW();
1767   4                                  //EC_ON_Flag =0x55;  
1768   4                              #if shipmodesupport             //:add ship mode judge
1769   4                                      if(ShipModeEn==0xA5)
1770   4                                      {
1771   5                                              ShipModeEn=0x00;
1772   5                                              Lock_ShipMode();
1773   5                              GPCRC1=INPUT;
1774   5                              GPCRC2=INPUT;
1775   5                                              Delay1MS(100);                                                     
1776   5                                      }
1777   4                              #endif
1778   4                                              //Delay1MS(10); 
1779   4                                      RSMRST_LOW();
1780   4                                      Delay1MS(2); 
1781   4                                      PCH_PWR_EN_OFF();
1782   4                                      Delay1MS(12); //:Add 12 ms delay between PCH_PWR_EN_OFF and EC_ON_LOW
1783   4                                      /*//ANGELAS038:remove start
1784   4                                      //ANGELAS005:s+ Support UMA SKU EC_ON pin design.
1785   4                                      //if(NTC_V1>682)        //ANGELAS007:Optimize power on sequence.
1786   4                                      if(NTC_FLAG)//ANGELAS007:Optimize power on sequence.
1787   4                                      {
1788   4                                              CLR_MASK(GPDRF,BIT(0));
1789   4                                              //GPCRF0 = INPUT; //ANGELAS020
1790   4                                      }
1791   4                                      else
1792   4                                      //ANGELAS005:e+ Support UMA SKU EC_ON pin design.
1793   4                                      *///ANGELAS038:remove end
1794   4                                  EC_ON_LOW();    
1795   4                                      PM_PWRBTN_LOW();
1796   4                                      //LID_readytime = 11 ;   //ANGELAS007:Optimize power on sequence.                                                                       // LID switch wakeup time = 1
             -00ms
1797   4                                      CLR_MASK(LENOVOPMFW_Temp,b3EC_ONStatus);
1798   4                                      SET_MASK(LENOVOPMFW_Temp,b5EC_ON_EN);             
1799   4                          }
1800   3          
1801   3                              return;
1802   3                      }
1803   2              }
1804   1              SET_MASK(LENOVOPMFW_Temp,b3EC_ONStatus);
1805   1              CLR_MASK(LENOVOPMFW_Temp,b5EC_ON_EN);
1806   1      }
1807          
1808          //ANGELAS041:add start
1809          void check8sreset(void)
1810          {
1811   1              //BYTE tempEC201Ch; //ANGELAS089:remove
1812   1          //tempEC201Ch = EC201Ch; //ANGELAS089:remove
1813   1              RamDebug(ShutDnCause);
1814   1              //RamDebug(tempEC201Ch); //ANGELAS089:remove
1815   1              Init_SMBus_Regs();
1816   1          //if(IS_MASK_SET(tempEC201Ch,BIT1)) //ANGELAS089:remove
1817   1              if(IS_MASK_SET(PWRSW8SRST,BIT1))  //ANGELAS089:add
1818   1          {  
1819   2              SET_MASK(SysStatus2, b3EC8S_Reset);
1820   2              RamDebug(0xA8);
1821   2          }
1822   1          else 
1823   1          {
1824   2              CLEAR_MASK(SysStatus2, b3EC8S_Reset);
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 31  

1825   2              RamDebug(0xA9);
1826   2          }
1827   1      }
1828          //ANGELAS041:add end
1829          
1830          /*
1831          void CHK_BATT_5PERCL(void)
1832          {
1833              BYTE tempEC201Ch;  
1834              tempEC201Ch = EC201Ch;
1835                  RamDebug(ShutDnCause);
1836                  RamDebug(tempEC201Ch);  
1837                  Init_SMBus_Regs();      // initial SMBUS        
1838                 if(IS_MASK_SET(tempEC201Ch,BIT1))  //SPCTRL4:LRSIPWRSWTR 
1839                 {  
1840                       SET_MASK(SysStatus2, b3EC8S_Reset);
1841                       RamDebug(0xA8);
1842                 }
1843                 else 
1844                 {
1845                      CLEAR_MASK(SysStatus2, b3EC8S_Reset);
1846                      RamDebug(0xA9);
1847                 }
1848                          RamDebug(0xAA);
1849                          RamDebug(WinFlashMark);
1850                          RamDebug(WinFlashMark2);
1851                          if((0x38==WinFlashMark)&&(0x83==WinFlashMark2))
1852                         {
1853                                              WinFlashMark=0x00;
1854                                              WinFlashMark2=0x00;
1855                                          PWSeqStep = 1;
1856                                              PowSeqDelay = 0x00;
1857                                            RamDebug(0x56);
1858                                              SysPowState=SYSTEM_S5_S0; 
1859                         }
1860                  //(JSN20120614)+        if (!Read_AC_IN() && Read_EC_PWRBTN())
1861                  if ( !Read_AC_IN() && (Read_EC_PWRBTN() || Read_EC_NOVO()) )
1862                  //(JSN20120614)-
1863                  {
1864                          EC_ON_HI();
1865                          //EC_ON2_HI();
1866                          if( Read_EC_NOVO() )
1867                          {
1868                                  uNovoVPCCount = 1;
1869          
1870                                  EEPROM_PwrSts = Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03 | 0x07),0xDF);
1871                                  // NOVO button should be no function when resuming from S4
1872                                  if( (EEPROM_PwrSts & 0x10) == 0 )
1873                                  {
1874                                          if ( (EEPROM_PwrSts & 0x01) != 0 )
1875                                          { return; }
1876                                  }
1877                          }
1878                          else
1879                          {uNovoVPCCount = 0;}
1880          
1881                          //if ((Battdata_ready != 1)&&(!Read_AC_IN()||Read_ACOFF()))
1882                          if ((Battdata_ready != 1)&&(!Read_AC_IN()))
1883                          {
1884                                  FirstGetBatData();
1885                                  while(BatSMbusFailCount!=0) //:Fixup battery LED show amber and flash 3 times
1886                                  {      
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 32  

1887                                          FirstGetBatData();
1888                                          bRWSMBus(SMbusChB, SMbusRW, SmBat_Addr,C_RSOC,&BAT1PERCL ,SMBus_NoPEC);
1889                          }
1890                                  if (Battdata_ready != 1)
1891                                  {
1892                                          Battdata_ready = 0xFF;
1893                                          return;
1894                                  }
1895                          }
1896          
1897                          //if ((BAT1PERCL < 0x02)&&(!Read_AC_IN()||Read_ACOFF()))  //: change 0x05 to 0x00 G23
1898                          if ((BAT1PERCL < 0x02)&&(!Read_AC_IN()))  //: change 0x05 to 0x00 G23
1899                          {
1900                                  SET_MASK(nBatteryStatL,CMBS_LOWBATT);
1901                                  LOWBATT_3TIMES = 100;           // set 5 sec
1902                                  //EC_ON_HI();
1903                                  return;
1904                          }
1905          
1906                          //EC_ON_HI();
1907                          if(!Read_LID_SW_IN())
1908                          { 
1909                                  return; 
1910                        }
1911                        if(IS_MASK_SET(SysStatus2, b3EC8S_Reset))
1912                        {
1913                              CLEAR_MASK(SysStatus2, b3EC8S_Reset);
1914                              return;
1915                        }
1916                           PWSeqStep = 1;
1917                           PowSeqDelay = 0x00;
1918                        RamDebug(0x54);
1919                           SysPowState=SYSTEM_S5_S0;
1920                  }
1921          }
1922          */
1923          
1924          void SendSynapticsIDSequence()
1925          {
1926   1          BYTE Temp;
1927   1      
1928   1              Temp=0;
1929   1              do 
1930   1              {
1931   2                      Send2PortNWait(0x02, 0xE8, 1);
1932   2                      Send2PortNWait(0x02, 0x00, 1);
1933   2                      Temp++;
1934   2              }while(Temp<4);
1935   1      
1936   1              Send2PortNWait(0x02, 0xE9, 4);
1937   1      }
1938          
1939          void SendElanIDSequence()
1940          {
1941   1          Send2PortNWait(0x02, 0xE6, 1);
1942   1          Send2PortNWait(0x02, 0xE6, 1);
1943   1          Send2PortNWait(0x02, 0xE6, 1);
1944   1          Send2PortNWait(0x02, 0xE9, 4);
1945   1      }
1946          void SendALPSIDSequence()
1947          {
1948   1          Send2PortNWait(0x02, 0xE7, 1);
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 33  

1949   1          Send2PortNWait(0x02, 0xE7, 1);
1950   1          Send2PortNWait(0x02, 0xE7, 1);
1951   1          Send2PortNWait(0x02, 0xE9, 4);
1952   1      }
1953          void ReadTPid()
1954          {
1955   1          //BYTE Temp;
1956   1          // if((TP_Type == 0x01)||(TP_Type == 0x02)||(TP_Type == 0x03)) //G34: remove read TP ID only one time.
1957   1             // return;
1958   1          SendSynapticsIDSequence();
1959   1      
1960   1          if(TPID3 == 0x47)
1961   1          {
1962   2              TP_Type = 0x02;         // Synatics TouchPad.
1963   2          }
1964   1          else
1965   1          {
1966   2              SendElanIDSequence();
1967   2              if(TPID2 == 0x3C)
1968   2              {
1969   3                  TP_Type = 0x01;     // ELAN ToucnPad.
1970   3              }
1971   2             else
1972   2            {
1973   3                 SendALPSIDSequence();
1974   3                 if(TPID2==0x73)
1975   3                {
1976   4                      TP_Type =0x03;
1977   4                }
1978   3                 
1979   3             }  
1980   2              }
1981   1      
1982   1              /*
1983   1              Temp = Read_Eflash_Byte(0x01,0xB0,0xEF);
1984   1      
1985   1              if(Temp != TP_Type)
1986   1              {
1987   1                      eEEPROMBank= 0x00;
1988   1                      eEEPROMAddrsss = 0xEF;
1989   1                      eEEPROMData     = TP_Type;
1990   1                      Update_EEPROMMark();
1991   1              }
1992   1              */
1993   1      }
1994          
1995          void Write_NOVOS4(void)
1996          {
1997   1              if(IS_MASK_CLEAR(LENOVOPMFW_Temp,EEPROM_Token))
1998   1              {
1999   2                      EEPROM_PwrSts = Read_Eflash_Byte(EEPROMA2,(EEPROMA1_B03 | 0x07) ,0xDF);
2000   2                      if(CURRENT_STATUS & ENTER_S4) // S4
2001   2                      {       // Entering S4
2002   3                              //if ( (SYS_STATUS & 0x07) == 0x04 )
2003   3                              if (( (SYS_STATUS & 0x07) >= 0x04 )&&( (SYS_STATUS & 0x07) <= 0x06))    // Win8 or win10 ANGELAS010: add w
             -in10 mode
2004   3                              {       // Win8
2005   4                                      if( (EEPROM_PwrSts & 0x10) == 0 )               // check S4 bit to before.
2006   4                                  {
2007   5                                              if( (EEPROM_PwrSts & 0x01) != 0 )       // check WIN8 bit to before.
2008   5                                              {
2009   6                                                      eEEPROMAddrsss = 0xDF;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 34  

2010   6                                                      eEEPROMBank = 0x07;
2011   6                                                      eEEPROMData = EEPROM_PwrSts = 0xEE;
2012   6                                                      Update_EEPROMMark();
2013   6                                              }
2014   5                                  }
2015   4                                      else
2016   4                                      {
2017   5                                              eEEPROMAddrsss = 0xDF;
2018   5                                              eEEPROMBank = 0x07;
2019   5                                              eEEPROMData = EEPROM_PwrSts = 0xEE;
2020   5                                              Update_EEPROMMark();
2021   5                                      }
2022   4                              }
2023   3                              else
2024   3                              {       // Win7 or other.
2025   4                                      if( (EEPROM_PwrSts & 0x10) == 0 )               // check S4 bit to before.
2026   4                                  {
2027   5                                              if( (EEPROM_PwrSts & 0x01) == 0 )       // check WIN8 bit to before.
2028   5                                              {
2029   6                                                      eEEPROMAddrsss = 0xDF;
2030   6                                                      eEEPROMBank = 0x07;
2031   6                                                      eEEPROMData = EEPROM_PwrSts = 0xEF;
2032   6                                                      Update_EEPROMMark();
2033   6                                              }
2034   5                                  }
2035   4                                      else
2036   4                                      {
2037   5                                              eEEPROMAddrsss = 0xDF;
2038   5                                              eEEPROMBank = 0x07;
2039   5                                              eEEPROMData = EEPROM_PwrSts = 0xEF;
2040   5                                              Update_EEPROMMark();
2041   5                                      }
2042   4                              }
2043   3                      }
2044   2                      else // S5
2045   2                      {
2046   3                              if ( (EEPROM_PwrSts & 0x10) == 0 )              // check S4 bit to before.
2047   3                              {
2048   4                                      eEEPROMAddrsss = 0xDF;
2049   4                                      eEEPROMBank = 0x07;
2050   4                                      eEEPROMData = EEPROM_PwrSts = 0xFF;
2051   4                                      Update_EEPROMMark();
2052   4                              }
2053   3                              else
2054   3                              {
2055   4                                      if ( (EEPROM_PwrSts & 0x01) == 0 )      // check S4 bit to before.
2056   4                                      {
2057   5                                              //if ( (SYS_STATUS & 0x07) != 0x04 )    // Check WIN8.
2058   5                                              if (!( (SYS_STATUS & 0x07) >= 0x04 )&&( (SYS_STATUS & 0x07) <= 0x06))   // check not Win8, win8.1  or w
             -in10 ANGELAS010: add win10 mode
2059   5                                              {
2060   6                                                      eEEPROMAddrsss = 0xDF;
2061   6                                                      eEEPROMBank = 0x07;
2062   6                                                      eEEPROMData = EEPROM_PwrSts = 0xFF;
2063   6                                                      Update_EEPROMMark();
2064   6                                              }
2065   5                                      }
2066   4                              }
2067   3                      }
2068   2              }
2069   1      }
2070          
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 35  

2071          //-----------------------------------------------------------------------------
2072          // The function of pulsing S.B. power button 100ms
2073          //-----------------------------------------------------------------------------
2074          void PulseSBPowerButton(void)
2075          {
2076   1              PM_PWRBTN_LOW();
2077   1          SBSWReleaseCunt = 20;   // decrease timer base is 10ms total time 200ms
2078   1      }
2079          
2080          
2081          //-----------------------------------------------------------------------------
2082          // The function of releasing S.B. power button
2083          //-----------------------------------------------------------------------------
2084          void CheckSBPowerButton(void)
2085          {
2086   1              if(SBSWReleaseCunt!=0x00)
2087   1              {
2088   2                      SBSWReleaseCunt--;
2089   2                      if(SBSWReleaseCunt==0x00)
2090   2                      {
2091   3                              PM_PWRBTN_HI();
2092   3                      }
2093   2              }
2094   1      }
2095          
2096          void GC6_FBClamp(void)
2097          {
2098   1              
2099   1              if( (IS_MASK_SET(SYS_MISC1, ACPI_OS)) && (SystemNotS3) && (SystemNotS5) )
2100   1              {  
2101   2                      // for GC6  function control by interrupt
2102   2              if(IS_MASK_CLEAR(FBClamp, REQactive))
2103   2              {
2104   3                              WUEMR7 |= 0x02;
2105   3                              WUESR7 = 0x02;
2106   3                              SET_MASK(IER9, Int_WKO71);
2107   3                              SET_MASK(FBClamp, REQactive);
2108   3              }
2109   2          }
2110   1              else
2111   1              {
2112   2                      //FB_Clamp_OFF();
2113   2                      CLR_MASK(FBClamp, FBClamp_EN);
2114   2      
2115   2                      if(IS_MASK_SET(FBClamp, REQactive))
2116   2                      {
2117   3                              CLR_MASK(IER9, Int_WKO71);
2118   3                              CLEAR_MASK(FBClamp, REQactive);
2119   3                      }
2120   2              }
2121   1              /*    
2122   1             if(!Read_GC6_EVENT()&& IS_MASK_SET(FBClamp, FBClamp_REQ))
2123   1              {
2124   1                      if(IS_MASK_CLEAR(FBClamp, FBClamp_EN))
2125   1                      {
2126   1                              FB_Clamp_ON();
2127   1                              SET_MASK(FBClamp, FBClamp_EN);
2128   1                              return;
2129   1                      }
2130   1                      else
2131   1                      {
2132   1                              FB_Clamp_OFF();
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 36  

2133   1                              CLR_MASK(FBClamp, FBClamp_EN);
2134   1                              return;
2135   1                      }
2136   1              }
2137   1              }
2138   1      
2139   1              else
2140   1              {
2141   1                      FB_Clamp_OFF();
2142   1                      CLR_MASK(FBClamp, FBClamp_EN);
2143   1              }
2144   1              */   
2145   1      }
2146          
2147          //ANGELAS047:add start
2148          void Lowpower_ENfunction(void)
2149          {
2150   1              SET_MASK(CHGIC_WriteCmd0x12H,LOWPWR_EN);
2151   1              if (!bRWSMBus(SMbusChB, SMbusWW, Charger_Addr, C_ChargerMode, &CHGIC_WriteCmd0x12L,SMBus_NoPEC)) //ANGE
             -LAS059:0x12H to 0x12L 
2152   1          {
2153   2                      CHGIC_SMbusFailCnt++;
2154   2                                 
2155   2          }
2156   1      }
2157          
2158          void Lowpower_DISfunction(void)
2159          {
2160   1              CLEAR_MASK(CHGIC_WriteCmd0x12H,LOWPWR_EN);
2161   1              if (!bRWSMBus(SMbusChB, SMbusWW, Charger_Addr, C_ChargerMode, &CHGIC_WriteCmd0x12L,SMBus_NoPEC)) //ANGE
             -LAS059:0x12H to 0x12L 
2162   1          {
2163   2                       CHGIC_SMbusFailCnt++;
2164   2              }
2165   1      }
2166          //ANGELAS047:add end
2167          
2168          //MEILING002: S+
2169          const sPMICStruct code powerInit[] =
2170          {//     command               REG               no.
2171                  //{ SDWN,                       &PowerSDWN                      }, //ANGELAG002: remove
2172                  { EN_MASK,              &PowerEN_MASK           },
2173                  { EN_RW,                &PowerEN_RW                     },
2174                  
2175                  { BUCK1CTRL,    &PowerBUCK1CTRL         },
2176                  { BUCK2CTRL,    &PowerBUCK2CTRL         },
2177                  { BUCK3CTRL,    &PowerBUCK3CTRL         },
2178                  { LDO1CTRL,             &PowerLDO1CTRL          },
2179                  { LDO2CTRL,             &PowerLDO2CTRL          },
2180                  { DISCHCTRL1,   &PowerDISCHCTRL1        },
2181                  //{ DISCHCTRL2, &PowerDISCHCTRL2        }, //ANGELAG002: remove
2182                  { OC_CTRL,              &PowerOC_CTRL           }, //ANGELAG002: remove
2183                  { BUCK_FSW,             &PowerBUCK_FSW          },
2184          };
2185          
2186          BYTE CheckInitPMIC(void)
2187          {
2188   1              PowerReturnData=0xFE; //ANGELAN011 add
2189   1              if(!PowerIICWriteByte(0xE2,0x00)) //ANGELAN011 03 to 00
2190   1              {
2191   2                      RamDebug(0xC1);
2192   2                      return 0;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 37  

2193   2              }
2194   1              return 1;
2195   1      }
2196          //ANGELAN011 add s
2197          //ANGELAG030: add start
2198          //ANGELAG011: remove end
2199          void PMICID(void)
2200          {
2201   1              if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, VENDODID, &PowerVENDODID,SMBus_NoPEC))
2202   1              {
2203   2                      PowerInitError++;
2204   2              }
2205   1      }
2206          //ANGELAG011: remove start
2207          //ANGELAG030: add end
2208          //ANGELAN011 add e
2209          //Reference G330 ICF I+N EC Parameter V01 20171018
2210          void InitPMICReg(void)
2211          {
2212   1      //      PMICID(); //ANGELAG011: remove //ANGELAN011 add
2213   1      //ANGELAG030: add start
2214   1              if(PowerVENDODID == 0)
2215   1              {
2216   2                      PMICID(); //ANGELAG011: remove //ANGELAN011 add
2217   2              }
2218   1      //ANGELAG030: add end
2219   1              PowerInitIndex = 0;
2220   1      
2221   1              //PowerSDWN = 0x00;
2222   1              PowerEN_MASK = 0x80; 
2223   1              PowerEN_RW = 0x80;  //set to 0x80 allow EC write PMIC
2224   1              ////ANGELAN011 add s
2225   1              if(PowerVENDODID==0x53) //ANGELAG030: add //ANGELAG011: remove //ANGELAN013 //5028
2226   1              { //ANGELAG030: add //ANGELAG011: remove
2227   2                      PowerBUCK1CTRL = 0x26;  
2228   2                      PowerBUCK2CTRL = 0x2C;  //ANGELAG053: modify 2c to 3c
2229   2                      PowerBUCK3CTRL = 0x3E; //ANGELAG040: from 0x34 to 0x36 to solve GPU noise issue.
2230   2                      PowerLDO1CTRL = 0x1E;  
2231   2                      PowerLDO2CTRL = 0x02; 
2232   2                      PowerDISCHCTRL1 = 0x15;
2233   2              
2234   2              PowerOC_CTRL = 0x35;
2235   2                      PowerBUCK_FSW = 0x03; 
2236   2                      //ANGELAG030: add start
2237   2               //ANGELAG011: remove start
2238   2              }
2239   1              else //5075 
2240   1              {
2241   2      // //ANGELAN011 add e
2242   2                      PowerBUCK1CTRL = 0x26; //ANGELAG053: 26 TO 24
2243   2                      PowerBUCK2CTRL = 0x0C;  //ANGELAN013: 28 to 04 //ANGELAN002: 08 to 28 follow power demand
2244   2                      PowerBUCK3CTRL = 0x3E;  //ANGELAN008 modify 0x34 to 0x38 follow power demand.
2245   2                      PowerLDO1CTRL = 0x1E;  
2246   2                      PowerLDO2CTRL = 0x04; // 
2247   2                      PowerDISCHCTRL1 = 0x15;
2248   2                      
2249   2              PowerOC_CTRL = 0x35;
2250   2                      PowerBUCK_FSW = 0x00; 
2251   2              } //ANGELAG030: add end //ANGELAN011 Add //ANGELAG011: remove end
2252   1              
2253   1              while(PowerInitIndex < (sizeof(powerInit)/sizeof(sPMICStruct)))
2254   1              {
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 38  

2255   2                      if(PowerIICWriteByte(powerInit[PowerInitIndex].cmd, *powerInit[PowerInitIndex].smbdataA))
2256   2                      {
2257   3                              PowerInitIndex++;
2258   3                      }
2259   2                      else
2260   2                      {
2261   3                              PowerInitIndex++;
2262   3                              RamDebug(0xC2);
2263   3                              RamDebug(PowerInitErrorCMD);
2264   3                              RamDebug(PowerInitErrorDATA);
2265   3                      }
2266   2              }
2267   1      
2268   1              if(!PowerIICWriteByte(0xD1,0xBF))  // set to 0xBF, then PMIC run
2269   1              {
2270   2                      RamDebug(0xC3);
2271   2                      RamDebug(PowerInitErrorCMD);
2272   2                      RamDebug(PowerInitErrorDATA);
2273   2              }
2274   1      }
2275          
2276          void InitPMIC(void)
2277          {
2278   1              if(!PowerInitOK)
2279   1              {       
2280   2                      if(CheckInitPMIC())
2281   2                      {
2282   3                              InitPMICReg();
2283   3                              RamDebug(0xC0);
2284   3                              PowerInitOK=1;
2285   3                      }
2286   2              }
2287   1      }
2288          
2289          BYTE PowerIICWriteByte(BYTE Reg_offset, BYTE PS_data)
2290          {
2291   1              PMIC_counter = 0;
2292   1              
2293   1              while(1)
2294   1              {
2295   2                      if(!bRWSMBus(SMbusChA, SMbusWB, powerICaddress, Reg_offset, &PS_data, SMBus_NoPEC))
2296   2                      {
2297   3                              PowerInitError++;
2298   3                              ResetSMBus(SMbusChA); 
2299   3                      }
2300   2                      if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, Reg_offset, &PowerReturnData,SMBus_NoPEC))
2301   2                      {
2302   3                              PowerInitError++;
2303   3                              ResetSMBus(SMbusChA);
2304   3                      }
2305   2                      if(PowerReturnData == PS_data)
2306   2                      {
2307   3                              return 1;
2308   3                      }
2309   2                      else
2310   2                      {
2311   3                              if(PMIC_counter == 5)
2312   3                              {
2313   4                                      return 0;
2314   4                              }
2315   3                              PowerInitErrorCMD=Reg_offset;
2316   3                              PowerInitErrorDATA=PowerReturnData;
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 39  

2317   3                              PMIC_counter++;
2318   3                      }
2319   2              }
2320   1      }
2321          
2322          void PollingOTP(void)
2323          {
2324   1              if(PowerInitOK==1)
2325   1              {
2326   2              //ANGELAG007: add start
2327   2                      if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, OVP_REG, &PowerOVP_REG,SMBus_NoPEC))
2328   2                      {
2329   3                              PowerInitError++;
2330   3                      }
2331   2                      if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, UVP_REG, &PowerUVP_REG,SMBus_NoPEC))
2332   2                      {
2333   3                              PowerInitError++;
2334   3                      }
2335   2                      if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, OCP_REG, &PowerOCP_REG,SMBus_NoPEC))
2336   2                      {
2337   3                              PowerInitError++;
2338   3                      }
2339   2                      //ANGELAG007: add end
2340   2                      if(!bRWSMBus(SMbusChA, SMbusRB, powerICaddress, OTP_REG, &PowerOTP_REG,SMBus_NoPEC))
2341   2                      {
2342   3                              PowerInitError++;
2343   3                      //      ResetSMBus(SMbusChA); //ANGELAG007: REMOVE
2344   3                      }
2345   2              }
2346   1      }
2347          //MEILING002: E+
2348          
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 40  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com015C (BEGIN)
0000         L?0349:
0000 900000      E     MOV     DPTR,#PWSeqStep
0003 E0                MOVX    A,@DPTR
0004 75F005            MOV     B,#05H
0007 A4                MUL     AB
0008 2400        R     ADD     A,#LOW asPowerSEQS5DSX+02H
000A F582              MOV     DPL,A
000C E4                CLR     A
000D 3400        R     ADDC    A,#HIGH asPowerSEQS5DSX+02H
000F         L?0350:
000F F583              MOV     DPH,A
0011 E4                CLR     A
0012 93                MOVC    A,@A+DPTR
0013 FF                MOV     R7,A
0014 7401              MOV     A,#01H
0016 93                MOVC    A,@A+DPTR
0017 900000      E     MOV     DPTR,#PowSeqDelay
001A CF                XCH     A,R7
001B F0                MOVX    @DPTR,A
001C A3                INC     DPTR
001D EF                MOV     A,R7
001E F0                MOVX    @DPTR,A
001F 900000      E     MOV     DPTR,#PWSeqStep
0022 E0                MOVX    A,@DPTR
0023 04                INC     A
0024 F0                MOVX    @DPTR,A
0025 22                RET     
0026         L?0351:
0026         L?0352:
0026 F583              MOV     DPH,A
0028 E4                CLR     A
0029 93                MOVC    A,@A+DPTR
002A FE                MOV     R6,A
002B 7401              MOV     A,#01H
002D 93                MOVC    A,@A+DPTR
002E CA                XCH     A,R2
002F EE                MOV     A,R6
0030 CA                XCH     A,R2
0031 F9                MOV     R1,A
0032 120000      E     LCALL   ?C?ICALL
0035         L?0353:
0035 900000      E     MOV     DPTR,#PWSeqStep
0038 E0                MOVX    A,@DPTR
0039 75F005            MOV     B,#05H
003C A4                MUL     AB
003D 22                RET     
003E         L?0354:
003E         L?0355:
003E 900000      E     MOV     DPTR,#pDevStatus3
0041 E0                MOVX    A,@DPTR
0042 54BF              ANL     A,#0BFH
0044 F0                MOVX    @DPTR,A
0045 547F              ANL     A,#07FH
0047 F0                MOVX    @DPTR,A
0048 900000      E     MOV     DPTR,#pDevStatus1
004B E0                MOVX    A,@DPTR
004C 54FE              ANL     A,#0FEH
004E F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 41  

004F E0                MOVX    A,@DPTR
0050 54FD              ANL     A,#0FDH
0052 F0                MOVX    @DPTR,A
0053         L?0356:
0053 E0                MOVX    A,@DPTR
0054 54EF              ANL     A,#0EFH
0056 F0                MOVX    @DPTR,A
0057         L?0357:
0057 E0                MOVX    A,@DPTR
0058 54DF              ANL     A,#0DFH
005A F0                MOVX    @DPTR,A
005B E0                MOVX    A,@DPTR
005C 54BF              ANL     A,#0BFH
005E F0                MOVX    @DPTR,A
005F 22                RET     
0060         L?0358:
0060 2400        R     ADD     A,#LOW asPowerSEQS5DSX
0062 F582              MOV     DPL,A
0064 E4                CLR     A
0065 3400        R     ADDC    A,#HIGH asPowerSEQS5DSX
0067         L?0359:
0067 F583              MOV     DPH,A
0069 E4                CLR     A
006A 93                MOVC    A,@A+DPTR
006B FE                MOV     R6,A
006C 7401              MOV     A,#01H
006E 93                MOVC    A,@A+DPTR
006F CA                XCH     A,R2
0070 EE                MOV     A,R6
0071 CA                XCH     A,R2
0072 F9                MOV     R1,A
0073 020000      E     LJMP    ?C?ICALL
0076         L?0360:
0076         L?0361:
0076 900000      E     MOV     DPTR,#PowSeqDelay
0079 74FF              MOV     A,#0FFH
007B F5F0              MOV     B,A
007D 120000      E     LCALL   ?C?IILDX
0080 900000      E     MOV     DPTR,#PowSeqDelay
0083 E0                MOVX    A,@DPTR
0084 22                RET     
0085         L?0363:
0085         L?0364:
0085 900000      E     MOV     DPTR,#eEEPROMAddrsss
0088 74DF              MOV     A,#0DFH
008A F0                MOVX    @DPTR,A
008B 900000      E     MOV     DPTR,#eEEPROMBank
008E 7407              MOV     A,#07H
0090 F0                MOVX    @DPTR,A
0091 900000      E     MOV     DPTR,#EEPROM_PwrSts
0094 22                RET     
0095         L?0365:
0095 F0                MOVX    @DPTR,A
0096 900000      E     MOV     DPTR,#TEMP_Buff_3
0099 F0                MOVX    @DPTR,A
009A 900000      E     MOV     DPTR,#TEMP_Buff_2
009D F0                MOVX    @DPTR,A
009E 900000      E     MOV     DPTR,#TEMP_Buff_1
00A1 F0                MOVX    @DPTR,A
00A2 900000      E     MOV     DPTR,#nCpuTemp
00A5 F0                MOVX    @DPTR,A
00A6 900000      E     MOV     DPTR,#VGA_TBuff1
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 42  

00A9 F0                MOVX    @DPTR,A
00AA 900000      E     MOV     DPTR,#VGA_TBuff2
00AD F0                MOVX    @DPTR,A
00AE 900000      E     MOV     DPTR,#VGA_TBuff3
00B1 F0                MOVX    @DPTR,A
00B2 900000      E     MOV     DPTR,#VGA_TEMP
00B5 F0                MOVX    @DPTR,A
00B6 900000      E     MOV     DPTR,#nRamTemp
00B9 F0                MOVX    @DPTR,A
00BA 900000      E     MOV     DPTR,#nNBTemp
00BD F0                MOVX    @DPTR,A
00BE 22                RET     
00BF         L?0366:
00BF A3                INC     DPTR
00C0         L?0367:
00C0 F0                MOVX    @DPTR,A
00C1 E4                CLR     A
00C2 A3                INC     DPTR
00C3 F0                MOVX    @DPTR,A
00C4 7B68              MOV     R3,#068H
00C6 7D08              MOV     R5,#08H
00C8 FF                MOV     R7,A
00C9 22                RET     
00CA         L?0368:
00CA         L?0369:
00CA 900000      E     MOV     DPTR,#PWSeqStep
00CD 7401              MOV     A,#01H
00CF         L?0370:
00CF F0                MOVX    @DPTR,A
00D0 E4                CLR     A
00D1 900000      E     MOV     DPTR,#PowSeqDelay
00D4 F0                MOVX    @DPTR,A
00D5 A3                INC     DPTR
00D6 F0                MOVX    @DPTR,A
00D7 22                RET     
00D8         L?0371:
00D8 E4                CLR     A
00D9 900000      E     MOV     DPTR,#batteryFirstUsedDateH
00DC F0                MOVX    @DPTR,A
00DD 900000      E     MOV     DPTR,#batteryFirstUsedDateL
00E0 F0                MOVX    @DPTR,A
00E1 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
00E4 743F              MOV     A,#03FH
00E6 F0                MOVX    @DPTR,A
00E7 7E00        E     MOV     R6,#HIGH batteryFirstUsedDateL
00E9 A3                INC     DPTR
00EA 7400        E     MOV     A,#HIGH batteryFirstUsedDateL
00EC F0                MOVX    @DPTR,A
00ED A3                INC     DPTR
00EE 7400        E     MOV     A,#LOW batteryFirstUsedDateL
00F0 F0                MOVX    @DPTR,A
00F1 A3                INC     DPTR
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
00F5 7B16              MOV     R3,#016H
00F7 22                RET     
00F8         L?0372:
00F8 F0                MOVX    @DPTR,A
00F9         L?0373:
00F9 900000      E     MOV     DPTR,#GPDRF
00FC E0                MOVX    A,@DPTR
00FD 4402              ORL     A,#02H
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 43  

00FF F0                MOVX    @DPTR,A
0100 22                RET     
0101         L?0374:
0101 F0                MOVX    @DPTR,A
0102         L?0375:
0102 900000      E     MOV     DPTR,#cCmd
0105 E0                MOVX    A,@DPTR
0106 54F7              ANL     A,#0F7H
0108 F0                MOVX    @DPTR,A
0109 900000      E     MOV     DPTR,#OEMControl
010C E0                MOVX    A,@DPTR
010D 54FD              ANL     A,#0FDH
010F F0                MOVX    @DPTR,A
0110 22                RET     
0111         L?0376:
0111 F0                MOVX    @DPTR,A
0112 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
0115 7412              MOV     A,#012H
0117 F0                MOVX    @DPTR,A
0118 7E00        E     MOV     R6,#HIGH CHGIC_WriteCmd0x12L
011A A3                INC     DPTR
011B 7400        E     MOV     A,#HIGH CHGIC_WriteCmd0x12L
011D F0                MOVX    @DPTR,A
011E A3                INC     DPTR
011F 7400        E     MOV     A,#LOW CHGIC_WriteCmd0x12L
0121 F0                MOVX    @DPTR,A
0122 E4                CLR     A
0123 A3                INC     DPTR
0124 F0                MOVX    @DPTR,A
0125 7B12              MOV     R3,#012H
0127 7D8C              MOV     R5,#08CH
0129 7F01              MOV     R7,#01H
012B 22                RET     
012C         L?0377:
012C         L?0378:
012C 900000      E     MOV     DPTR,#GPCRD5
012F 7440              MOV     A,#040H
0131 F0                MOVX    @DPTR,A
0132 900000      E     MOV     DPTR,#GPDRD
0135 E0                MOVX    A,@DPTR
0136 54DF              ANL     A,#0DFH
0138 F0                MOVX    @DPTR,A
0139 22                RET     
013A         L?0379:
013A         L?0380:
013A 900000      E     MOV     DPTR,#PowerInitError
013D E0                MOVX    A,@DPTR
013E 04                INC     A
013F F0                MOVX    @DPTR,A
0140 22                RET     
0141         L?0381:
0141 900000      E     MOV     DPTR,#CPU_TYPE
0144 E0                MOVX    A,@DPTR
0145 543F              ANL     A,#03FH
0147 F0                MOVX    @DPTR,A
0148 E4                CLR     A
0149 900000      E     MOV     DPTR,#EXTVGA_Shut_Cnt
014C F0                MOVX    @DPTR,A
014D 900000      E     MOV     DPTR,#VGA_Shut_Cnt
0150 F0                MOVX    @DPTR,A
0151 900000      E     MOV     DPTR,#CPU_Shut_Cnt
0154 22                RET     
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 44  

0155         L?0382:
0155 900000      E     MOV     DPTR,#PowerBUCK2CTRL
0158 F0                MOVX    @DPTR,A
0159 900000      E     MOV     DPTR,#PowerBUCK3CTRL
015C 743E              MOV     A,#03EH
015E F0                MOVX    @DPTR,A
015F 900000      E     MOV     DPTR,#PowerLDO1CTRL
0162 741E              MOV     A,#01EH
0164 F0                MOVX    @DPTR,A
0165 900000      E     MOV     DPTR,#PowerLDO2CTRL
0168 22                RET     
0169         L?0384:
0169         L?0385:
0169 900000      E     MOV     DPTR,#GPDRH
016C E0                MOVX    A,@DPTR
016D 54FE              ANL     A,#0FEH
016F F0                MOVX    @DPTR,A
0170 22                RET     
0171         L?0386:
0171         L?0387:
0171 900000      E     MOV     DPTR,#GPDRF
0174 E0                MOVX    A,@DPTR
0175 54FD              ANL     A,#0FDH
0177 F0                MOVX    @DPTR,A
0178 22                RET     
0179         L?0390:
0179 900000      E     MOV     DPTR,#delayEDPTm
017C         L?0391:
017C F0                MOVX    @DPTR,A
017D 900000      E     MOV     DPTR,#pDevStus
0180 E0                MOVX    A,@DPTR
0181 4408              ORL     A,#08H
0183 22                RET     
0184         L?0392:
0184 900000      E     MOV     DPTR,#GPDRF
0187 E0                MOVX    A,@DPTR
0188 54DF              ANL     A,#0DFH
018A F0                MOVX    @DPTR,A
018B 900000      E     MOV     DPTR,#GPDRC
018E E0                MOVX    A,@DPTR
018F 54BF              ANL     A,#0BFH
0191 F0                MOVX    @DPTR,A
0192 22                RET     
0193         L?0393:
0193 F0                MOVX    @DPTR,A
0194 900000      E     MOV     DPTR,#PowerDISCHCTRL1
0197 7415              MOV     A,#015H
0199 F0                MOVX    @DPTR,A
019A 900000      E     MOV     DPTR,#PowerOC_CTRL
019D 7435              MOV     A,#035H
019F F0                MOVX    @DPTR,A
01A0 22                RET     
01A1         L?0394:
01A1 900000      E     MOV     DPTR,#Fan_ON_Count
01A4 741E              MOV     A,#01EH
01A6 F0                MOVX    @DPTR,A
01A7 900000      E     MOV     DPTR,#disable_turbo_counter
01AA 743C              MOV     A,#03CH
01AC F0                MOVX    @DPTR,A
01AD 22                RET     
01AE         L?0395:
01AE 900000      E     MOV     DPTR,#ERR_THMSTS
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 45  

01B1 F0                MOVX    @DPTR,A
01B2 900000      E     MOV     DPTR,#Thro_Status2
01B5 F0                MOVX    @DPTR,A
01B6 900000      E     MOV     DPTR,#Thro_Status
01B9 F0                MOVX    @DPTR,A
01BA 22                RET     
01BB         L?0397:
01BB         L?0398:
01BB 900000      E     MOV     DPTR,#GPCRA0
01BE E0                MOVX    A,@DPTR
01BF 900000      E     MOV     DPTR,#ShutDnCause
01C2 22                RET     
01C3         L?0399:
01C3         L?0400:
01C3 900000      E     MOV     DPTR,#GPDRF
01C6 E0                MOVX    A,@DPTR
01C7 54FE              ANL     A,#0FEH
01C9 F0                MOVX    @DPTR,A
01CA 22                RET     
01CB         L?0401:
01CB 900000      E     MOV     DPTR,#ACPI_HOTKEY
01CE E0                MOVX    A,@DPTR
01CF 547F              ANL     A,#07FH
01D1 F0                MOVX    @DPTR,A
01D2 E0                MOVX    A,@DPTR
01D3 54BF              ANL     A,#0BFH
01D5 F0                MOVX    @DPTR,A
01D6 22                RET     
01D7         L?0402:
01D7         L?0403:
01D7 900000      E     MOV     DPTR,#GPDRA
01DA E0                MOVX    A,@DPTR
01DB 4480              ORL     A,#080H
01DD F0                MOVX    @DPTR,A
01DE 22                RET     
01DF         L?0404:
01DF 900000      E     MOV     DPTR,#PWSeqStep
01E2 F0                MOVX    @DPTR,A
01E3 900000      E     MOV     DPTR,#PowSeqDelay
01E6 E4                CLR     A
01E7 F0                MOVX    @DPTR,A
01E8 A3                INC     DPTR
01E9 22                RET     
01EA         L?0405:
01EA F0                MOVX    @DPTR,A
01EB E4                CLR     A
01EC 900000      E     MOV     DPTR,#initMark
01EF F0                MOVX    @DPTR,A
01F0 900000      E     MOV     DPTR,#TEMP_Error
01F3 F0                MOVX    @DPTR,A
01F4 22                RET     
01F5         L?0406:
01F5         L?0407:
01F5 900000      E     MOV     DPTR,#ShipModeEn
01F8 E0                MOVX    A,@DPTR
01F9 64A5              XRL     A,#0A5H
01FB 22                RET     
01FC         L?0408:
01FC F0                MOVX    @DPTR,A
01FD 900000      E     MOV     DPTR,#GPCRH2
0200 F0                MOVX    @DPTR,A
0201 900000      E     MOV     DPTR,#GPCRA5
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 46  

0204 F0                MOVX    @DPTR,A
0205 22                RET     
0206         L?0409:
0206 900000      E     MOV     DPTR,#AdapterIDOn_Flag
0209 7401              MOV     A,#01H
020B F0                MOVX    @DPTR,A
020C 900000      E     MOV     DPTR,#ADPIDON10MS_NUM
020F 22                RET     
0210         L?0410:
0210         L?0411:
0210 7B04              MOV     R3,#04H
0212 7DE9              MOV     R5,#0E9H
0214 7F02              MOV     R7,#02H
0216 22                RET     
0217         L?0412:
0217         L?0413:
0217 900000      E     MOV     DPTR,#SYS_STATUS
021A E0                MOVX    A,@DPTR
021B 5407              ANL     A,#07H
021D 22                RET     
             ; FUNCTION Com015C (END)

             ; FUNCTION CheckResetSource (BEGIN)
                                           ; SOURCE LINE # 24
                                           ; SOURCE LINE # 25
                                           ; SOURCE LINE # 27
                                           ; SOURCE LINE # 28
0000 120000      R     LCALL   L?0414
0003 FF                MOV     R7,A
0004 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 29
0007 900000      E     MOV     DPTR,#GPCRA0
000A E0                MOVX    A,@DPTR
000B FF                MOV     R7,A
000C 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 30
000F 900000      E     MOV     DPTR,#PWRSW8SRST
0012 E0                MOVX    A,@DPTR
0013 FF                MOV     R7,A
0014 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 31
                                           ; SOURCE LINE # 32
0017 120000      R     LCALL   L?0414
001A 5403              ANL     A,#03H
001C 14                DEC     A
001D 600A              JZ      ?C0003
001F 14                DEC     A
0020 6014              JZ      ?C0006
0022 14                DEC     A
0023 601E              JZ      ?C0009
0025 2403              ADD     A,#03H
0027 7028              JNZ     ?C0001
                                           ; SOURCE LINE # 33
                                           ; SOURCE LINE # 34
                                           ; SOURCE LINE # 35
0029         ?C0003:
                                           ; SOURCE LINE # 36
0029 120000      R     LCALL   L?0397
002C B48005            CJNE    A,#080H,?C0004
                                           ; SOURCE LINE # 37
                                           ; SOURCE LINE # 38
002F 74FC              MOV     A,#0FCH
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 47  

0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 39
0032 801D              SJMP    ?C0001
0034         ?C0004:
                                           ; SOURCE LINE # 41
                                           ; SOURCE LINE # 42
                                           ; SOURCE LINE # 43
                                           ; SOURCE LINE # 44
0034 8018              SJMP    ?C0338
                                           ; SOURCE LINE # 46
0036         ?C0006:
                                           ; SOURCE LINE # 47
0036 120000      R     LCALL   L?0397
0039 B48005            CJNE    A,#080H,?C0007
                                           ; SOURCE LINE # 48
                                           ; SOURCE LINE # 49
003C 74FE              MOV     A,#0FEH
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 50
003F 8010              SJMP    ?C0001
0041         ?C0007:
                                           ; SOURCE LINE # 52
                                           ; SOURCE LINE # 53
0041         ?C0337:
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 55
0041 800B              SJMP    ?C0338
                                           ; SOURCE LINE # 57
0043         ?C0009:
                                           ; SOURCE LINE # 58
0043 120000      R     LCALL   L?0398
0046 B48005            CJNE    A,#080H,?C0010
                                           ; SOURCE LINE # 59
                                           ; SOURCE LINE # 60
0049 74FF              MOV     A,#0FFH
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 61
004C 8003              SJMP    ?C0001
004E         ?C0010:
                                           ; SOURCE LINE # 63
                                           ; SOURCE LINE # 64
004E         ?C0338:
004E 74EC              MOV     A,#0ECH
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 65
                                           ; SOURCE LINE # 66
                                           ; SOURCE LINE # 67
0051         ?C0001:
                                           ; SOURCE LINE # 70
0051 900000      E     MOV     DPTR,#PWRSW8SRST
0054 E0                MOVX    A,@DPTR
0055 30E106            JNB     ACC.1,?C0013
                                           ; SOURCE LINE # 71
                                           ; SOURCE LINE # 72
0058 900000      E     MOV     DPTR,#ShutDnCause
005B 74FD              MOV     A,#0FDH
005D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 73
                                           ; SOURCE LINE # 77
005E         ?C0013:
005E 22                RET     
005F         L?0414:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 48  

005F 7FBB              MOV     R7,#0BBH
0061 120000      E     LCALL   _RamDebug
0064 900000      E     MOV     DPTR,#RSTStatus
0067 E0                MOVX    A,@DPTR
0068 22                RET     
             ; FUNCTION CheckResetSource (END)

             ; FUNCTION Check_LPC_Reset (BEGIN)
                                           ; SOURCE LINE # 79
                                           ; SOURCE LINE # 80
                                           ; SOURCE LINE # 81
0000 900000      E     MOV     DPTR,#GPDRD
0003 E0                MOVX    A,@DPTR
0004 30E203            JNB     ACC.2,?C0015
0007 D3                SETB    C
0008 8001              SJMP    ?C0016
000A         ?C0015:
000A C3                CLR     C
000B         ?C0016:
000B 4011              JC      ?C0017
                                           ; SOURCE LINE # 82
                                           ; SOURCE LINE # 84
000D 900000      E     MOV     DPTR,#KBHISR
0010 E0                MOVX    A,@DPTR
0011 54FB              ANL     A,#0FBH
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 85
0014 900000      E     MOV     DPTR,#SYS_MISC1
0017 E0                MOVX    A,@DPTR
0018 547F              ANL     A,#07FH
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 86
001B 120000      R     LCALL   OEM_LPC_Reset
                                           ; SOURCE LINE # 92
                                           ; SOURCE LINE # 93
001E         ?C0017:
001E 22                RET     
             ; FUNCTION Check_LPC_Reset (END)

             ; FUNCTION OEM_LPC_Reset (BEGIN)
                                           ; SOURCE LINE # 95
                                           ; SOURCE LINE # 96
                                           ; SOURCE LINE # 98
0000 900000      E     MOV     DPTR,#uReserve07
                                           ; SOURCE LINE # 99
                                           ; SOURCE LINE # 100
0003 120000      R     LCALL   L?0356
                                           ; SOURCE LINE # 102
0006 900000      E     MOV     DPTR,#CPU_TYPE
0009 E0                MOVX    A,@DPTR
000A 543F              ANL     A,#03FH
                                           ; SOURCE LINE # 103
000C 120000      R     LCALL   L?0391
                                           ; SOURCE LINE # 105
                                           ; SOURCE LINE # 106
000F 120000      R     LCALL   L?0374
                                           ; SOURCE LINE # 107
0012 900000      E     MOV     DPTR,#SMartNoise
0015 7404              MOV     A,#04H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 108
0018 900000      E     MOV     DPTR,#BackLight_En_Delay
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 49  

001B 7428              MOV     A,#028H
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 111
001E 900000      E     MOV     DPTR,#LENOVOPMFW
0021 E0                MOVX    A,@DPTR
0022 54FB              ANL     A,#0FBH
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 112
0025 E0                MOVX    A,@DPTR
0026 54FE              ANL     A,#0FEH
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 113
0029 E4                CLR     A
002A 900000      E     MOV     DPTR,#LENOVOPMFW_Temp
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 114
002E 900000      E     MOV     DPTR,#ACOFF_SOURCE
0031 E0                MOVX    A,@DPTR
0032 54FB              ANL     A,#0FBH
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 123
                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 127
                                           ; SOURCE LINE # 129
                                           ; SOURCE LINE # 131
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 133
0035 120000      R     LCALL   L?0354
                                           ; SOURCE LINE # 134
0038 E0                MOVX    A,@DPTR
0039 547F              ANL     A,#07FH
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 137
003C 900000      E     MOV     DPTR,#DisCPUTurboFor90s
003F E4                CLR     A
0040 F0                MOVX    @DPTR,A
0041 A3                INC     DPTR
0042 745A              MOV     A,#05AH
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 138
0045 900000      E     MOV     DPTR,#uVGATurboFun
0048 E0                MOVX    A,@DPTR
0049 54F7              ANL     A,#0F7H
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 139
004C 22                RET     
             ; FUNCTION OEM_LPC_Reset (END)

             ; FUNCTION Charge_inhibit2sec (BEGIN)
                                           ; SOURCE LINE # 141
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 143
0000 900000      E     MOV     DPTR,#inhibit2sec
0003 7414              MOV     A,#014H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 144
0006 900000      E     MOV     DPTR,#nStopChgStat3L
0009 E0                MOVX    A,@DPTR
000A 4408              ORL     A,#08H
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 145
000D 900000      E     MOV     DPTR,#CHGIC_ptr
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 50  

0010 7402              MOV     A,#02H
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
0013 020000      E     LJMP    WriteSmartChgIC
             ; FUNCTION Charge_inhibit2sec (END)

             ; FUNCTION CHK_SUSACK (BEGIN)
                                           ; SOURCE LINE # 149
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 185
0000 22                RET     
             ; FUNCTION CHK_SUSACK (END)

             ; FUNCTION S5DSX_RSMRST_LOW (BEGIN)
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
                                           ; SOURCE LINE # 235
0000 120000      R     LCALL   L?0384
                                           ; SOURCE LINE # 236
0003 22                RET     
             ; FUNCTION S5DSX_RSMRST_LOW (END)

             ; FUNCTION S5DSX_PCH_PWR_EN_OFF (BEGIN)
                                           ; SOURCE LINE # 238
                                           ; SOURCE LINE # 239
                                           ; SOURCE LINE # 240
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 54EF              ANL     A,#0EFH
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 242
0007 22                RET     
             ; FUNCTION S5DSX_PCH_PWR_EN_OFF (END)

             ; FUNCTION S5DSX_EC_ON_LOW (BEGIN)
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
                                           ; SOURCE LINE # 246
0000 120000      R     LCALL   L?0399
                                           ; SOURCE LINE # 247
0003 22                RET     
             ; FUNCTION S5DSX_EC_ON_LOW (END)

             ; FUNCTION S5DSX_PWR_BTN_LOW (BEGIN)
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 250
                                           ; SOURCE LINE # 251
0000 120000      R     LCALL   L?0386
                                           ; SOURCE LINE # 252
0003 22                RET     
             ; FUNCTION S5DSX_PWR_BTN_LOW (END)

             ; FUNCTION Enter_ShipMode (BEGIN)
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 256
                                           ; SOURCE LINE # 258
0000 120000      R     LCALL   L?0406
0003 6007              JZ      ?C0026
0005 900000      E     MOV     DPTR,#EMStatusBit2
0008 E0                MOVX    A,@DPTR
0009 30E01A            JNB     ACC.0,?C0027
000C         ?C0026:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 51  

                                           ; SOURCE LINE # 259
                                           ; SOURCE LINE # 261
000C 900000      E     MOV     DPTR,#BATTUPDATEFW
000F E0                MOVX    A,@DPTR
0010 4401              ORL     A,#01H
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 262
0013 7FC8              MOV     R7,#0C8H
0015 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 263
0018 7F64              MOV     R7,#064H
001A 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 264
                                           ; SOURCE LINE # 265
                                           ; SOURCE LINE # 266
                                           ; SOURCE LINE # 267
001D 120000      R     LCALL   L?0362
                                           ; SOURCE LINE # 268
0020 120000      E     LCALL   Lock_ShipMode
                                           ; SOURCE LINE # 270
                                           ; SOURCE LINE # 271
                                           ; SOURCE LINE # 272
                                           ; SOURCE LINE # 273
0023 120000      R     LCALL   L?0362
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 277
0026         ?C0027:
0026 22                RET     
0027         L?0362:
0027 7FFA              MOV     R7,#0FAH
0029 120000      E     LCALL   _Delay1MS
002C 7FFA              MOV     R7,#0FAH
002E 120000      E     LCALL   _Delay1MS
0031 7FFA              MOV     R7,#0FAH
0033 120000      E     LCALL   _Delay1MS
0036 7FFA              MOV     R7,#0FAH
0038 120000      E     LCALL   _Delay1MS
003B 22                RET     
             ; FUNCTION Enter_ShipMode (END)

             ; FUNCTION RecordenEnterShipMode (BEGIN)
                                           ; SOURCE LINE # 279
                                           ; SOURCE LINE # 280
                                           ; SOURCE LINE # 282
0000 120000      R     LCALL   L?0406
0003 6007              JZ      ?C0029
0005 900000      E     MOV     DPTR,#EMStatusBit2
0008 E0                MOVX    A,@DPTR
0009 30E021            JNB     ACC.0,?C0033
000C         ?C0029:
                                           ; SOURCE LINE # 283
                                           ; SOURCE LINE # 284
000C E4                CLR     A
000D 900000      E     MOV     DPTR,#ShipModeEn
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 285
0011 7FA6              MOV     R7,#0A6H
0013 120000      E     LCALL   _ProcessSID
                                           ; SOURCE LINE # 286
0016 900000      E     MOV     DPTR,#nBattGasgauge
0019 E0                MOVX    A,@DPTR
001A C3                CLR     C
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 52  

001B 945F              SUBB    A,#05FH
001D 5007              JNC     ?C0030
                                           ; SOURCE LINE # 287
                                           ; SOURCE LINE # 288
001F 7FA8              MOV     R7,#0A8H
0021 120000      E     LCALL   _ProcessSID
0024         ?C0031:
                                           ; SOURCE LINE # 289
0024 80FE              SJMP    ?C0031
                                           ; SOURCE LINE # 290
0026         ?C0030:
                                           ; SOURCE LINE # 291
0026 900000      E     MOV     DPTR,#BATTUPDATEFW
0029 E0                MOVX    A,@DPTR
002A 54FE              ANL     A,#0FEH
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
                                           ; SOURCE LINE # 294
002D         ?C0033:
002D 22                RET     
             ; FUNCTION RecordenEnterShipMode (END)

             ; FUNCTION S5DSX_Init_Status (BEGIN)
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
                                           ; SOURCE LINE # 299
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#PowerInitOK
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 300
0005 900000      E     MOV     DPTR,#SysPowState
0008 7466              MOV     A,#066H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 301
000B 7F0C              MOV     R7,#0CH
000D 020000      E     LJMP    _RamDebug
             ; FUNCTION S5DSX_Init_Status (END)

             ; FUNCTION Oem_S5DSXSequence (BEGIN)
                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
                                           ; SOURCE LINE # 320
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0319
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0319:
0008 6009              JZ      ?C0038
                                           ; SOURCE LINE # 321
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
000A 120000      R     LCALL   L?0360
000D 7002              JNZ     ?C0320
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0320:
0011 703B              JNZ     ?C0037
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
0013         ?C0038:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 53  

                                           ; SOURCE LINE # 329
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 9408              SUBB    A,#08H
001A 5032              JNC     ?C0037
                                           ; SOURCE LINE # 330
                                           ; SOURCE LINE # 331
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQS5DSX+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH asPowerSEQS5DSX+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7014              JNZ     ?C0040
                                           ; SOURCE LINE # 332
                                           ; SOURCE LINE # 333
002E 120000      R     LCALL   L?0353
0031 120000      R     LCALL   L?0358
                                           ; SOURCE LINE # 334
                                           ; SOURCE LINE # 335
0034 120000      R     LCALL   L?0349
                                           ; SOURCE LINE # 336
0037 900000      E     MOV     DPTR,#PowSeqDelay
003A E0                MOVX    A,@DPTR
003B 7002              JNZ     ?C0321
003D A3                INC     DPTR
003E E0                MOVX    A,@DPTR
003F         ?C0321:
003F 60D2              JZ      ?C0038
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 338
0041 22                RET     
                                           ; SOURCE LINE # 339
                                           ; SOURCE LINE # 340
0042         ?C0040:
                                           ; SOURCE LINE # 342
                                           ; SOURCE LINE # 343
0042 120000      R     LCALL   L?0353
0045 120000      R     LCALL   L?0358
0048 EF                MOV     A,R7
0049 6003              JZ      ?C0037
                                           ; SOURCE LINE # 344
                                           ; SOURCE LINE # 345
                                           ; SOURCE LINE # 346
004B 120000      R     LCALL   L?0349
                                           ; SOURCE LINE # 347
                                           ; SOURCE LINE # 348
                                           ; SOURCE LINE # 349
                                           ; SOURCE LINE # 350
                                           ; SOURCE LINE # 351
004E         ?C0037:
004E 22                RET     
             ; FUNCTION Oem_S5DSXSequence (END)

             ; FUNCTION DSXS5_EC_ON_HI (BEGIN)
                                           ; SOURCE LINE # 355
                                           ; SOURCE LINE # 356
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 54  

                                           ; SOURCE LINE # 357
0000 900000      E     MOV     DPTR,#GPDRF
0003 E0                MOVX    A,@DPTR
0004 4401              ORL     A,#01H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 358
0007 22                RET     
             ; FUNCTION DSXS5_EC_ON_HI (END)

             ; FUNCTION DSXS5_PMIC_Init (BEGIN)
                                           ; SOURCE LINE # 360
                                           ; SOURCE LINE # 361
                                           ; SOURCE LINE # 362
0000 120000      R     LCALL   InitPMIC
                                           ; SOURCE LINE # 363
0003 900000      E     MOV     DPTR,#PowerInitOK
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
                                           ; SOURCE LINE # 365
0008         ?C0045:
0008 22                RET     
             ; FUNCTION DSXS5_PMIC_Init (END)

             ; FUNCTION DSXS5_PWR_BTN_HI (BEGIN)
                                           ; SOURCE LINE # 367
                                           ; SOURCE LINE # 368
                                           ; SOURCE LINE # 369
0000 120000      R     LCALL   L?0373
                                           ; SOURCE LINE # 370
0003 22                RET     
             ; FUNCTION DSXS5_PWR_BTN_HI (END)

             ; FUNCTION DSXS5_PCH_PWR_EN (BEGIN)
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 373
                                           ; SOURCE LINE # 374
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4410              ORL     A,#010H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 375
0007 22                RET     
             ; FUNCTION DSXS5_PCH_PWR_EN (END)

             ; FUNCTION DSXS5_RSMRST_HI (BEGIN)
                                           ; SOURCE LINE # 377
                                           ; SOURCE LINE # 378
                                           ; SOURCE LINE # 379
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4401              ORL     A,#01H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 380
0007 22                RET     
             ; FUNCTION DSXS5_RSMRST_HI (END)

             ; FUNCTION DSXS5_Init_Status (BEGIN)
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 383
                                           ; SOURCE LINE # 384
0000 900000      E     MOV     DPTR,#SYS_STATUS
0003 E0                MOVX    A,@DPTR
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 55  

0004 30E70E            JNB     ACC.7,?C0049
                                           ; SOURCE LINE # 385
                                           ; SOURCE LINE # 386
0007 900000      E     MOV     DPTR,#SysPowState
000A E0                MOVX    A,@DPTR
000B B41107            CJNE    A,#011H,?C0049
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 388
000E 900000      E     MOV     DPTR,#GPDRJ
0011 E0                MOVX    A,@DPTR
0012 4440              ORL     A,#040H
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 390
                                           ; SOURCE LINE # 391
0015         ?C0049:
                                           ; SOURCE LINE # 393
0015 900000      E     MOV     DPTR,#SysPowState
0018 7455              MOV     A,#055H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 394
001B 7F0B              MOV     R7,#0BH
001D 020000      E     LJMP    _RamDebug
             ; FUNCTION DSXS5_Init_Status (END)

             ; FUNCTION Oem_DSXS5Sequence (BEGIN)
                                           ; SOURCE LINE # 414
                                           ; SOURCE LINE # 415
                                           ; SOURCE LINE # 416
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0322
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0322:
0008 6009              JZ      ?C0055
                                           ; SOURCE LINE # 417
                                           ; SOURCE LINE # 418
                                           ; SOURCE LINE # 419
000A 120000      R     LCALL   L?0360
000D 7002              JNZ     ?C0323
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0323:
0011 705A              JNZ     ?C0054
                                           ; SOURCE LINE # 420
                                           ; SOURCE LINE # 422
                                           ; SOURCE LINE # 423
0013         ?C0055:
                                           ; SOURCE LINE # 425
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 9408              SUBB    A,#08H
001A 5051              JNC     ?C0054
                                           ; SOURCE LINE # 426
                                           ; SOURCE LINE # 427
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQDSXS5+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 56  

0026 3400        R     ADDC    A,#HIGH asPowerSEQDSXS5+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7022              JNZ     ?C0057
                                           ; SOURCE LINE # 428
                                           ; SOURCE LINE # 429
002E 120000      R     LCALL   L?0353
0031 2400        R     ADD     A,#LOW asPowerSEQDSXS5
0033 F582              MOV     DPL,A
0035 E4                CLR     A
0036 3400        R     ADDC    A,#HIGH asPowerSEQDSXS5
                                           ; SOURCE LINE # 430
0038 120000      R     LCALL   L?0351
003B 2400        R     ADD     A,#LOW asPowerSEQDSXS5+02H
003D F582              MOV     DPL,A
003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH asPowerSEQDSXS5+02H
                                           ; SOURCE LINE # 431
0042 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 432
0045 900000      E     MOV     DPTR,#PowSeqDelay
0048 E0                MOVX    A,@DPTR
0049 7002              JNZ     ?C0324
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D         ?C0324:
004D 60C4              JZ      ?C0055
                                           ; SOURCE LINE # 433
                                           ; SOURCE LINE # 434
004F 22                RET     
                                           ; SOURCE LINE # 435
                                           ; SOURCE LINE # 436
0050         ?C0057:
                                           ; SOURCE LINE # 438
                                           ; SOURCE LINE # 439
0050 120000      R     LCALL   L?0353
0053 2400        R     ADD     A,#LOW asPowerSEQDSXS5
0055 F582              MOV     DPL,A
0057 E4                CLR     A
0058 3400        R     ADDC    A,#HIGH asPowerSEQDSXS5
005A 120000      R     LCALL   L?0359
005D EF                MOV     A,R7
005E 600D              JZ      ?C0054
                                           ; SOURCE LINE # 440
                                           ; SOURCE LINE # 441
0060 120000      R     LCALL   L?0353
0063 2400        R     ADD     A,#LOW asPowerSEQDSXS5+02H
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        R     ADDC    A,#HIGH asPowerSEQDSXS5+02H
                                           ; SOURCE LINE # 442
006A 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 443
                                           ; SOURCE LINE # 444
                                           ; SOURCE LINE # 445
                                           ; SOURCE LINE # 446
                                           ; SOURCE LINE # 447
006D         ?C0054:
006D 22                RET     
             ; FUNCTION Oem_DSXS5Sequence (END)

C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 57  

             ; FUNCTION Oem_SysPowerContrl (BEGIN)
                                           ; SOURCE LINE # 454
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 460
0000 900000      E     MOV     DPTR,#SysPowState
0003 E0                MOVX    A,@DPTR
0004 120000      E     LCALL   ?C?CCASE
0007 0000        R     DW      ?C0096
0009 03                DB      03H
000A 0000        R     DW      ?C0105
000C 04                DB      04H
000D 0000        R     DW      ?C0098
000F 05                DB      05H
0010 0000        R     DW      ?C0093
0012 06                DB      06H
0013 0000        R     DW      ?C0062
0015 11                DB      011H
0016 0000        R     DW      ?C0095
0018 30                DB      030H
0019 0000        R     DW      ?C0074
001B 33                DB      033H
001C 0000        R     DW      ?C0078
001E 44                DB      044H
001F 0000        R     DW      ?C0094
0021 50                DB      050H
0022 0000        R     DW      ?C0078
0024 55                DB      055H
0025 0000        R     DW      ?C0092
0027 60                DB      060H
0028 0000        R     DW      ?C0089
002A 66                DB      066H
002B 0000        R     DW      ?C0105
002D FF                DB      0FFH
002E 0000              DW      00H
0030 0000        R     DW      ?C0100
                                           ; SOURCE LINE # 461
                                           ; SOURCE LINE # 462
0032         ?C0062:
                                           ; SOURCE LINE # 463
0032 900000      E     MOV     DPTR,#GPDRD
0035 E0                MOVX    A,@DPTR
0036 30E003            JNB     ACC.0,?C0064
0039 D3                SETB    C
003A 8001              SJMP    ?C0065
003C         ?C0064:
003C C3                CLR     C
003D         ?C0065:
003D 4043              JC      ?C0063
                                           ; SOURCE LINE # 464
                                           ; SOURCE LINE # 465
003F 900000      E     MOV     DPTR,#S3S4DelayCnt
0042 E0                MOVX    A,@DPTR
0043 D3                SETB    C
0044 940A              SUBB    A,#0AH
0046 4032              JC      ?C0066
                                           ; SOURCE LINE # 466
                                           ; SOURCE LINE # 467
                                           ; SOURCE LINE # 468
0048 120000      R     LCALL   L?0368
                                           ; SOURCE LINE # 469
004B 7FD0              MOV     R7,#0D0H
                                           ; SOURCE LINE # 470
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 58  

004D 120000      R     LCALL   L?0396
0050 7403              MOV     A,#03H
0052 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 472
0053 900000      E     MOV     DPTR,#GPDRD
0056 E0                MOVX    A,@DPTR
0057 30E103            JNB     ACC.1,?C0068
005A D3                SETB    C
005B 8001              SJMP    ?C0069
005D         ?C0068:
005D C3                CLR     C
005E         ?C0069:
005E 400D              JC      ?C0067
                                           ; SOURCE LINE # 473
                                           ; SOURCE LINE # 474
                                           ; SOURCE LINE # 475
0060 120000      R     LCALL   L?0368
                                           ; SOURCE LINE # 476
0063 7F0D              MOV     R7,#0DH
                                           ; SOURCE LINE # 477
0065 120000      R     LCALL   L?0396
0068 7405              MOV     A,#05H
006A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 478
006B 801A              SJMP    ?C0073
006D         ?C0067:
                                           ; SOURCE LINE # 479
006D 900000      E     MOV     DPTR,#SysStatus
0070 E0                MOVX    A,@DPTR
0071 30E513            JNB     ACC.5,?C0073
                                           ; SOURCE LINE # 480
                                           ; SOURCE LINE # 482
0074 E0                MOVX    A,@DPTR
0075 4440              ORL     A,#040H
0077 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 483
                                           ; SOURCE LINE # 484
0078 800D              SJMP    ?C0073
007A         ?C0066:
                                           ; SOURCE LINE # 486
                                           ; SOURCE LINE # 487
007A 900000      E     MOV     DPTR,#S3S4DelayCnt
007D E0                MOVX    A,@DPTR
007E 04                INC     A
007F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 488
                                           ; SOURCE LINE # 489
0080 8005              SJMP    ?C0073
0082         ?C0063:
                                           ; SOURCE LINE # 491
                                           ; SOURCE LINE # 492
0082 E4                CLR     A
0083 900000      E     MOV     DPTR,#S3S4DelayCnt
0086 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 493
0087         ?C0073:
                                           ; SOURCE LINE # 494
0087 020000      R     LJMP    Check_LPC_Reset
                                           ; SOURCE LINE # 495
                                           ; SOURCE LINE # 497
008A         ?C0074:
                                           ; SOURCE LINE # 501
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 59  

008A 900000      E     MOV     DPTR,#GPDRD
008D E0                MOVX    A,@DPTR
008E 30E013            JNB     ACC.0,?C0075
                                           ; SOURCE LINE # 502
                                           ; SOURCE LINE # 503
0091 7403              MOV     A,#03H
                                           ; SOURCE LINE # 504
0093 120000      R     LCALL   L?0404
0096 7414              MOV     A,#014H
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 505
0099 7F33              MOV     R7,#033H
009B 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 506
009E 900000      E     MOV     DPTR,#SysPowState
00A1 7430              MOV     A,#030H
00A3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 507
00A4         ?C0075:
                                           ; SOURCE LINE # 519
00A4 900000      E     MOV     DPTR,#SYS_STATUS
00A7 E0                MOVX    A,@DPTR
00A8 20E403            JB      ACC.4,$ + 6H
00AB 020000      R     LJMP    ?C0105
00AE 900000      E     MOV     DPTR,#GPDRB
00B1 E0                MOVX    A,@DPTR
00B2 20E003            JB      ACC.0,$ + 6H
00B5 020000      R     LJMP    ?C0105
                                           ; SOURCE LINE # 520
                                           ; SOURCE LINE # 521
                                           ; SOURCE LINE # 523
                                           ; SOURCE LINE # 524
                                           ; SOURCE LINE # 541
00B8 020000      R     LJMP    ?C0339
                                           ; SOURCE LINE # 543
                                           ; SOURCE LINE # 544
00BB         ?C0078:
                                           ; SOURCE LINE # 545
00BB 900000      E     MOV     DPTR,#GPDRD
00BE E0                MOVX    A,@DPTR
00BF 30E012            JNB     ACC.0,?C0079
00C2 E0                MOVX    A,@DPTR
00C3 30E10E            JNB     ACC.1,?C0079
                                           ; SOURCE LINE # 546
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
00C6 120000      R     LCALL   L?0369
                                           ; SOURCE LINE # 549
00C9 7F53              MOV     R7,#053H
00CB 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 550
00CE 900000      E     MOV     DPTR,#SysPowState
00D1 7450              MOV     A,#050H
00D3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 551
00D4         ?C0079:
                                           ; SOURCE LINE # 552
00D4 120000      R     LCALL   CheckAutoPowerOn
                                           ; SOURCE LINE # 557
00D7 120000      R     LCALL   L?0407
00DA 6007              JZ      ?C0081
00DC 900000      E     MOV     DPTR,#EMStatusBit2
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 60  

00DF E0                MOVX    A,@DPTR
00E0 30E003            JNB     ACC.0,?C0080
00E3         ?C0081:
                                           ; SOURCE LINE # 558
                                           ; SOURCE LINE # 559
                                           ; SOURCE LINE # 560
00E3 120000      R     LCALL   L?0401
                                           ; SOURCE LINE # 561
00E6         ?C0080:
                                           ; SOURCE LINE # 566
00E6 900000      E     MOV     DPTR,#PowerOTP_REG
00E9 E0                MOVX    A,@DPTR
00EA 6029              JZ      ?C0082
                                           ; SOURCE LINE # 567
                                           ; SOURCE LINE # 568
00EC 900000      E     MOV     DPTR,#SysStatus
00EF E0                MOVX    A,@DPTR
00F0 20E105            JB      ACC.1,?C0083
                                           ; SOURCE LINE # 569
                                           ; SOURCE LINE # 570
00F3 7F36              MOV     R7,#036H
00F5 120000      E     LCALL   _ProcessSID
00F8         ?C0083:
                                           ; SOURCE LINE # 571
00F8 900000      E     MOV     DPTR,#PowerOTP_REG
00FB E0                MOVX    A,@DPTR
00FC 900000      E     MOV     DPTR,#OTP_TEMP
00FF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 572
0100 E4                CLR     A
0101 900000      E     MOV     DPTR,#PowerOTP_REG
0104 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 573
0105 120000      R     LCALL   L?0384
                                           ; SOURCE LINE # 574
0108 7F0C              MOV     R7,#0CH
010A 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 575
010D 120000      R     LCALL   L?0399
                                           ; SOURCE LINE # 576
0110 E4                CLR     A
0111 900000      E     MOV     DPTR,#PowerInitOK
0114 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 578
0115         ?C0082:
                                           ; SOURCE LINE # 580
0115 900000      E     MOV     DPTR,#ACPI_HOTKEY
0118 E0                MOVX    A,@DPTR
0119 20E72C            JB      ACC.7,?C0084
011C E0                MOVX    A,@DPTR
011D 20E628            JB      ACC.6,?C0084
0120 900000      E     MOV     DPTR,#LOWBATT_3TIMES
0123 E0                MOVX    A,@DPTR
0124 7022              JNZ     ?C0084
                                           ; SOURCE LINE # 581
                                           ; SOURCE LINE # 582
0126 900000      E     MOV     DPTR,#GPDRB
0129 E0                MOVX    A,@DPTR
012A 30E003            JNB     ACC.0,?C0086
012D D3                SETB    C
012E 8001              SJMP    ?C0087
0130         ?C0086:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 61  

0130 C3                CLR     C
0131         ?C0087:
0131 4015              JC      ?C0084
0133 900000      E     MOV     DPTR,#cCmd
0136 E0                MOVX    A,@DPTR
0137 20E20E            JB      ACC.2,?C0084
                                           ; SOURCE LINE # 583
                                           ; SOURCE LINE # 585
013A 7401              MOV     A,#01H
                                           ; SOURCE LINE # 586
013C 120000      R     LCALL   L?0404
013F 7440              MOV     A,#040H
0141 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 587
0142 900000      E     MOV     DPTR,#SysPowState
0145 7406              MOV     A,#06H
0147 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 588
                                           ; SOURCE LINE # 589
0148         ?C0084:
                                           ; SOURCE LINE # 599
0148 900000      E     MOV     DPTR,#SYS_STATUS
014B E0                MOVX    A,@DPTR
014C 30E465            JNB     ACC.4,?C0105
014F 900000      E     MOV     DPTR,#GPDRB
0152 E0                MOVX    A,@DPTR
0153 30E05E            JNB     ACC.0,?C0105
                                           ; SOURCE LINE # 600
                                           ; SOURCE LINE # 601
0156         ?C0339:
0156 900000      E     MOV     DPTR,#SYS_STATUS
0159 E0                MOVX    A,@DPTR
015A 4480              ORL     A,#080H
015C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 603
015D 020000      E     LJMP    BATT_LEN_OFF
                                           ; SOURCE LINE # 604
                                           ; SOURCE LINE # 606
                                           ; SOURCE LINE # 608
0160         ?C0089:
                                           ; SOURCE LINE # 609
0160 120000      R     LCALL   CheckAutoPowerOn
                                           ; SOURCE LINE # 610
0163 900000      E     MOV     DPTR,#GPDRB
0166 E0                MOVX    A,@DPTR
0167 20E006            JB      ACC.0,?C0091
016A 900000      E     MOV     DPTR,#LOWBATT_3TIMES
016D E0                MOVX    A,@DPTR
016E 6044              JZ      ?C0105
0170         ?C0091:
                                           ; SOURCE LINE # 611
                                           ; SOURCE LINE # 612
0170 900000      E     MOV     DPTR,#PWSeqStep
0173 7401              MOV     A,#01H
                                           ; SOURCE LINE # 613
                                           ; SOURCE LINE # 614
                                           ; SOURCE LINE # 616
                                           ; SOURCE LINE # 617
0175 8034              SJMP    ?C0340
                                           ; SOURCE LINE # 618
0177         ?C0092:
                                           ; SOURCE LINE # 619
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 62  

0177 020000      R     LJMP    Oem_DSXS5Sequence
                                           ; SOURCE LINE # 620
                                           ; SOURCE LINE # 621
017A         ?C0093:
                                           ; SOURCE LINE # 622
017A 020000      R     LJMP    Oem_S5DSXSequence
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 625
017D         ?C0094:
                                           ; SOURCE LINE # 626
017D 020000      R     LJMP    Oem_S5S0Sequence
                                           ; SOURCE LINE # 627
                                           ; SOURCE LINE # 629
0180         ?C0095:
                                           ; SOURCE LINE # 630
0180 020000      R     LJMP    Oem_S3S0Sequence
                                           ; SOURCE LINE # 631
                                           ; SOURCE LINE # 633
0183         ?C0096:
                                           ; SOURCE LINE # 634
0183 020000      R     LJMP    Oem_S0S3Sequence
                                           ; SOURCE LINE # 643
                                           ; SOURCE LINE # 645
                                           ; SOURCE LINE # 646
                                           ; SOURCE LINE # 648
0186         ?C0098:
                                           ; SOURCE LINE # 649
0186 020000      R     LJMP    Oem_S0S5Sequence
                                           ; SOURCE LINE # 650
                                           ; SOURCE LINE # 652
                                           ; SOURCE LINE # 653
                                           ; SOURCE LINE # 655
0189         ?C0100:
                                           ; SOURCE LINE # 656
0189 900000      E     MOV     DPTR,#SysPowState
018C 7466              MOV     A,#066H
018E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 657
018F 900000      E     MOV     DPTR,#GPDRB
0192 E0                MOVX    A,@DPTR
0193 30E003            JNB     ACC.0,?C0102
0196 D3                SETB    C
0197 8001              SJMP    ?C0103
0199         ?C0102:
0199 C3                CLR     C
019A         ?C0103:
019A 900000      E     MOV     DPTR,#PWSeqStep
019D 7401              MOV     A,#01H
019F 400A              JC      ?C0101
                                           ; SOURCE LINE # 658
                                           ; SOURCE LINE # 659
                                           ; SOURCE LINE # 660
01A1 120000      R     LCALL   L?0370
                                           ; SOURCE LINE # 661
01A4 900000      E     MOV     DPTR,#SysPowState
01A7 7406              MOV     A,#06H
01A9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 662
01AA 22                RET     
01AB         ?C0101:
                                           ; SOURCE LINE # 664
                                           ; SOURCE LINE # 665
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 63  

01AB         ?C0340:
                                           ; SOURCE LINE # 666
01AB 120000      R     LCALL   L?0370
                                           ; SOURCE LINE # 667
01AE 900000      E     MOV     DPTR,#SysPowState
01B1 7460              MOV     A,#060H
01B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 668
                                           ; SOURCE LINE # 669
                                           ; SOURCE LINE # 670
                                           ; SOURCE LINE # 671
01B4         ?C0105:
01B4 22                RET     
01B5         L?0396:
01B5 120000      E     LCALL   _RamDebug
01B8 900000      E     MOV     DPTR,#SysPowState
01BB 22                RET     
             ; FUNCTION Oem_SysPowerContrl (END)

             ; FUNCTION SetS3GPIO (BEGIN)
                                           ; SOURCE LINE # 673
                                           ; SOURCE LINE # 674
                                           ; SOURCE LINE # 682
0000 22                RET     
             ; FUNCTION SetS3GPIO (END)

             ; FUNCTION SetS0GPIO (BEGIN)
                                           ; SOURCE LINE # 684
                                           ; SOURCE LINE # 685
                                           ; SOURCE LINE # 686
0000 900000      E     MOV     DPTR,#GPDRD
0003 E0                MOVX    A,@DPTR
0004 4408              ORL     A,#08H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 689
0007 900000      E     MOV     DPTR,#GPDRB
000A E0                MOVX    A,@DPTR
000B 4440              ORL     A,#040H
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 700
000E E4                CLR     A
000F 900000      E     MOV     DPTR,#GPCRH1
                                           ; SOURCE LINE # 701
                                           ; SOURCE LINE # 704
0012 120000      R     LCALL   L?0408
                                           ; SOURCE LINE # 705
0015 900000      E     MOV     DPTR,#GPCRA4
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 713
0019 900000      E     MOV     DPTR,#GPCRD6
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 715
001D 120000      E     LCALL   InitSio
                                           ; SOURCE LINE # 717
0020 E4                CLR     A
0021 900000      E     MOV     DPTR,#KBHISR
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 718
0025 900000      E     MOV     DPTR,#KBHIKDOR
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 719
0029 900000      E     MOV     DPTR,#KBHISR
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 64  

002C E0                MOVX    A,@DPTR
002D 54FB              ANL     A,#0FBH
002F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 721
0030 900000      E     MOV     DPTR,#SPCTRL1
0033 7483              MOV     A,#083H
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 722
0036 9022BE            MOV     DPTR,#022BEH
0039 E4                CLR     A
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 723
003B A3                INC     DPTR
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 725
003D 900000      E     MOV     DPTR,#PECIDelayCnt
0040 7404              MOV     A,#04H
0042 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 727
0043 120000      E     LCALL   Fan_Init
                                           ; SOURCE LINE # 739
0046 900000      E     MOV     DPTR,#SYS_MISC1
0049 E0                MOVX    A,@DPTR
004A 900000      E     MOV     DPTR,#GPDRE
004D 30E105            JNB     ACC.1,?C0107
                                           ; SOURCE LINE # 740
0050 E0                MOVX    A,@DPTR
0051 547F              ANL     A,#07FH
0053 F0                MOVX    @DPTR,A
0054 22                RET     
0055         ?C0107:
                                           ; SOURCE LINE # 742
0055 E0                MOVX    A,@DPTR
0056 4480              ORL     A,#080H
0058 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 743
0059         ?C0109:
0059 22                RET     
             ; FUNCTION SetS0GPIO (END)

             ; FUNCTION SetS5GPIO (BEGIN)
                                           ; SOURCE LINE # 745
                                           ; SOURCE LINE # 746
                                           ; SOURCE LINE # 747
0000 900000      E     MOV     DPTR,#GPDRD
0003 E0                MOVX    A,@DPTR
0004 54F7              ANL     A,#0F7H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 750
0007 900000      E     MOV     DPTR,#GPDRB
000A E0                MOVX    A,@DPTR
000B 54BF              ANL     A,#0BFH
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 754
000E 900000      E     MOV     DPTR,#GPCRH1
0011 7482              MOV     A,#082H
                                           ; SOURCE LINE # 755
                                           ; SOURCE LINE # 756
0013 120000      R     LCALL   L?0408
                                           ; SOURCE LINE # 757
0016 900000      E     MOV     DPTR,#GPCRD6
0019 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 65  

                                           ; SOURCE LINE # 763
001A 900000      E     MOV     DPTR,#GPDRH
001D E0                MOVX    A,@DPTR
001E 4408              ORL     A,#08H
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 764
0021 900000      E     MOV     DPTR,#GPDRE
0024 E0                MOVX    A,@DPTR
0025 4480              ORL     A,#080H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 769
0028 900000      E     MOV     DPTR,#SysPowState
002B E0                MOVX    A,@DPTR
002C B40508            CJNE    A,#05H,?C0110
                                           ; SOURCE LINE # 770
                                           ; SOURCE LINE # 771
002F 900000      E     MOV     DPTR,#GPCRD5
0032 7480              MOV     A,#080H
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 775
0035 8007              SJMP    ?C0111
0037         ?C0110:
                                           ; SOURCE LINE # 777
                                           ; SOURCE LINE # 778
0037 900000      E     MOV     DPTR,#SYS_STATUS
003A E0                MOVX    A,@DPTR
                                           ; SOURCE LINE # 779
                                           ; SOURCE LINE # 781
                                           ; SOURCE LINE # 783
                                           ; SOURCE LINE # 785
003B         ?C0113:
                                           ; SOURCE LINE # 794
                                           ; SOURCE LINE # 795
                                           ; SOURCE LINE # 796
003B 120000      R     LCALL   L?0377
                                           ; SOURCE LINE # 797
                                           ; SOURCE LINE # 798
003E         ?C0111:
                                           ; SOURCE LINE # 799
003E 900000      E     MOV     DPTR,#GPCRB0
0041 7480              MOV     A,#080H
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 811
0044 900000      E     MOV     DPTR,#SYS_MISC1
0047 E0                MOVX    A,@DPTR
0048 54DF              ANL     A,#0DFH
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 812
004B 22                RET     
             ; FUNCTION SetS5GPIO (END)

             ; FUNCTION S5S0_STEP1 (BEGIN)
                                           ; SOURCE LINE # 815
                                           ; SOURCE LINE # 816
                                           ; SOURCE LINE # 817
0000 900000      E     MOV     DPTR,#cCmd
0003 E0                MOVX    A,@DPTR
0004 54FB              ANL     A,#0FBH
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 818
0007 E4                CLR     A
0008 900000      E     MOV     DPTR,#AutoTimer
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 66  

000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 819
000C 900000      E     MOV     DPTR,#SysStatus2
000F E0                MOVX    A,@DPTR
0010 30E304            JNB     ACC.3,?C0115
                                           ; SOURCE LINE # 820
                                           ; SOURCE LINE # 821
0013 E0                MOVX    A,@DPTR
0014 54F7              ANL     A,#0F7H
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 822
0017         ?C0115:
                                           ; SOURCE LINE # 824
0017 900000      E     MOV     DPTR,#GPDRF
001A E0                MOVX    A,@DPTR
001B 4401              ORL     A,#01H
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 825
001E E0                MOVX    A,@DPTR
001F 4402              ORL     A,#02H
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 826
0022 7F80              MOV     R7,#080H
0024 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 827
0027 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 828
0029         ?C0116:
0029 22                RET     
             ; FUNCTION S5S0_STEP1 (END)

             ; FUNCTION S5S0_PMIC_Initial (BEGIN)
                                           ; SOURCE LINE # 831
                                           ; SOURCE LINE # 832
                                           ; SOURCE LINE # 833
0000 120000      R     LCALL   InitPMIC
                                           ; SOURCE LINE # 834
0003 7F81              MOV     R7,#081H
0005 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 835
0008 900000      E     MOV     DPTR,#PowerInitOK
000B E0                MOVX    A,@DPTR
000C 7002              JNZ     ?C0117
                                           ; SOURCE LINE # 836
000E FF                MOV     R7,A
000F 22                RET     
0010         ?C0117:
                                           ; SOURCE LINE # 838
0010 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 839
0012         ?C0118:
0012 22                RET     
             ; FUNCTION S5S0_PMIC_Initial (END)

             ; FUNCTION S5S0_AC_PRESENT_EN (BEGIN)
                                           ; SOURCE LINE # 843
                                           ; SOURCE LINE # 844
                                           ; SOURCE LINE # 845
0000 7BE0              MOV     R3,#0E0H
0002 7DB7              MOV     R5,#0B7H
0004 7F01              MOV     R7,#01H
0006 120000      E     LCALL   _Read_Eflash_Byte
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 67  

0009 900000      E     MOV     DPTR,#uPGID
000C EF                MOV     A,R7
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 846
000E E0                MOVX    A,@DPTR
000F 900000      E     MOV     DPTR,#MBID_FB
                                           ; SOURCE LINE # 847
0012 120000      R     LCALL   L?0372
                                           ; SOURCE LINE # 848
0015 900000      E     MOV     DPTR,#SYS_STATUS
0018 E0                MOVX    A,@DPTR
0019 30E707            JNB     ACC.7,?C0120
                                           ; SOURCE LINE # 849
                                           ; SOURCE LINE # 850
001C 900000      E     MOV     DPTR,#GPDRJ
001F E0                MOVX    A,@DPTR
0020 4440              ORL     A,#040H
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 851
0023         ?C0120:
                                           ; SOURCE LINE # 853
0023 7F82              MOV     R7,#082H
0025 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_AC_PRESENT_EN (END)

             ; FUNCTION S5S0_PCH_PWR_EN (BEGIN)
                                           ; SOURCE LINE # 856
                                           ; SOURCE LINE # 857
                                           ; SOURCE LINE # 858
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4410              ORL     A,#010H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 860
0007 7F83              MOV     R7,#083H
0009 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_PCH_PWR_EN (END)

             ; FUNCTION S5S0_RSMRST_EN (BEGIN)
                                           ; SOURCE LINE # 863
                                           ; SOURCE LINE # 864
                                           ; SOURCE LINE # 865
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4401              ORL     A,#01H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 866
0007 7F84              MOV     R7,#084H
0009 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_RSMRST_EN (END)

             ; FUNCTION S5S0_PM_PWER_BTN2 (BEGIN)
                                           ; SOURCE LINE # 869
                                           ; SOURCE LINE # 870
                                           ; SOURCE LINE # 871
0000 120000      R     LCALL   L?0386
                                           ; SOURCE LINE # 872
0003 900000      E     MOV     DPTR,#CMOS_TEST
0006 E0                MOVX    A,@DPTR
0007 4404              ORL     A,#04H
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 873
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 68  

000A 7F85              MOV     R7,#085H
000C 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_PM_PWER_BTN2 (END)

             ; FUNCTION S5S0_PM_PWER_BTN3 (BEGIN)
                                           ; SOURCE LINE # 876
                                           ; SOURCE LINE # 877
                                           ; SOURCE LINE # 878
0000 120000      R     LCALL   L?0373
                                           ; SOURCE LINE # 879
0003 7F86              MOV     R7,#086H
0005 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_PM_PWER_BTN3 (END)

             ; FUNCTION S5S0_CHK_S4 (BEGIN)
                                           ; SOURCE LINE # 882
                                           ; SOURCE LINE # 883
                                           ; SOURCE LINE # 884
0000 900000      E     MOV     DPTR,#GPDRD
0003 E0                MOVX    A,@DPTR
0004 900000      E     MOV     DPTR,#GPDRF
0007 30E10F            JNB     ACC.1,?C0126
                                           ; SOURCE LINE # 885
                                           ; SOURCE LINE # 886
000A E0                MOVX    A,@DPTR
000B 4402              ORL     A,#02H
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 888
000E 120000      R     LCALL   L?0402
                                           ; SOURCE LINE # 889
0011 7F87              MOV     R7,#087H
0013 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 890
0016 7F01              MOV     R7,#01H
0018 22                RET     
                                           ; SOURCE LINE # 891
0019         ?C0126:
                                           ; SOURCE LINE # 893
0019 E0                MOVX    A,@DPTR
001A 54FD              ANL     A,#0FDH
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 895
001D 7F88              MOV     R7,#088H
001F 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 896
0022 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 897
0024         ?C0127:
0024 22                RET     
             ; FUNCTION S5S0_CHK_S4 (END)

             ; FUNCTION S5S0_CHK_S3 (BEGIN)
                                           ; SOURCE LINE # 899
                                           ; SOURCE LINE # 900
                                           ; SOURCE LINE # 901
0000 900000      E     MOV     DPTR,#GPDRD
0003 E0                MOVX    A,@DPTR
0004 30E008            JNB     ACC.0,?C0128
                                           ; SOURCE LINE # 902
                                           ; SOURCE LINE # 908
0007 7F89              MOV     R7,#089H
0009 120000      E     LCALL   _RamDebug
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 69  

                                           ; SOURCE LINE # 909
000C 7F01              MOV     R7,#01H
000E 22                RET     
                                           ; SOURCE LINE # 910
000F         ?C0128:
                                           ; SOURCE LINE # 911
000F 7F8A              MOV     R7,#08AH
0011 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 913
0014 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 914
0016         ?C0129:
0016 22                RET     
             ; FUNCTION S5S0_CHK_S3 (END)

             ; FUNCTION S5S0_EC_VCCST_EN (BEGIN)
                                           ; SOURCE LINE # 916
                                           ; SOURCE LINE # 917
                                           ; SOURCE LINE # 918
0000 120000      R     LCALL   L?0402
                                           ; SOURCE LINE # 920
0003 7F8B              MOV     R7,#08BH
0005 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_EC_VCCST_EN (END)

             ; FUNCTION S5S0_EC_VPP_PWREN (BEGIN)
                                           ; SOURCE LINE # 924
                                           ; SOURCE LINE # 925
                                           ; SOURCE LINE # 926
0000 900000      E     MOV     DPTR,#GPDRE
0003 E0                MOVX    A,@DPTR
0004 4408              ORL     A,#08H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 928
0007 7F8C              MOV     R7,#08CH
0009 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_EC_VPP_PWREN (END)

             ; FUNCTION S5S0_SYSON (BEGIN)
                                           ; SOURCE LINE # 933
                                           ; SOURCE LINE # 934
                                           ; SOURCE LINE # 935
0000 900000      E     MOV     DPTR,#GPDRG
0003 E0                MOVX    A,@DPTR
0004 4402              ORL     A,#02H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 936
0007 7F8D              MOV     R7,#08DH
0009 020000      E     LJMP    _RamDebug
             ; FUNCTION S5S0_SYSON (END)

             ; FUNCTION S5S0_GPO7 (BEGIN)
                                           ; SOURCE LINE # 939
                                           ; SOURCE LINE # 940
                                           ; SOURCE LINE # 942
0000 22                RET     
             ; FUNCTION S5S0_GPO7 (END)

             ; FUNCTION S5S0_SUSP (BEGIN)
                                           ; SOURCE LINE # 943
                                           ; SOURCE LINE # 944
                                           ; SOURCE LINE # 945
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 70  

0000 900000      E     MOV     DPTR,#GPDRC
0003 E0                MOVX    A,@DPTR
0004 4440              ORL     A,#040H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 947
0007 900000      E     MOV     DPTR,#CURRENT_STATUS
000A E0                MOVX    A,@DPTR
000B 54C0              ANL     A,#0C0H
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 949
000E 020000      R     LJMP    SetS0GPIO
             ; FUNCTION S5S0_SUSP (END)

             ; FUNCTION S5S0_EC_VCCIO_EN (BEGIN)
                                           ; SOURCE LINE # 952
                                           ; SOURCE LINE # 953
                                           ; SOURCE LINE # 954
0000 900000      E     MOV     DPTR,#GPDRB
0003 E0                MOVX    A,@DPTR
0004 4404              ORL     A,#04H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 955
0007 22                RET     
             ; FUNCTION S5S0_EC_VCCIO_EN (END)

             ; FUNCTION S5S0_NVDD_PWR (BEGIN)
                                           ; SOURCE LINE # 957
                                           ; SOURCE LINE # 958
                                           ; SOURCE LINE # 963
0000 22                RET     
             ; FUNCTION S5S0_NVDD_PWR (END)

             ; FUNCTION S5S0_USBON (BEGIN)
                                           ; SOURCE LINE # 965
                                           ; SOURCE LINE # 966
                                           ; SOURCE LINE # 967
                                           ; SOURCE LINE # 968
0000 120000      R     LCALL   L?0377
                                           ; SOURCE LINE # 992
0003 900000      E     MOV     DPTR,#EMStatusBit
0006 E0                MOVX    A,@DPTR
0007 4480              ORL     A,#080H
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 993
000A 22                RET     
             ; FUNCTION S5S0_USBON (END)

             ; FUNCTION S5S0_VCCST_PWRGD (BEGIN)
                                           ; SOURCE LINE # 995
                                           ; SOURCE LINE # 996
                                           ; SOURCE LINE # 998
0000 22                RET     
             ; FUNCTION S5S0_VCCST_PWRGD (END)

             ; FUNCTION S5S0_CHK_VDDQ_PWRGOOD (BEGIN)
                                           ; SOURCE LINE # 1002
                                           ; SOURCE LINE # 1003
                                           ; SOURCE LINE # 1004
0000 900000      R     MOV     DPTR,#BPwrDate
0003 7403              MOV     A,#03H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1006
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 71  

0006 900000      E     MOV     DPTR,#GPDRE
0009 E0                MOVX    A,@DPTR
000A 30E208            JNB     ACC.2,?C0139
                                           ; SOURCE LINE # 1007
                                           ; SOURCE LINE # 1010
000D 7F8E              MOV     R7,#08EH
000F 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1012
0012 7F01              MOV     R7,#01H
0014 22                RET     
                                           ; SOURCE LINE # 1013
0015         ?C0139:
                                           ; SOURCE LINE # 1014
0015 7F8F              MOV     R7,#08FH
0017 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1015
001A 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 1016
001C         ?C0140:
001C 22                RET     
             ; FUNCTION S5S0_CHK_VDDQ_PWRGOOD (END)

             ; FUNCTION S5S0_VR_ON (BEGIN)
                                           ; SOURCE LINE # 1032
                                           ; SOURCE LINE # 1033
                                           ; SOURCE LINE # 1034
0000 120000      E     LCALL   Clr_UEFIStatus
                                           ; SOURCE LINE # 1035
0003 900000      E     MOV     DPTR,#GPDRI
0006 E0                MOVX    A,@DPTR
0007 4410              ORL     A,#010H
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1044
000A 900000      E     MOV     DPTR,#SYS_STATUS
000D E0                MOVX    A,@DPTR
000E 30E706            JNB     ACC.7,?C0141
                                           ; SOURCE LINE # 1045
                                           ; SOURCE LINE # 1047
                                           ; SOURCE LINE # 1048
0011 120000      R     LCALL   L?0409
0014 74A0              MOV     A,#0A0H
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1049
0017         ?C0141:
                                           ; SOURCE LINE # 1051
0017 900000      E     MOV     DPTR,#MuteCount
001A 7404              MOV     A,#04H
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1052
001D 22                RET     
             ; FUNCTION S5S0_VR_ON (END)

             ; FUNCTION S5S0_CHK_VRREADY (BEGIN)
                                           ; SOURCE LINE # 1054
                                           ; SOURCE LINE # 1055
                                           ; SOURCE LINE # 1056
0000 900000      E     MOV     DPTR,#GPDRJ
0003 E0                MOVX    A,@DPTR
0004 30E303            JNB     ACC.3,?C0143
                                           ; SOURCE LINE # 1057
                                           ; SOURCE LINE # 1058
0007 7F01              MOV     R7,#01H
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 72  

0009 22                RET     
                                           ; SOURCE LINE # 1059
000A         ?C0143:
                                           ; SOURCE LINE # 1060
000A 7F00              MOV     R7,#00H
                                           ; SOURCE LINE # 1061
000C         ?C0144:
000C 22                RET     
             ; FUNCTION S5S0_CHK_VRREADY (END)

             ; FUNCTION S5S0_PCH_PWROK (BEGIN)
                                           ; SOURCE LINE # 1063
                                           ; SOURCE LINE # 1064
                                           ; SOURCE LINE # 1065
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4440              ORL     A,#040H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1066
0007 900000      E     MOV     DPTR,#PwrOnDly5Sec
000A 7405              MOV     A,#05H
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1067
000D 22                RET     
             ; FUNCTION S5S0_PCH_PWROK (END)

             ; FUNCTION S5S0_SYS_PWROK (BEGIN)
                                           ; SOURCE LINE # 1069
                                           ; SOURCE LINE # 1070
                                           ; SOURCE LINE # 1071
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4420              ORL     A,#020H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1072
0007 22                RET     
             ; FUNCTION S5S0_SYS_PWROK (END)

             ; FUNCTION LPC_RST (BEGIN)
                                           ; SOURCE LINE # 1074
                                           ; SOURCE LINE # 1075
                                           ; SOURCE LINE # 1080
0000 22                RET     
             ; FUNCTION LPC_RST (END)

             ; FUNCTION S5S0_Init_Status (BEGIN)
                                           ; SOURCE LINE # 1083
                                           ; SOURCE LINE # 1084
                                           ; SOURCE LINE # 1085
                                           ; SOURCE LINE # 1086
0000 120000      R     LCALL   L?0401
                                           ; SOURCE LINE # 1087
0003 E4                CLR     A
0004 900000      E     MOV     DPTR,#ShipModeEn
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1088
                                           ; SOURCE LINE # 1089
0008 120000      R     LCALL   L?0394
                                           ; SOURCE LINE # 1090
000B 900000      E     MOV     DPTR,#nBrightValue
000E 7411              MOV     A,#011H
0010 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 73  

                                           ; SOURCE LINE # 1091
0011 900000      E     MOV     DPTR,#nSKINTemp90
0014 7420              MOV     A,#020H
0016 F0                MOVX    @DPTR,A
0017 900000      E     MOV     DPTR,#EXTVGA_TEMP
001A F0                MOVX    @DPTR,A
001B 900000      E     MOV     DPTR,#VGA_TEMP
001E F0                MOVX    @DPTR,A
001F 900000      E     MOV     DPTR,#nCpuTemp
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1092
0023 900000      E     MOV     DPTR,#ThermistorCPU_TEMP
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1094
0027 900000      E     MOV     DPTR,#SEL_STATE0
002A E0                MOVX    A,@DPTR
002B 30E02D            JNB     ACC.0,?C0148
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1096
                                           ; SOURCE LINE # 1097
002E 120000      R     LCALL   L?0371
0031 7D0C              MOV     R5,#0CH
0033 FF                MOV     R7,A
0034 120000      E     LCALL   _bRWSMBus
0037 EF                MOV     A,R7
0038 6021              JZ      ?C0148
                                           ; SOURCE LINE # 1098
                                           ; SOURCE LINE # 1099
003A 900000      E     MOV     DPTR,#batteryFirstUsedDateL
003D E0                MOVX    A,@DPTR
003E 7006              JNZ     ?C0151
0040 900000      E     MOV     DPTR,#batteryFirstUsedDateH
0043 E0                MOVX    A,@DPTR
0044 6009              JZ      ?C0150
0046         ?C0151:
                                           ; SOURCE LINE # 1100
0046 900000      E     MOV     DPTR,#pProject0
0049 E0                MOVX    A,@DPTR
004A 54F7              ANL     A,#0F7H
004C F0                MOVX    @DPTR,A
004D 8007              SJMP    ?C0152
004F         ?C0150:
                                           ; SOURCE LINE # 1102
004F 900000      E     MOV     DPTR,#pProject0
0052 E0                MOVX    A,@DPTR
0053 4408              ORL     A,#08H
0055 F0                MOVX    @DPTR,A
0056         ?C0152:
                                           ; SOURCE LINE # 1103
0056 7FAE              MOV     R7,#0AEH
0058 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1104
                                           ; SOURCE LINE # 1105
005B         ?C0148:
                                           ; SOURCE LINE # 1107
005B 120000      E     LCALL   InitThermalTable1
                                           ; SOURCE LINE # 1108
005E 120000      E     LCALL   InitThermalTable2
                                           ; SOURCE LINE # 1110
0061 900000      E     MOV     DPTR,#LED_KB_PWM_Count
0064 740A              MOV     A,#0AH
0066 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 74  

                                           ; SOURCE LINE # 1111
0067 900000      E     MOV     DPTR,#ACPI_HOTKEY
006A E0                MOVX    A,@DPTR
006B 541F              ANL     A,#01FH
006D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1112
006E 900000      E     MOV     DPTR,#SYS_STATUS
0071 E0                MOVX    A,@DPTR
0072 54F8              ANL     A,#0F8H
                                           ; SOURCE LINE # 1114
                                           ; SOURCE LINE # 1115
0074 120000      R     LCALL   L?0374
                                           ; SOURCE LINE # 1116
0077 900000      E     MOV     DPTR,#BackLight_En_Delay
007A 7410              MOV     A,#010H
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1117
007D 7405              MOV     A,#05H
                                           ; SOURCE LINE # 1119
007F 120000      R     LCALL   L?0390
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1123
0083 900000      E     MOV     DPTR,#GPDRB
0086 E0                MOVX    A,@DPTR
0087 900000      E     MOV     DPTR,#SWI_EVENT
008A 30E106            JNB     ACC.1,?C0153
                                           ; SOURCE LINE # 1124
008D E0                MOVX    A,@DPTR
008E 4402              ORL     A,#02H
0090 F0                MOVX    @DPTR,A
0091 8004              SJMP    ?C0154
0093         ?C0153:
                                           ; SOURCE LINE # 1126
0093 E0                MOVX    A,@DPTR
0094 54FD              ANL     A,#0FDH
0096 F0                MOVX    @DPTR,A
0097         ?C0154:
                                           ; SOURCE LINE # 1127
                                           ; SOURCE LINE # 1130
0097 900000      E     MOV     DPTR,#GPDRJ
009A E0                MOVX    A,@DPTR
009B 4404              ORL     A,#04H
009D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1131
                                           ; SOURCE LINE # 1135
009E 900000      E     MOV     DPTR,#uReserve07
00A1 E0                MOVX    A,@DPTR
00A2 4401              ORL     A,#01H
00A4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1137
00A5 120000      R     LCALL   Lowpower_DISfunction
                                           ; SOURCE LINE # 1139
00A8 900000      E     MOV     DPTR,#CPUThrottlingDelayTime
00AB 743C              MOV     A,#03CH
00AD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1140
00AE 900000      E     MOV     DPTR,#SysPowState
00B1 7411              MOV     A,#011H
00B3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1142
00B4 22                RET     
             ; FUNCTION S5S0_Init_Status (END)
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 75  


             ; FUNCTION Oem_S5S0Sequence (BEGIN)
                                           ; SOURCE LINE # 1207
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1209
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0325
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0325:
0008 6009              JZ      ?C0159
                                           ; SOURCE LINE # 1210
                                           ; SOURCE LINE # 1211
                                           ; SOURCE LINE # 1212
000A 120000      R     LCALL   L?0361
000D 7002              JNZ     ?C0326
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0326:
0011 705A              JNZ     ?C0158
                                           ; SOURCE LINE # 1213
0013         ?C0159:
                                           ; SOURCE LINE # 1215
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 9418              SUBB    A,#018H
001A 5051              JNC     ?C0158
                                           ; SOURCE LINE # 1216
                                           ; SOURCE LINE # 1217
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQS5S0+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH asPowerSEQS5S0+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7022              JNZ     ?C0161
                                           ; SOURCE LINE # 1218
                                           ; SOURCE LINE # 1219
002E 120000      R     LCALL   L?0353
0031 2400        R     ADD     A,#LOW asPowerSEQS5S0
0033 F582              MOV     DPL,A
0035 E4                CLR     A
0036 3400        R     ADDC    A,#HIGH asPowerSEQS5S0
                                           ; SOURCE LINE # 1220
0038 120000      R     LCALL   L?0351
003B 2400        R     ADD     A,#LOW asPowerSEQS5S0+02H
003D F582              MOV     DPL,A
003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH asPowerSEQS5S0+02H
                                           ; SOURCE LINE # 1221
0042 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1222
0045 900000      E     MOV     DPTR,#PowSeqDelay
0048 E0                MOVX    A,@DPTR
0049 7002              JNZ     ?C0327
004B A3                INC     DPTR
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 76  

004C E0                MOVX    A,@DPTR
004D         ?C0327:
004D 60C4              JZ      ?C0159
                                           ; SOURCE LINE # 1223
                                           ; SOURCE LINE # 1224
004F 22                RET     
                                           ; SOURCE LINE # 1225
                                           ; SOURCE LINE # 1226
0050         ?C0161:
                                           ; SOURCE LINE # 1228
                                           ; SOURCE LINE # 1229
0050 120000      R     LCALL   L?0353
0053 2400        R     ADD     A,#LOW asPowerSEQS5S0
0055 F582              MOV     DPL,A
0057 E4                CLR     A
0058 3400        R     ADDC    A,#HIGH asPowerSEQS5S0
005A 120000      R     LCALL   L?0359
005D EF                MOV     A,R7
005E 600D              JZ      ?C0158
                                           ; SOURCE LINE # 1230
                                           ; SOURCE LINE # 1231
0060 120000      R     LCALL   L?0353
0063 2400        R     ADD     A,#LOW asPowerSEQS5S0+02H
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        R     ADDC    A,#HIGH asPowerSEQS5S0+02H
                                           ; SOURCE LINE # 1232
006A 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1233
                                           ; SOURCE LINE # 1234
                                           ; SOURCE LINE # 1235
                                           ; SOURCE LINE # 1236
                                           ; SOURCE LINE # 1237
006D         ?C0158:
006D 22                RET     
             ; FUNCTION Oem_S5S0Sequence (END)

             ; FUNCTION S0S5_VR_ON (BEGIN)
                                           ; SOURCE LINE # 1240
                                           ; SOURCE LINE # 1241
                                           ; SOURCE LINE # 1242
0000 900000      E     MOV     DPTR,#GPDRH
                                           ; SOURCE LINE # 1243
0003 120000      R     LCALL   L?0357
                                           ; SOURCE LINE # 1244
0006 900000      E     MOV     DPTR,#GPDRI
0009 E0                MOVX    A,@DPTR
000A 54EF              ANL     A,#0EFH
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1246
000D 900000      E     MOV     DPTR,#GPCRD5
0010 7480              MOV     A,#080H
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1247
0013 900000      E     MOV     DPTR,#GPDRB
0016 E0                MOVX    A,@DPTR
0017 54FB              ANL     A,#0FBH
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1252
001A 22                RET     
             ; FUNCTION S0S5_VR_ON (END)

C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 77  

             ; FUNCTION S0S5_NVDD_OFF (BEGIN)
                                           ; SOURCE LINE # 1254
                                           ; SOURCE LINE # 1255
                                           ; SOURCE LINE # 1260
0000 22                RET     
             ; FUNCTION S0S5_NVDD_OFF (END)

             ; FUNCTION S0S5_SUSP (BEGIN)
                                           ; SOURCE LINE # 1262
                                           ; SOURCE LINE # 1263
                                           ; SOURCE LINE # 1264
                                           ; SOURCE LINE # 1265
0000 120000      R     LCALL   L?0392
                                           ; SOURCE LINE # 1266
0003 020000      R     LJMP    SetS5GPIO
             ; FUNCTION S0S5_SUSP (END)

             ; FUNCTION S0S5_EC_VCCST_EN (BEGIN)
                                           ; SOURCE LINE # 1268
                                           ; SOURCE LINE # 1269
                                           ; SOURCE LINE # 1270
0000 900000      E     MOV     DPTR,#GPDRA
0003 E0                MOVX    A,@DPTR
0004 547F              ANL     A,#07FH
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1271
0007 22                RET     
             ; FUNCTION S0S5_EC_VCCST_EN (END)

             ; FUNCTION S0S5_EC_VPP_PWREN (BEGIN)
                                           ; SOURCE LINE # 1274
                                           ; SOURCE LINE # 1275
                                           ; SOURCE LINE # 1276
0000 900000      E     MOV     DPTR,#GPDRE
0003 E0                MOVX    A,@DPTR
0004 54F7              ANL     A,#0F7H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1277
0007 22                RET     
             ; FUNCTION S0S5_EC_VPP_PWREN (END)

             ; FUNCTION S0S5_GPO7 (BEGIN)
                                           ; SOURCE LINE # 1280
                                           ; SOURCE LINE # 1281
                                           ; SOURCE LINE # 1283
0000 22                RET     
             ; FUNCTION S0S5_GPO7 (END)

             ; FUNCTION S0S5_SYS_ON (BEGIN)
                                           ; SOURCE LINE # 1285
                                           ; SOURCE LINE # 1286
                                           ; SOURCE LINE # 1287
0000 900000      E     MOV     DPTR,#GPDRG
0003 E0                MOVX    A,@DPTR
0004 54FD              ANL     A,#0FDH
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1288
0007 020000      R     LJMP    Write_NOVOS4
             ; FUNCTION S0S5_SYS_ON (END)

             ; FUNCTION S0S5_DPWROK_OFF (BEGIN)
                                           ; SOURCE LINE # 1290
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 78  

                                           ; SOURCE LINE # 1291
                                           ; SOURCE LINE # 1292
0000 900000      E     MOV     DPTR,#cCmd
0003 E0                MOVX    A,@DPTR
0004 20E203            JB      ACC.2,?C0173
                                           ; SOURCE LINE # 1293
                                           ; SOURCE LINE # 1295
0007 120000      R     LCALL   L?0385
                                           ; SOURCE LINE # 1296
                                           ; SOURCE LINE # 1297
000A         ?C0173:
000A 22                RET     
             ; FUNCTION S0S5_DPWROK_OFF (END)

             ; FUNCTION S0S5_Init_Status (BEGIN)
                                           ; SOURCE LINE # 1300
                                           ; SOURCE LINE # 1301
                                           ; SOURCE LINE # 1303
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#F2_Pressed
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1307
0005 900000      E     MOV     DPTR,#pProject4
0008 E0                MOVX    A,@DPTR
0009 54FE              ANL     A,#0FEH
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1311
000C 900000      E     MOV     DPTR,#SEL_STATE0
000F E0                MOVX    A,@DPTR
0010 30E01F            JNB     ACC.0,?C0174
                                           ; SOURCE LINE # 1312
                                           ; SOURCE LINE # 1313
0013 900000      E     MOV     DPTR,#pProject0
0016 E0                MOVX    A,@DPTR
0017 30E118            JNB     ACC.1,?C0174
                                           ; SOURCE LINE # 1314
                                           ; SOURCE LINE # 1315
                                           ; SOURCE LINE # 1316
                                           ; SOURCE LINE # 1317
001A 120000      R     LCALL   L?0371
001D 7D8C              MOV     R5,#08CH
001F FF                MOV     R7,A
0020 120000      E     LCALL   _bRWSMBus
0023 EF                MOV     A,R7
0024 600C              JZ      ?C0174
                                           ; SOURCE LINE # 1318
                                           ; SOURCE LINE # 1319
0026 900000      E     MOV     DPTR,#pProject0
0029 E0                MOVX    A,@DPTR
002A 54FD              ANL     A,#0FDH
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1320
002D 7FAD              MOV     R7,#0ADH
002F 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1321
                                           ; SOURCE LINE # 1322
                                           ; SOURCE LINE # 1323
0032         ?C0174:
                                           ; SOURCE LINE # 1325
0032 E4                CLR     A
0033 900000      E     MOV     DPTR,#Bioswatchdog
0036 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 79  

                                           ; SOURCE LINE # 1327
0037 900000      E     MOV     DPTR,#uNovoVPCCount
                                           ; SOURCE LINE # 1328
                                           ; SOURCE LINE # 1329
                                           ; SOURCE LINE # 1330
003A 120000      R     LCALL   L?0365
                                           ; SOURCE LINE # 1331
003D 900000      E     MOV     DPTR,#nBatteryStatH
0040 E0                MOVX    A,@DPTR
0041 54FB              ANL     A,#0FBH
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1334
                                           ; SOURCE LINE # 1335
0044 120000      R     LCALL   L?0381
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1336
                                           ; SOURCE LINE # 1337
0048 120000      R     LCALL   L?0395
                                           ; SOURCE LINE # 1338
004B 900000      E     MOV     DPTR,#ECSleepCount
004E 7403              MOV     A,#03H
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1340
0051 120000      E     LCALL   PowerOffClearTPPendingData
                                           ; SOURCE LINE # 1342
0054 900000      E     MOV     DPTR,#GPDRB
0057 E0                MOVX    A,@DPTR
0058 900000      E     MOV     DPTR,#SWI_EVENT
005B 30E106            JNB     ACC.1,?C0177
                                           ; SOURCE LINE # 1343
005E E0                MOVX    A,@DPTR
005F 4402              ORL     A,#02H
0061 F0                MOVX    @DPTR,A
0062 8004              SJMP    ?C0178
0064         ?C0177:
                                           ; SOURCE LINE # 1345
0064 E0                MOVX    A,@DPTR
0065 54FD              ANL     A,#0FDH
0067 F0                MOVX    @DPTR,A
0068         ?C0178:
                                           ; SOURCE LINE # 1347
0068 900000      E     MOV     DPTR,#GPDRJ
006B E0                MOVX    A,@DPTR
006C 54FB              ANL     A,#0FBH
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1349
006F 900000      E     MOV     DPTR,#cSysActionFlag
0072 E0                MOVX    A,@DPTR
0073 6403              XRL     A,#03H
0075 6004              JZ      ?C0180
0077 E0                MOVX    A,@DPTR
0078 B4040D            CJNE    A,#04H,?C0179
007B         ?C0180:
                                           ; SOURCE LINE # 1350
                                           ; SOURCE LINE # 1351
007B 900000      E     MOV     DPTR,#WinFlashMark
007E 7453              MOV     A,#053H
0080 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1352
0081 900000      E     MOV     DPTR,#WinFlashMark2
0084 7435              MOV     A,#035H
                                           ; SOURCE LINE # 1353
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 80  

                                           ; SOURCE LINE # 1354
0086 8017              SJMP    ?C0341
0088         ?C0179:
                                           ; SOURCE LINE # 1356
0088 900000      E     MOV     DPTR,#cSysActionFlag
008B E0                MOVX    A,@DPTR
008C B40214            CJNE    A,#02H,?C0181
                                           ; SOURCE LINE # 1357
                                           ; SOURCE LINE # 1358
008F 7F05              MOV     R7,#05H
0091 120000      E     LCALL   _ProcessSID
                                           ; SOURCE LINE # 1359
0094 900000      E     MOV     DPTR,#WinFlashMark
0097 74AA              MOV     A,#0AAH
0099 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1360
009A 900000      E     MOV     DPTR,#WinFlashMark1
009D 7488              MOV     A,#088H
009F         ?C0341:
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1361
00A0 120000      E     LCALL   InternalWDTNow
                                           ; SOURCE LINE # 1362
00A3         ?C0181:
                                           ; SOURCE LINE # 1366
00A3 900000      E     MOV     DPTR,#SysStatus
00A6 E0                MOVX    A,@DPTR
00A7 30E712            JNB     ACC.7,?C0183
                                           ; SOURCE LINE # 1367
                                           ; SOURCE LINE # 1368
00AA C200        E     CLR     Ccb42_DISAB_KEY
                                           ; SOURCE LINE # 1369
00AC 7800        E     MOV     R0,#LOW Flag
00AE E6                MOV     A,@R0
00AF 54FE              ANL     A,#0FEH
00B1 F6                MOV     @R0,A
                                           ; SOURCE LINE # 1370
00B2 120000      E     LCALL   Unlock_Scan
                                           ; SOURCE LINE # 1371
00B5 900000      E     MOV     DPTR,#SysStatus
00B8 E0                MOVX    A,@DPTR
00B9 547F              ANL     A,#07FH
00BB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1372
00BC         ?C0183:
                                           ; SOURCE LINE # 1374
00BC 900000      E     MOV     DPTR,#PowerUVP_REG
00BF E0                MOVX    A,@DPTR
00C0 FF                MOV     R7,A
00C1 900000      E     MOV     DPTR,#PowerOVP_REG
00C4 E0                MOVX    A,@DPTR
00C5 4F                ORL     A,R7
00C6 FF                MOV     R7,A
00C7 900000      E     MOV     DPTR,#PowerOCP_REG
00CA E0                MOVX    A,@DPTR
00CB 4F                ORL     A,R7
00CC FF                MOV     R7,A
00CD 900000      E     MOV     DPTR,#PowerOTP_REG
00D0 E0                MOVX    A,@DPTR
00D1 4F                ORL     A,R7
00D2 600C              JZ      ?C0184
                                           ; SOURCE LINE # 1375
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 81  

                                           ; SOURCE LINE # 1376
00D4 900000      E     MOV     DPTR,#SysStatus
00D7 E0                MOVX    A,@DPTR
00D8 20E105            JB      ACC.1,?C0184
                                           ; SOURCE LINE # 1377
00DB 7F36              MOV     R7,#036H
00DD 120000      E     LCALL   _ProcessSID
                                           ; SOURCE LINE # 1378
00E0         ?C0184:
                                           ; SOURCE LINE # 1381
00E0 120000      R     LCALL   PollingOTP
                                           ; SOURCE LINE # 1383
00E3 900000      E     MOV     DPTR,#SysStatus
00E6 E0                MOVX    A,@DPTR
00E7 20E105            JB      ACC.1,?C0186
                                           ; SOURCE LINE # 1384
00EA 7F01              MOV     R7,#01H
00EC 120000      E     LCALL   _ProcessSID
00EF         ?C0186:
                                           ; SOURCE LINE # 1385
00EF 900000      E     MOV     DPTR,#SysStatus
00F2 E0                MOVX    A,@DPTR
00F3 54FD              ANL     A,#0FDH
                                           ; SOURCE LINE # 1386
                                           ; SOURCE LINE # 1387
00F5 120000      R     LCALL   L?0405
                                           ; SOURCE LINE # 1388
00F8 900000      E     MOV     DPTR,#PECI_Err_CNT
00FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1391
00FC 120000      R     LCALL   Lowpower_ENfunction
                                           ; SOURCE LINE # 1393
                                           ; SOURCE LINE # 1394
                                           ; SOURCE LINE # 1395
                                           ; SOURCE LINE # 1396
                                           ; SOURCE LINE # 1397
                                           ; SOURCE LINE # 1398
                                           ; SOURCE LINE # 1399
00FF 120000      R     LCALL   L?0354
                                           ; SOURCE LINE # 1400
0102 E0                MOVX    A,@DPTR
0103 547F              ANL     A,#07FH
                                           ; SOURCE LINE # 1403
0105 120000      R     LCALL   L?0372
                                           ; SOURCE LINE # 1404
0108 900000      E     MOV     DPTR,#SysPowState
010B 7455              MOV     A,#055H
010D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1407
010E 22                RET     
             ; FUNCTION S0S5_Init_Status (END)

             ; FUNCTION Oem_S0S5Sequence (BEGIN)
                                           ; SOURCE LINE # 1428
                                           ; SOURCE LINE # 1429
                                           ; SOURCE LINE # 1430
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0328
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0328:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 82  

0008 6009              JZ      ?C0191
                                           ; SOURCE LINE # 1431
                                           ; SOURCE LINE # 1432
                                           ; SOURCE LINE # 1433
000A 120000      R     LCALL   L?0361
000D 7002              JNZ     ?C0329
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0329:
0011 705A              JNZ     ?C0190
                                           ; SOURCE LINE # 1434
                                           ; SOURCE LINE # 1436
                                           ; SOURCE LINE # 1437
0013         ?C0191:
                                           ; SOURCE LINE # 1439
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 9407              SUBB    A,#07H
001A 5051              JNC     ?C0190
                                           ; SOURCE LINE # 1440
                                           ; SOURCE LINE # 1441
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQS0S5+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH asPowerSEQS0S5+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7022              JNZ     ?C0193
                                           ; SOURCE LINE # 1442
                                           ; SOURCE LINE # 1443
002E 120000      R     LCALL   L?0353
0031 2400        R     ADD     A,#LOW asPowerSEQS0S5
0033 F582              MOV     DPL,A
0035 E4                CLR     A
0036 3400        R     ADDC    A,#HIGH asPowerSEQS0S5
                                           ; SOURCE LINE # 1444
0038 120000      R     LCALL   L?0352
003B 2400        R     ADD     A,#LOW asPowerSEQS0S5+02H
003D F582              MOV     DPL,A
003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH asPowerSEQS0S5+02H
                                           ; SOURCE LINE # 1445
0042 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1446
0045 900000      E     MOV     DPTR,#PowSeqDelay
0048 E0                MOVX    A,@DPTR
0049 7002              JNZ     ?C0330
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D         ?C0330:
004D 60C4              JZ      ?C0191
                                           ; SOURCE LINE # 1447
                                           ; SOURCE LINE # 1448
004F 22                RET     
                                           ; SOURCE LINE # 1449
                                           ; SOURCE LINE # 1450
0050         ?C0193:
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 83  

                                           ; SOURCE LINE # 1452
                                           ; SOURCE LINE # 1453
0050 120000      R     LCALL   L?0353
0053 2400        R     ADD     A,#LOW asPowerSEQS0S5
0055 F582              MOV     DPL,A
0057 E4                CLR     A
0058 3400        R     ADDC    A,#HIGH asPowerSEQS0S5
005A 120000      R     LCALL   L?0359
005D EF                MOV     A,R7
005E 600D              JZ      ?C0190
                                           ; SOURCE LINE # 1454
                                           ; SOURCE LINE # 1455
0060 120000      R     LCALL   L?0353
0063 2400        R     ADD     A,#LOW asPowerSEQS0S5+02H
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        R     ADDC    A,#HIGH asPowerSEQS0S5+02H
                                           ; SOURCE LINE # 1456
006A 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1457
                                           ; SOURCE LINE # 1458
                                           ; SOURCE LINE # 1459
                                           ; SOURCE LINE # 1460
                                           ; SOURCE LINE # 1461
006D         ?C0190:
006D 22                RET     
             ; FUNCTION Oem_S0S5Sequence (END)

             ; FUNCTION S0S3_VR_ON (BEGIN)
                                           ; SOURCE LINE # 1464
                                           ; SOURCE LINE # 1465
                                           ; SOURCE LINE # 1466
0000 900000      E     MOV     DPTR,#GPDRH
                                           ; SOURCE LINE # 1467
0003 120000      R     LCALL   L?0357
                                           ; SOURCE LINE # 1468
0006 900000      E     MOV     DPTR,#GPDRI
0009 E0                MOVX    A,@DPTR
000A 54EF              ANL     A,#0EFH
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1470
000D 900000      E     MOV     DPTR,#GPDRB
0010 E0                MOVX    A,@DPTR
0011 54FB              ANL     A,#0FBH
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1477
0014 22                RET     
             ; FUNCTION S0S3_VR_ON (END)

             ; FUNCTION S0S3_SUSP (BEGIN)
                                           ; SOURCE LINE # 1479
                                           ; SOURCE LINE # 1480
                                           ; SOURCE LINE # 1481
                                           ; SOURCE LINE # 1482
0000 120000      R     LCALL   L?0392
                                           ; SOURCE LINE # 1487
0003 020000      R     LJMP    SetS5GPIO
             ; FUNCTION S0S3_SUSP (END)

             ; FUNCTION S0S3_EC_VCCST_EN (BEGIN)
                                           ; SOURCE LINE # 1489
                                           ; SOURCE LINE # 1490
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 84  

                                           ; SOURCE LINE # 1491
0000 900000      E     MOV     DPTR,#GPDRA
0003 E0                MOVX    A,@DPTR
0004 547F              ANL     A,#07FH
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1492
0007 22                RET     
             ; FUNCTION S0S3_EC_VCCST_EN (END)

             ; FUNCTION S0S3_GPO7 (BEGIN)
                                           ; SOURCE LINE # 1493
                                           ; SOURCE LINE # 1494
                                           ; SOURCE LINE # 1496
0000 22                RET     
             ; FUNCTION S0S3_GPO7 (END)

             ; FUNCTION S0S3_Init_Status (BEGIN)
                                           ; SOURCE LINE # 1497
                                           ; SOURCE LINE # 1498
                                           ; SOURCE LINE # 1503
                                           ; SOURCE LINE # 1504
0000 120000      R     LCALL   L?0381
                                           ; SOURCE LINE # 1505
                                           ; SOURCE LINE # 1506
                                           ; SOURCE LINE # 1507
0003 120000      R     LCALL   L?0365
                                           ; SOURCE LINE # 1511
0006 120000      E     LCALL   PowerOffClearTPPendingData
                                           ; SOURCE LINE # 1514
0009 E4                CLR     A
                                           ; SOURCE LINE # 1515
000A 120000      R     LCALL   L?0395
                                           ; SOURCE LINE # 1516
000D 900000      E     MOV     DPTR,#AOAC_STATUS
0010 E0                MOVX    A,@DPTR
0011 5410              ANL     A,#010H
                                           ; SOURCE LINE # 1517
                                           ; SOURCE LINE # 1518
0013 120000      R     LCALL   L?0405
                                           ; SOURCE LINE # 1520
0016 900000      E     MOV     DPTR,#GPDRJ
0019 E0                MOVX    A,@DPTR
001A 54FB              ANL     A,#0FBH
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1521
001D E4                CLR     A
001E 900000      E     MOV     DPTR,#PECI_Err_CNT
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1524
0022 120000      R     LCALL   Lowpower_ENfunction
                                           ; SOURCE LINE # 1526
                                           ; SOURCE LINE # 1527
                                           ; SOURCE LINE # 1528
                                           ; SOURCE LINE # 1529
                                           ; SOURCE LINE # 1530
                                           ; SOURCE LINE # 1531
                                           ; SOURCE LINE # 1532
0025 120000      R     LCALL   L?0355
                                           ; SOURCE LINE # 1534
0028 E0                MOVX    A,@DPTR
0029 547F              ANL     A,#07FH
002B F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 85  

                                           ; SOURCE LINE # 1536
002C 900000      E     MOV     DPTR,#SysPowState
002F 7433              MOV     A,#033H
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1538
0032 22                RET     
             ; FUNCTION S0S3_Init_Status (END)

             ; FUNCTION Oem_S0S3Sequence (BEGIN)
                                           ; SOURCE LINE # 1554
                                           ; SOURCE LINE # 1555
                                           ; SOURCE LINE # 1556
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0331
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0331:
0008 6009              JZ      ?C0205
                                           ; SOURCE LINE # 1557
                                           ; SOURCE LINE # 1558
                                           ; SOURCE LINE # 1559
000A 120000      R     LCALL   L?0361
000D 7002              JNZ     ?C0332
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0332:
0011 705A              JNZ     ?C0204
                                           ; SOURCE LINE # 1560
                                           ; SOURCE LINE # 1562
                                           ; SOURCE LINE # 1563
0013         ?C0205:
                                           ; SOURCE LINE # 1565
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 9404              SUBB    A,#04H
001A 5051              JNC     ?C0204
                                           ; SOURCE LINE # 1566
                                           ; SOURCE LINE # 1567
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQS0S3+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH asPowerSEQS0S3+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7022              JNZ     ?C0207
                                           ; SOURCE LINE # 1568
                                           ; SOURCE LINE # 1569
002E 120000      R     LCALL   L?0353
0031 2400        R     ADD     A,#LOW asPowerSEQS0S3
0033 F582              MOV     DPL,A
0035 E4                CLR     A
0036 3400        R     ADDC    A,#HIGH asPowerSEQS0S3
                                           ; SOURCE LINE # 1570
0038 120000      R     LCALL   L?0352
003B 2400        R     ADD     A,#LOW asPowerSEQS0S3+02H
003D F582              MOV     DPL,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 86  

003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH asPowerSEQS0S3+02H
                                           ; SOURCE LINE # 1571
0042 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1572
0045 900000      E     MOV     DPTR,#PowSeqDelay
0048 E0                MOVX    A,@DPTR
0049 7002              JNZ     ?C0333
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D         ?C0333:
004D 60C4              JZ      ?C0205
                                           ; SOURCE LINE # 1573
                                           ; SOURCE LINE # 1574
004F 22                RET     
                                           ; SOURCE LINE # 1575
                                           ; SOURCE LINE # 1576
0050         ?C0207:
                                           ; SOURCE LINE # 1578
                                           ; SOURCE LINE # 1579
0050 120000      R     LCALL   L?0353
0053 2400        R     ADD     A,#LOW asPowerSEQS0S3
0055 F582              MOV     DPL,A
0057 E4                CLR     A
0058 3400        R     ADDC    A,#HIGH asPowerSEQS0S3
005A 120000      R     LCALL   L?0359
005D EF                MOV     A,R7
005E 600D              JZ      ?C0204
                                           ; SOURCE LINE # 1580
                                           ; SOURCE LINE # 1581
0060 120000      R     LCALL   L?0353
0063 2400        R     ADD     A,#LOW asPowerSEQS0S3+02H
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        R     ADDC    A,#HIGH asPowerSEQS0S3+02H
                                           ; SOURCE LINE # 1582
006A 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1583
                                           ; SOURCE LINE # 1584
                                           ; SOURCE LINE # 1585
                                           ; SOURCE LINE # 1586
                                           ; SOURCE LINE # 1587
006D         ?C0204:
006D 22                RET     
             ; FUNCTION Oem_S0S3Sequence (END)

             ; FUNCTION S3S0_PM_PWER_BTN1 (BEGIN)
                                           ; SOURCE LINE # 1590
                                           ; SOURCE LINE # 1591
                                           ; SOURCE LINE # 1592
0000 120000      R     LCALL   L?0387
                                           ; SOURCE LINE # 1593
0003 22                RET     
             ; FUNCTION S3S0_PM_PWER_BTN1 (END)

             ; FUNCTION S3S0_PM_PWER_BTN2 (BEGIN)
                                           ; SOURCE LINE # 1595
                                           ; SOURCE LINE # 1596
                                           ; SOURCE LINE # 1597
0000 120000      R     LCALL   L?0373
                                           ; SOURCE LINE # 1598
0003 900000      E     MOV     DPTR,#SysPowState
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 87  

0006 7433              MOV     A,#033H
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1599
0009 22                RET     
             ; FUNCTION S3S0_PM_PWER_BTN2 (END)

             ; FUNCTION S3S0_EC_VCCST_EN (BEGIN)
                                           ; SOURCE LINE # 1600
                                           ; SOURCE LINE # 1601
                                           ; SOURCE LINE # 1602
0000 120000      R     LCALL   L?0403
                                           ; SOURCE LINE # 1603
0003 22                RET     
             ; FUNCTION S3S0_EC_VCCST_EN (END)

             ; FUNCTION S3S0_GPO7 (BEGIN)
                                           ; SOURCE LINE # 1604
                                           ; SOURCE LINE # 1605
                                           ; SOURCE LINE # 1607
0000 22                RET     
             ; FUNCTION S3S0_GPO7 (END)

             ; FUNCTION S3S0_SUSP (BEGIN)
                                           ; SOURCE LINE # 1608
                                           ; SOURCE LINE # 1609
                                           ; SOURCE LINE # 1610
0000 120000      R     LCALL   L?0373
                                           ; SOURCE LINE # 1611
0003 900000      E     MOV     DPTR,#GPDRC
0006 E0                MOVX    A,@DPTR
0007 4440              ORL     A,#040H
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1612
000A 120000      R     LCALL   SetS0GPIO
                                           ; SOURCE LINE # 1613
                                           ; SOURCE LINE # 1614
000D 120000      R     LCALL   L?0378
                                           ; SOURCE LINE # 1623
0010 22                RET     
             ; FUNCTION S3S0_SUSP (END)

             ; FUNCTION S3S0_EC_VCCIO_EN (BEGIN)
                                           ; SOURCE LINE # 1625
                                           ; SOURCE LINE # 1626
                                           ; SOURCE LINE # 1627
0000 900000      E     MOV     DPTR,#GPDRB
0003 E0                MOVX    A,@DPTR
0004 4404              ORL     A,#04H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1628
0007 22                RET     
             ; FUNCTION S3S0_EC_VCCIO_EN (END)

             ; FUNCTION S3S0_VCCST_PWRGD (BEGIN)
                                           ; SOURCE LINE # 1630
                                           ; SOURCE LINE # 1631
                                           ; SOURCE LINE # 1633
0000 22                RET     
             ; FUNCTION S3S0_VCCST_PWRGD (END)

             ; FUNCTION S3S0_VR_ON (BEGIN)
                                           ; SOURCE LINE # 1635
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 88  

                                           ; SOURCE LINE # 1636
                                           ; SOURCE LINE # 1637
0000 900000      E     MOV     DPTR,#GPDRI
0003 E0                MOVX    A,@DPTR
0004 4410              ORL     A,#010H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1638
0007 900000      E     MOV     DPTR,#MuteCount
000A 7412              MOV     A,#012H
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1640
000D 900000      E     MOV     DPTR,#SYS_STATUS
0010 E0                MOVX    A,@DPTR
0011 30E706            JNB     ACC.7,?C0219
                                           ; SOURCE LINE # 1641
                                           ; SOURCE LINE # 1643
                                           ; SOURCE LINE # 1644
0014 120000      R     LCALL   L?0409
0017 7420              MOV     A,#020H
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1645
                                           ; SOURCE LINE # 1647
001A         ?C0219:
001A 22                RET     
             ; FUNCTION S3S0_VR_ON (END)

             ; FUNCTION PCH_PWROK (BEGIN)
                                           ; SOURCE LINE # 1648
                                           ; SOURCE LINE # 1649
                                           ; SOURCE LINE # 1650
0000 900000      E     MOV     DPTR,#GPDRH
0003 E0                MOVX    A,@DPTR
0004 4440              ORL     A,#040H
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1651
0007 22                RET     
             ; FUNCTION PCH_PWROK (END)

             ; FUNCTION S3S0_Init_Status (BEGIN)
                                           ; SOURCE LINE # 1654
                                           ; SOURCE LINE # 1655
                                           ; SOURCE LINE # 1656
                                           ; SOURCE LINE # 1657
0000 120000      R     LCALL   L?0394
                                           ; SOURCE LINE # 1660
0003 7F9B              MOV     R7,#09BH
0005 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1663
                                           ; SOURCE LINE # 1664
0008 120000      R     LCALL   L?0375
                                           ; SOURCE LINE # 1665
000B 900000      E     MOV     DPTR,#BackLight_En_Delay
000E 7403              MOV     A,#03H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1666
0011 7428              MOV     A,#028H
                                           ; SOURCE LINE # 1668
0013 120000      R     LCALL   L?0390
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1669
0017 900000      E     MOV     DPTR,#CURRENT_STATUS
001A E0                MOVX    A,@DPTR
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 89  

001B 54C0              ANL     A,#0C0H
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1673
                                           ; SOURCE LINE # 1676
001E 900000      E     MOV     DPTR,#GPDRJ
0021 E0                MOVX    A,@DPTR
0022 4404              ORL     A,#04H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1677
                                           ; SOURCE LINE # 1680
0025 120000      R     LCALL   Lowpower_DISfunction
                                           ; SOURCE LINE # 1681
0028 900000      E     MOV     DPTR,#SysPowState
002B 7411              MOV     A,#011H
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1684
002E 22                RET     
             ; FUNCTION S3S0_Init_Status (END)

             ; FUNCTION Oem_S3S0Sequence (BEGIN)
                                           ; SOURCE LINE # 1709
                                           ; SOURCE LINE # 1710
                                           ; SOURCE LINE # 1711
0000 900000      E     MOV     DPTR,#PowSeqDelay
0003 E0                MOVX    A,@DPTR
0004 7002              JNZ     ?C0334
0006 A3                INC     DPTR
0007 E0                MOVX    A,@DPTR
0008         ?C0334:
0008 6009              JZ      ?C0225
                                           ; SOURCE LINE # 1712
                                           ; SOURCE LINE # 1713
                                           ; SOURCE LINE # 1714
000A 120000      R     LCALL   L?0361
000D 7002              JNZ     ?C0335
000F A3                INC     DPTR
0010 E0                MOVX    A,@DPTR
0011         ?C0335:
0011 705A              JNZ     ?C0224
                                           ; SOURCE LINE # 1715
                                           ; SOURCE LINE # 1717
                                           ; SOURCE LINE # 1718
0013         ?C0225:
                                           ; SOURCE LINE # 1720
0013 900000      E     MOV     DPTR,#PWSeqStep
0016 E0                MOVX    A,@DPTR
0017 C3                CLR     C
0018 940D              SUBB    A,#0DH
001A 5051              JNC     ?C0224
                                           ; SOURCE LINE # 1721
                                           ; SOURCE LINE # 1722
001C E0                MOVX    A,@DPTR
001D 75F005            MOV     B,#05H
0020 A4                MUL     AB
0021 2400        R     ADD     A,#LOW asPowerSEQS3S0+04H
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH asPowerSEQS3S0+04H
0028 F583              MOV     DPH,A
002A E4                CLR     A
002B 93                MOVC    A,@A+DPTR
002C 7022              JNZ     ?C0227
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 90  

                                           ; SOURCE LINE # 1723
                                           ; SOURCE LINE # 1724
002E 120000      R     LCALL   L?0353
0031 2400        R     ADD     A,#LOW asPowerSEQS3S0
0033 F582              MOV     DPL,A
0035 E4                CLR     A
0036 3400        R     ADDC    A,#HIGH asPowerSEQS3S0
                                           ; SOURCE LINE # 1725
0038 120000      R     LCALL   L?0352
003B 2400        R     ADD     A,#LOW asPowerSEQS3S0+02H
003D F582              MOV     DPL,A
003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH asPowerSEQS3S0+02H
                                           ; SOURCE LINE # 1726
0042 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1727
0045 900000      E     MOV     DPTR,#PowSeqDelay
0048 E0                MOVX    A,@DPTR
0049 7002              JNZ     ?C0336
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D         ?C0336:
004D 60C4              JZ      ?C0225
                                           ; SOURCE LINE # 1728
                                           ; SOURCE LINE # 1729
004F 22                RET     
                                           ; SOURCE LINE # 1730
                                           ; SOURCE LINE # 1731
0050         ?C0227:
                                           ; SOURCE LINE # 1733
                                           ; SOURCE LINE # 1734
0050 120000      R     LCALL   L?0353
0053 2400        R     ADD     A,#LOW asPowerSEQS3S0
0055 F582              MOV     DPL,A
0057 E4                CLR     A
0058 3400        R     ADDC    A,#HIGH asPowerSEQS3S0
005A 120000      R     LCALL   L?0359
005D EF                MOV     A,R7
005E 600D              JZ      ?C0224
                                           ; SOURCE LINE # 1735
                                           ; SOURCE LINE # 1736
0060 120000      R     LCALL   L?0353
0063 2400        R     ADD     A,#LOW asPowerSEQS3S0+02H
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        R     ADDC    A,#HIGH asPowerSEQS3S0+02H
                                           ; SOURCE LINE # 1737
006A 120000      R     LCALL   L?0350
                                           ; SOURCE LINE # 1738
                                           ; SOURCE LINE # 1739
                                           ; SOURCE LINE # 1740
                                           ; SOURCE LINE # 1741
                                           ; SOURCE LINE # 1742
006D         ?C0224:
006D 22                RET     
             ; FUNCTION Oem_S3S0Sequence (END)

             ; FUNCTION CheckAutoPowerOn (BEGIN)
                                           ; SOURCE LINE # 1744
                                           ; SOURCE LINE # 1745
                                           ; SOURCE LINE # 1746
0000 900000      E     MOV     DPTR,#WinFlashMark
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 91  

0003 E0                MOVX    A,@DPTR
0004 6453              XRL     A,#053H
0006 7030              JNZ     ?C0235
0008 900000      E     MOV     DPTR,#WinFlashMark2
000B E0                MOVX    A,@DPTR
000C 6435              XRL     A,#035H
000E 7028              JNZ     ?C0235
0010 900000      E     MOV     DPTR,#SysPowState
0013 E0                MOVX    A,@DPTR
0014 6455              XRL     A,#055H
0016 6011              JZ      ?C0232
0018 E0                MOVX    A,@DPTR
0019 B4661C            CJNE    A,#066H,?C0235
001C 900000      E     MOV     DPTR,#GPDRB
001F E0                MOVX    A,@DPTR
0020 30E003            JNB     ACC.0,?C0233
0023 D3                SETB    C
0024 8001              SJMP    ?C0234
0026         ?C0233:
0026 C3                CLR     C
0027         ?C0234:
0027 400F              JC      ?C0235
0029         ?C0232:
                                           ; SOURCE LINE # 1747
                                           ; SOURCE LINE # 1749
0029 900000      E     MOV     DPTR,#AutoTimer
002C 7483              MOV     A,#083H
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1750
002F E4                CLR     A
0030 900000      E     MOV     DPTR,#WinFlashMark
0033 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1751
0034 900000      E     MOV     DPTR,#WinFlashMark2
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1752
                                           ; SOURCE LINE # 1753
0038         ?C0235:
0038 22                RET     
             ; FUNCTION CheckAutoPowerOn (END)

             ; FUNCTION Check_EC_ON (BEGIN)
                                           ; SOURCE LINE # 1755
                                           ; SOURCE LINE # 1756
                                           ; SOURCE LINE # 1758
0000 900000      E     MOV     DPTR,#ACPI_HOTKEY
0003 E0                MOVX    A,@DPTR
0004 20E764            JB      ACC.7,?C0236
0007 900000      E     MOV     DPTR,#LOWBATT_3TIMES
000A E0                MOVX    A,@DPTR
000B 705E              JNZ     ?C0236
                                           ; SOURCE LINE # 1759
                                           ; SOURCE LINE # 1760
000D 900000      E     MOV     DPTR,#ACPI_HOTKEY
0010 E0                MOVX    A,@DPTR
0011 20E657            JB      ACC.6,?C0236
                                           ; SOURCE LINE # 1761
                                           ; SOURCE LINE # 1764
0014 900000      E     MOV     DPTR,#GPDRB
0017 E0                MOVX    A,@DPTR
0018 30E003            JNB     ACC.0,?C0239
001B D3                SETB    C
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 92  

001C 8001              SJMP    ?C0240
001E         ?C0239:
001E C3                CLR     C
001F         ?C0240:
001F 4055              JC      ?C0242
0021 900000      E     MOV     DPTR,#SysPowState
0024 E0                MOVX    A,@DPTR
0025 6455              XRL     A,#055H
0027 704D              JNZ     ?C0242
                                           ; SOURCE LINE # 1765
                                           ; SOURCE LINE # 1769
0029 900000      E     MOV     DPTR,#ShipModeEn
002C E0                MOVX    A,@DPTR
002D B4A514            CJNE    A,#0A5H,?C0241
                                           ; SOURCE LINE # 1770
                                           ; SOURCE LINE # 1771
0030 E4                CLR     A
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1772
0032 120000      E     LCALL   Lock_ShipMode
                                           ; SOURCE LINE # 1773
0035 900000      E     MOV     DPTR,#GPCRC1
0038 7480              MOV     A,#080H
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1774
003B 900000      E     MOV     DPTR,#GPCRC2
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1775
003F 7F64              MOV     R7,#064H
0041 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 1776
0044         ?C0241:
                                           ; SOURCE LINE # 1779
0044 120000      R     LCALL   L?0385
                                           ; SOURCE LINE # 1780
0047 7F02              MOV     R7,#02H
0049 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 1781
004C 900000      E     MOV     DPTR,#GPDRH
004F E0                MOVX    A,@DPTR
0050 54EF              ANL     A,#0EFH
0052 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1782
0053 7F0C              MOV     R7,#0CH
0055 120000      E     LCALL   _Delay1MS
                                           ; SOURCE LINE # 1794
0058 120000      R     LCALL   L?0400
                                           ; SOURCE LINE # 1795
005B E0                MOVX    A,@DPTR
005C 54FD              ANL     A,#0FDH
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1797
005F 900000      E     MOV     DPTR,#LENOVOPMFW_Temp
0062 E0                MOVX    A,@DPTR
0063 54F7              ANL     A,#0F7H
0065 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1798
0066 E0                MOVX    A,@DPTR
0067 4420              ORL     A,#020H
0069 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1799
006A 22                RET     
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 93  

                                           ; SOURCE LINE # 1802
                                           ; SOURCE LINE # 1803
006B         ?C0236:
                                           ; SOURCE LINE # 1804
006B 900000      E     MOV     DPTR,#LENOVOPMFW_Temp
006E E0                MOVX    A,@DPTR
006F 4408              ORL     A,#08H
0071 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1805
0072 E0                MOVX    A,@DPTR
0073 54DF              ANL     A,#0DFH
0075 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1806
0076         ?C0242:
0076 22                RET     
             ; FUNCTION Check_EC_ON (END)

             ; FUNCTION check8sreset (BEGIN)
                                           ; SOURCE LINE # 1809
                                           ; SOURCE LINE # 1810
                                           ; SOURCE LINE # 1813
0000 900000      E     MOV     DPTR,#ShutDnCause
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1815
0008 120000      E     LCALL   Init_SMBus_Regs
                                           ; SOURCE LINE # 1817
000B 900000      E     MOV     DPTR,#PWRSW8SRST
000E E0                MOVX    A,@DPTR
000F 900000      E     MOV     DPTR,#SysStatus2
0012 30E108            JNB     ACC.1,?C0243
                                           ; SOURCE LINE # 1818
                                           ; SOURCE LINE # 1819
0015 E0                MOVX    A,@DPTR
0016 4408              ORL     A,#08H
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1820
0019 7FA8              MOV     R7,#0A8H
                                           ; SOURCE LINE # 1821
001B 8006              SJMP    ?C0342
001D         ?C0243:
                                           ; SOURCE LINE # 1823
                                           ; SOURCE LINE # 1824
001D E0                MOVX    A,@DPTR
001E 54F7              ANL     A,#0F7H
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1825
0021 7FA9              MOV     R7,#0A9H
0023         ?C0342:
0023 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 1826
                                           ; SOURCE LINE # 1827
0026         ?C0245:
0026 22                RET     
             ; FUNCTION check8sreset (END)

             ; FUNCTION SendSynapticsIDSequence (BEGIN)
                                           ; SOURCE LINE # 1924
                                           ; SOURCE LINE # 1925
                                           ; SOURCE LINE # 1928
0000 E4                CLR     A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 94  

0001 900000      R     MOV     DPTR,#Temp
0004 F0                MOVX    @DPTR,A
0005         ?C0248:
                                           ; SOURCE LINE # 1930
                                           ; SOURCE LINE # 1931
0005 7B01              MOV     R3,#01H
0007 7DE8              MOV     R5,#0E8H
0009 7F02              MOV     R7,#02H
000B 120000      E     LCALL   _Send2PortNWait
                                           ; SOURCE LINE # 1932
000E 7B01              MOV     R3,#01H
0010 E4                CLR     A
0011 FD                MOV     R5,A
0012 7F02              MOV     R7,#02H
0014 120000      E     LCALL   _Send2PortNWait
                                           ; SOURCE LINE # 1933
0017 900000      R     MOV     DPTR,#Temp
001A E0                MOVX    A,@DPTR
001B 04                INC     A
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1934
001D E0                MOVX    A,@DPTR
001E C3                CLR     C
001F 9404              SUBB    A,#04H
0021 40E2              JC      ?C0248
                                           ; SOURCE LINE # 1936
0023 120000      R     LCALL   L?0410
0026 020000      E     LJMP    _Send2PortNWait
             ; FUNCTION SendSynapticsIDSequence (END)

             ; FUNCTION SendElanIDSequence (BEGIN)
                                           ; SOURCE LINE # 1939
                                           ; SOURCE LINE # 1940
                                           ; SOURCE LINE # 1941
0000 120000      R     LCALL   L?0388
                                           ; SOURCE LINE # 1942
0003 120000      R     LCALL   L?0388
                                           ; SOURCE LINE # 1943
0006 7B01              MOV     R3,#01H
0008 7DE6              MOV     R5,#0E6H
000A 7F02              MOV     R7,#02H
000C 120000      E     LCALL   _Send2PortNWait
                                           ; SOURCE LINE # 1944
000F 120000      R     LCALL   L?0410
0012 020000      E     LJMP    _Send2PortNWait
                                           ; SOURCE LINE # 1945
0015         L?0388:
0015 7B01              MOV     R3,#01H
0017 7DE6              MOV     R5,#0E6H
0019 7F02              MOV     R7,#02H
001B 120000      E     LCALL   _Send2PortNWait
001E 22                RET     
             ; FUNCTION SendElanIDSequence (END)

             ; FUNCTION SendALPSIDSequence (BEGIN)
                                           ; SOURCE LINE # 1946
                                           ; SOURCE LINE # 1947
                                           ; SOURCE LINE # 1948
0000 120000      R     LCALL   L?0389
                                           ; SOURCE LINE # 1949
0003 120000      R     LCALL   L?0389
                                           ; SOURCE LINE # 1950
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 95  

0006 7B01              MOV     R3,#01H
0008 7DE7              MOV     R5,#0E7H
000A 7F02              MOV     R7,#02H
000C 120000      E     LCALL   _Send2PortNWait
                                           ; SOURCE LINE # 1951
000F 120000      R     LCALL   L?0411
0012 020000      E     LJMP    _Send2PortNWait
                                           ; SOURCE LINE # 1952
0015         L?0389:
0015 7B01              MOV     R3,#01H
0017 7DE7              MOV     R5,#0E7H
0019 7F02              MOV     R7,#02H
001B 120000      E     LCALL   _Send2PortNWait
001E 22                RET     
             ; FUNCTION SendALPSIDSequence (END)

             ; FUNCTION ReadTPid (BEGIN)
                                           ; SOURCE LINE # 1953
                                           ; SOURCE LINE # 1954
                                           ; SOURCE LINE # 1958
0000 120000      R     LCALL   SendSynapticsIDSequence
                                           ; SOURCE LINE # 1960
0003 900000      E     MOV     DPTR,#TPID3
0006 E0                MOVX    A,@DPTR
0007 B44707            CJNE    A,#047H,?C0252
                                           ; SOURCE LINE # 1961
                                           ; SOURCE LINE # 1962
000A 900000      E     MOV     DPTR,#TP_Type
000D 7402              MOV     A,#02H
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1963
0010 22                RET     
0011         ?C0252:
                                           ; SOURCE LINE # 1965
                                           ; SOURCE LINE # 1966
0011 120000      R     LCALL   SendElanIDSequence
                                           ; SOURCE LINE # 1967
0014 900000      E     MOV     DPTR,#TPID2
0017 E0                MOVX    A,@DPTR
0018 B43C07            CJNE    A,#03CH,?C0254
                                           ; SOURCE LINE # 1968
                                           ; SOURCE LINE # 1969
001B 900000      E     MOV     DPTR,#TP_Type
001E 7401              MOV     A,#01H
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1970
0021 22                RET     
0022         ?C0254:
                                           ; SOURCE LINE # 1972
                                           ; SOURCE LINE # 1973
0022 120000      R     LCALL   SendALPSIDSequence
                                           ; SOURCE LINE # 1974
0025 900000      E     MOV     DPTR,#TPID2
0028 E0                MOVX    A,@DPTR
0029 B47306            CJNE    A,#073H,?C0257
                                           ; SOURCE LINE # 1975
                                           ; SOURCE LINE # 1976
002C 900000      E     MOV     DPTR,#TP_Type
002F 7403              MOV     A,#03H
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1977
                                           ; SOURCE LINE # 1979
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 96  

                                           ; SOURCE LINE # 1980
                                           ; SOURCE LINE # 1993
0032         ?C0257:
0032 22                RET     
             ; FUNCTION ReadTPid (END)

             ; FUNCTION Write_NOVOS4 (BEGIN)
                                           ; SOURCE LINE # 1995
                                           ; SOURCE LINE # 1996
                                           ; SOURCE LINE # 1997
0000 900000      E     MOV     DPTR,#LENOVOPMFW_Temp
0003 E0                MOVX    A,@DPTR
0004 30E403            JNB     ACC.4,$ + 6H
0007 020000      R     LJMP    ?C0275
                                           ; SOURCE LINE # 1998
                                           ; SOURCE LINE # 1999
000A 7BDF              MOV     R3,#0DFH
000C 7DB7              MOV     R5,#0B7H
000E 7F01              MOV     R7,#01H
0010 120000      E     LCALL   _Read_Eflash_Byte
0013 900000      E     MOV     DPTR,#EEPROM_PwrSts
0016 EF                MOV     A,R7
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2000
0018 900000      E     MOV     DPTR,#CURRENT_STATUS
001B E0                MOVX    A,@DPTR
001C 30E23E            JNB     ACC.2,?C0259
                                           ; SOURCE LINE # 2001
                                           ; SOURCE LINE # 2003
001F 120000      R     LCALL   L?0412
0022 C3                CLR     C
0023 9404              SUBB    A,#04H
0025 401D              JC      ?C0260
0027 E0                MOVX    A,@DPTR
0028 5407              ANL     A,#07H
002A D3                SETB    C
002B 9406              SUBB    A,#06H
002D 5015              JNC     ?C0260
                                           ; SOURCE LINE # 2004
                                           ; SOURCE LINE # 2005
002F 900000      E     MOV     DPTR,#EEPROM_PwrSts
0032 E0                MOVX    A,@DPTR
0033 20E406            JB      ACC.4,?C0261
                                           ; SOURCE LINE # 2006
                                           ; SOURCE LINE # 2007
0036 E0                MOVX    A,@DPTR
0037 30E05B            JNB     ACC.0,?C0275
                                           ; SOURCE LINE # 2008
                                           ; SOURCE LINE # 2009
                                           ; SOURCE LINE # 2010
                                           ; SOURCE LINE # 2011
                                           ; SOURCE LINE # 2012
                                           ; SOURCE LINE # 2013
                                           ; SOURCE LINE # 2014
003A 8000              SJMP    ?C0343
003C         ?C0261:
                                           ; SOURCE LINE # 2016
                                           ; SOURCE LINE # 2017
003C         ?C0343:
                                           ; SOURCE LINE # 2018
                                           ; SOURCE LINE # 2019
003C 120000      R     LCALL   L?0363
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 97  

003F 74EE              MOV     A,#0EEH
                                           ; SOURCE LINE # 2020
                                           ; SOURCE LINE # 2021
                                           ; SOURCE LINE # 2022
0041 020000      R     LJMP    ?C0347
0044         ?C0260:
                                           ; SOURCE LINE # 2024
                                           ; SOURCE LINE # 2025
0044 900000      E     MOV     DPTR,#EEPROM_PwrSts
0047 E0                MOVX    A,@DPTR
0048 20E40B            JB      ACC.4,?C0265
                                           ; SOURCE LINE # 2026
                                           ; SOURCE LINE # 2027
004B E0                MOVX    A,@DPTR
004C 20E046            JB      ACC.0,?C0275
                                           ; SOURCE LINE # 2028
                                           ; SOURCE LINE # 2029
                                           ; SOURCE LINE # 2030
                                           ; SOURCE LINE # 2031
004F 120000      R     LCALL   L?0363
0052 74EF              MOV     A,#0EFH
0054         ?C0344:
                                           ; SOURCE LINE # 2032
                                           ; SOURCE LINE # 2033
                                           ; SOURCE LINE # 2034
0054 8037              SJMP    ?C0347
0056         ?C0265:
                                           ; SOURCE LINE # 2036
                                           ; SOURCE LINE # 2037
                                           ; SOURCE LINE # 2038
                                           ; SOURCE LINE # 2039
0056 120000      R     LCALL   L?0364
0059 74EF              MOV     A,#0EFH
005B         ?C0345:
                                           ; SOURCE LINE # 2040
                                           ; SOURCE LINE # 2041
                                           ; SOURCE LINE # 2042
                                           ; SOURCE LINE # 2043
005B 8030              SJMP    ?C0347
005D         ?C0259:
                                           ; SOURCE LINE # 2045
                                           ; SOURCE LINE # 2046
005D 900000      E     MOV     DPTR,#EEPROM_PwrSts
0060 E0                MOVX    A,@DPTR
0061 20E407            JB      ACC.4,?C0269
                                           ; SOURCE LINE # 2047
                                           ; SOURCE LINE # 2048
                                           ; SOURCE LINE # 2049
                                           ; SOURCE LINE # 2050
0064 120000      R     LCALL   L?0364
0067 74FF              MOV     A,#0FFH
0069         ?C0346:
                                           ; SOURCE LINE # 2051
                                           ; SOURCE LINE # 2052
0069 8022              SJMP    ?C0347
006B         ?C0269:
                                           ; SOURCE LINE # 2054
                                           ; SOURCE LINE # 2055
006B 900000      E     MOV     DPTR,#EEPROM_PwrSts
006E E0                MOVX    A,@DPTR
006F 20E023            JB      ACC.0,?C0275
                                           ; SOURCE LINE # 2056
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 98  

                                           ; SOURCE LINE # 2058
0072 120000      R     LCALL   L?0412
0075 C3                CLR     C
0076 9404              SUBB    A,#04H
0078 4003              JC      ?C0273
007A D3                SETB    C
007B 8001              SJMP    ?C0274
007D         ?C0273:
007D C3                CLR     C
007E         ?C0274:
007E 4015              JC      ?C0275
0080 120000      R     LCALL   L?0413
0083 D3                SETB    C
0084 9406              SUBB    A,#06H
0086 500D              JNC     ?C0275
                                           ; SOURCE LINE # 2059
                                           ; SOURCE LINE # 2060
                                           ; SOURCE LINE # 2061
                                           ; SOURCE LINE # 2062
0088 120000      R     LCALL   L?0364
008B 74FF              MOV     A,#0FFH
008D         ?C0347:
008D F0                MOVX    @DPTR,A
008E 900000      E     MOV     DPTR,#eEEPROMData
0091 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2063
0092 120000      E     LCALL   Update_EEPROMMark
                                           ; SOURCE LINE # 2064
                                           ; SOURCE LINE # 2065
                                           ; SOURCE LINE # 2066
                                           ; SOURCE LINE # 2067
                                           ; SOURCE LINE # 2068
                                           ; SOURCE LINE # 2069
0095         ?C0275:
0095 22                RET     
             ; FUNCTION Write_NOVOS4 (END)

             ; FUNCTION PulseSBPowerButton (BEGIN)
                                           ; SOURCE LINE # 2074
                                           ; SOURCE LINE # 2075
                                           ; SOURCE LINE # 2076
0000 120000      R     LCALL   L?0387
                                           ; SOURCE LINE # 2077
0003 900000      E     MOV     DPTR,#SBSWReleaseCunt
0006 7414              MOV     A,#014H
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2078
0009 22                RET     
             ; FUNCTION PulseSBPowerButton (END)

             ; FUNCTION CheckSBPowerButton (BEGIN)
                                           ; SOURCE LINE # 2084
                                           ; SOURCE LINE # 2085
                                           ; SOURCE LINE # 2086
0000 900000      E     MOV     DPTR,#SBSWReleaseCunt
0003 E0                MOVX    A,@DPTR
0004 6009              JZ      ?C0279
                                           ; SOURCE LINE # 2087
                                           ; SOURCE LINE # 2088
0006 E0                MOVX    A,@DPTR
0007 14                DEC     A
0008 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 99  

                                           ; SOURCE LINE # 2089
0009 E0                MOVX    A,@DPTR
000A 7003              JNZ     ?C0279
                                           ; SOURCE LINE # 2090
                                           ; SOURCE LINE # 2091
000C 120000      R     LCALL   L?0373
                                           ; SOURCE LINE # 2092
                                           ; SOURCE LINE # 2093
                                           ; SOURCE LINE # 2094
000F         ?C0279:
000F 22                RET     
             ; FUNCTION CheckSBPowerButton (END)

             ; FUNCTION GC6_FBClamp (BEGIN)
                                           ; SOURCE LINE # 2096
                                           ; SOURCE LINE # 2097
                                           ; SOURCE LINE # 2099
0000 900000      E     MOV     DPTR,#SYS_MISC1
0003 E0                MOVX    A,@DPTR
0004 30E730            JNB     ACC.7,?C0280
0007 900000      E     MOV     DPTR,#SysPowState
000A E0                MOVX    A,@DPTR
000B 6433              XRL     A,#033H
000D 6028              JZ      ?C0280
000F E0                MOVX    A,@DPTR
0010 6455              XRL     A,#055H
0012 6023              JZ      ?C0280
                                           ; SOURCE LINE # 2100
                                           ; SOURCE LINE # 2102
0014 900000      E     MOV     DPTR,#FBClamp
0017 E0                MOVX    A,@DPTR
0018 20E235            JB      ACC.2,?C0284
                                           ; SOURCE LINE # 2103
                                           ; SOURCE LINE # 2104
001B 900000      E     MOV     DPTR,#WUEMR7
001E E0                MOVX    A,@DPTR
001F 4402              ORL     A,#02H
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2105
0022 900000      E     MOV     DPTR,#WUESR7
0025 7402              MOV     A,#02H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2106
0028 900000      E     MOV     DPTR,#IER9
002B E0                MOVX    A,@DPTR
002C 4402              ORL     A,#02H
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2107
002F 900000      E     MOV     DPTR,#FBClamp
0032 E0                MOVX    A,@DPTR
0033 4404              ORL     A,#04H
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2108
                                           ; SOURCE LINE # 2109
0036 22                RET     
0037         ?C0280:
                                           ; SOURCE LINE # 2111
                                           ; SOURCE LINE # 2113
0037 900000      E     MOV     DPTR,#FBClamp
003A E0                MOVX    A,@DPTR
003B 54FD              ANL     A,#0FDH
003D F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 100 

                                           ; SOURCE LINE # 2115
003E E0                MOVX    A,@DPTR
003F 30E20E            JNB     ACC.2,?C0284
                                           ; SOURCE LINE # 2116
                                           ; SOURCE LINE # 2117
0042 900000      E     MOV     DPTR,#IER9
0045 E0                MOVX    A,@DPTR
0046 54FD              ANL     A,#0FDH
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2118
0049 900000      E     MOV     DPTR,#FBClamp
004C E0                MOVX    A,@DPTR
004D 54FB              ANL     A,#0FBH
004F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2119
                                           ; SOURCE LINE # 2120
                                           ; SOURCE LINE # 2145
0050         ?C0284:
0050 22                RET     
             ; FUNCTION GC6_FBClamp (END)

             ; FUNCTION Lowpower_ENfunction (BEGIN)
                                           ; SOURCE LINE # 2148
                                           ; SOURCE LINE # 2149
                                           ; SOURCE LINE # 2150
0000 900000      E     MOV     DPTR,#CHGIC_WriteCmd0x12H
0003 E0                MOVX    A,@DPTR
0004 4480              ORL     A,#080H
                                           ; SOURCE LINE # 2151
0006 120000      R     LCALL   L?0376
0009 120000      E     LCALL   _bRWSMBus
000C EF                MOV     A,R7
000D 7006              JNZ     ?C0286
                                           ; SOURCE LINE # 2152
                                           ; SOURCE LINE # 2153
000F 900000      E     MOV     DPTR,#CHGIC_SMbusFailCnt
0012 E0                MOVX    A,@DPTR
0013 04                INC     A
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2155
                                           ; SOURCE LINE # 2156
0015         ?C0286:
0015 22                RET     
             ; FUNCTION Lowpower_ENfunction (END)

             ; FUNCTION Lowpower_DISfunction (BEGIN)
                                           ; SOURCE LINE # 2158
                                           ; SOURCE LINE # 2159
                                           ; SOURCE LINE # 2160
0000 900000      E     MOV     DPTR,#CHGIC_WriteCmd0x12H
0003 E0                MOVX    A,@DPTR
0004 547F              ANL     A,#07FH
                                           ; SOURCE LINE # 2161
0006 120000      R     LCALL   L?0376
0009 120000      E     LCALL   _bRWSMBus
000C EF                MOV     A,R7
000D 7006              JNZ     ?C0288
                                           ; SOURCE LINE # 2162
                                           ; SOURCE LINE # 2163
000F 900000      E     MOV     DPTR,#CHGIC_SMbusFailCnt
0012 E0                MOVX    A,@DPTR
0013 04                INC     A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 101 

0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2164
                                           ; SOURCE LINE # 2165
0015         ?C0288:
0015 22                RET     
             ; FUNCTION Lowpower_DISfunction (END)

             ; FUNCTION CheckInitPMIC (BEGIN)
                                           ; SOURCE LINE # 2186
                                           ; SOURCE LINE # 2187
                                           ; SOURCE LINE # 2188
0000 900000      E     MOV     DPTR,#PowerReturnData
0003 74FE              MOV     A,#0FEH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2189
0006 E4                CLR     A
0007 FD                MOV     R5,A
0008 7FE2              MOV     R7,#0E2H
000A 120000      R     LCALL   _PowerIICWriteByte
000D EF                MOV     A,R7
000E 7008              JNZ     ?C0289
                                           ; SOURCE LINE # 2190
                                           ; SOURCE LINE # 2191
0010 7FC1              MOV     R7,#0C1H
0012 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 2192
0015 7F00              MOV     R7,#00H
0017 22                RET     
                                           ; SOURCE LINE # 2193
0018         ?C0289:
                                           ; SOURCE LINE # 2194
0018 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 2195
001A         ?C0290:
001A 22                RET     
             ; FUNCTION CheckInitPMIC (END)

             ; FUNCTION PMICID (BEGIN)
                                           ; SOURCE LINE # 2199
                                           ; SOURCE LINE # 2200
                                           ; SOURCE LINE # 2201
0000 E4                CLR     A
0001 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
0004 F0                MOVX    @DPTR,A
0005 7E00        E     MOV     R6,#HIGH PowerVENDODID
0007 A3                INC     DPTR
0008 7400        E     MOV     A,#HIGH PowerVENDODID
000A F0                MOVX    @DPTR,A
000B 7400        E     MOV     A,#LOW PowerVENDODID
000D 120000      R     LCALL   L?0366
0010 120000      E     LCALL   _bRWSMBus
0013 EF                MOV     A,R7
0014 7003              JNZ     ?C0292
                                           ; SOURCE LINE # 2202
                                           ; SOURCE LINE # 2203
0016 120000      R     LCALL   L?0379
                                           ; SOURCE LINE # 2204
                                           ; SOURCE LINE # 2205
0019         ?C0292:
0019 22                RET     
             ; FUNCTION PMICID (END)

C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 102 

             ; FUNCTION InitPMICReg (BEGIN)
                                           ; SOURCE LINE # 2210
                                           ; SOURCE LINE # 2211
                                           ; SOURCE LINE # 2214
0000 900000      E     MOV     DPTR,#PowerVENDODID
0003 E0                MOVX    A,@DPTR
0004 7003              JNZ     ?C0293
                                           ; SOURCE LINE # 2215
                                           ; SOURCE LINE # 2216
0006 120000      R     LCALL   PMICID
                                           ; SOURCE LINE # 2217
0009         ?C0293:
                                           ; SOURCE LINE # 2219
0009 E4                CLR     A
000A 900000      E     MOV     DPTR,#PowerInitIndex
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2222
000E 900000      E     MOV     DPTR,#PowerEN_MASK
0011 7480              MOV     A,#080H
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2223
0014 900000      E     MOV     DPTR,#PowerEN_RW
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2225
0018 900000      E     MOV     DPTR,#PowerVENDODID
001B E0                MOVX    A,@DPTR
001C 900000      E     MOV     DPTR,#PowerBUCK1CTRL
001F B45315            CJNE    A,#053H,?C0294
                                           ; SOURCE LINE # 2226
                                           ; SOURCE LINE # 2227
0022 7426              MOV     A,#026H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2228
0025 742C              MOV     A,#02CH
                                           ; SOURCE LINE # 2229
                                           ; SOURCE LINE # 2230
                                           ; SOURCE LINE # 2231
0027 120000      R     LCALL   L?0382
002A 7402              MOV     A,#02H
                                           ; SOURCE LINE # 2232
                                           ; SOURCE LINE # 2234
002C 120000      R     LCALL   L?0393
                                           ; SOURCE LINE # 2235
002F 900000      E     MOV     DPTR,#PowerBUCK_FSW
0032 7403              MOV     A,#03H
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2238
0035 8012              SJMP    ?C0296
0037         ?C0294:
                                           ; SOURCE LINE # 2240
                                           ; SOURCE LINE # 2242
0037 7426              MOV     A,#026H
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2243
003A 740C              MOV     A,#0CH
                                           ; SOURCE LINE # 2244
                                           ; SOURCE LINE # 2245
                                           ; SOURCE LINE # 2246
003C 120000      R     LCALL   L?0382
003F 7404              MOV     A,#04H
                                           ; SOURCE LINE # 2247
                                           ; SOURCE LINE # 2249
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 103 

0041 120000      R     LCALL   L?0393
                                           ; SOURCE LINE # 2250
0044 E4                CLR     A
0045 900000      E     MOV     DPTR,#PowerBUCK_FSW
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2251
0049         ?C0296:
                                           ; SOURCE LINE # 2253
0049 900000      E     MOV     DPTR,#PowerInitIndex
004C E0                MOVX    A,@DPTR
004D C3                CLR     C
004E 940A              SUBB    A,#0AH
0050 5049              JNC     ?C0297
                                           ; SOURCE LINE # 2254
                                           ; SOURCE LINE # 2255
0052 E0                MOVX    A,@DPTR
0053 75F003            MOV     B,#03H
0056 A4                MUL     AB
0057 2400        R     ADD     A,#LOW powerInit
0059 F582              MOV     DPL,A
005B E4                CLR     A
005C 3400        R     ADDC    A,#HIGH powerInit
005E F583              MOV     DPH,A
0060 E4                CLR     A
0061 93                MOVC    A,@A+DPTR
0062 FF                MOV     R7,A
0063 900000      E     MOV     DPTR,#PowerInitIndex
0066 E0                MOVX    A,@DPTR
0067 75F003            MOV     B,#03H
006A A4                MUL     AB
006B 2400        R     ADD     A,#LOW powerInit+01H
006D F582              MOV     DPL,A
006F E4                CLR     A
0070 3400        R     ADDC    A,#HIGH powerInit+01H
0072 F583              MOV     DPH,A
0074 E4                CLR     A
0075 93                MOVC    A,@A+DPTR
0076 FC                MOV     R4,A
0077 7401              MOV     A,#01H
0079 93                MOVC    A,@A+DPTR
007A F582              MOV     DPL,A
007C 8C83              MOV     DPH,R4
007E E0                MOVX    A,@DPTR
007F FD                MOV     R5,A
0080 120000      R     LCALL   _PowerIICWriteByte
0083 EF                MOV     A,R7
0084 6008              JZ      ?C0298
                                           ; SOURCE LINE # 2256
                                           ; SOURCE LINE # 2257
0086 900000      E     MOV     DPTR,#PowerInitIndex
0089 E0                MOVX    A,@DPTR
008A 04                INC     A
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2258
008C 80BB              SJMP    ?C0296
008E         ?C0298:
                                           ; SOURCE LINE # 2260
                                           ; SOURCE LINE # 2261
008E 900000      E     MOV     DPTR,#PowerInitIndex
0091 E0                MOVX    A,@DPTR
0092 04                INC     A
0093 F0                MOVX    @DPTR,A
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 104 

                                           ; SOURCE LINE # 2262
0094 7FC2              MOV     R7,#0C2H
                                           ; SOURCE LINE # 2263
                                           ; SOURCE LINE # 2264
0096 120000      R     LCALL   L?0383
                                           ; SOURCE LINE # 2265
                                           ; SOURCE LINE # 2266
0099 80AE              SJMP    ?C0296
009B         ?C0297:
                                           ; SOURCE LINE # 2268
009B 7DBF              MOV     R5,#0BFH
009D 7FD1              MOV     R7,#0D1H
009F 120000      R     LCALL   _PowerIICWriteByte
00A2 EF                MOV     A,R7
00A3 7005              JNZ     ?C0301
                                           ; SOURCE LINE # 2269
                                           ; SOURCE LINE # 2270
00A5 7FC3              MOV     R7,#0C3H
                                           ; SOURCE LINE # 2271
                                           ; SOURCE LINE # 2272
00A7 120000      R     LCALL   L?0383
                                           ; SOURCE LINE # 2273
                                           ; SOURCE LINE # 2274
00AA         ?C0301:
00AA 22                RET     
00AB         L?0383:
00AB 120000      E     LCALL   _RamDebug
00AE 900000      E     MOV     DPTR,#PowerInitErrorCMD
00B1 E0                MOVX    A,@DPTR
00B2 FF                MOV     R7,A
00B3 120000      E     LCALL   _RamDebug
00B6 900000      E     MOV     DPTR,#PowerInitErrorDATA
00B9 E0                MOVX    A,@DPTR
00BA FF                MOV     R7,A
00BB 120000      E     LCALL   _RamDebug
00BE 22                RET     
             ; FUNCTION InitPMICReg (END)

             ; FUNCTION InitPMIC (BEGIN)
                                           ; SOURCE LINE # 2276
                                           ; SOURCE LINE # 2277
                                           ; SOURCE LINE # 2278
0000 900000      E     MOV     DPTR,#PowerInitOK
0003 E0                MOVX    A,@DPTR
0004 7014              JNZ     ?C0304
                                           ; SOURCE LINE # 2279
                                           ; SOURCE LINE # 2280
0006 120000      R     LCALL   CheckInitPMIC
0009 EF                MOV     A,R7
000A 600E              JZ      ?C0304
                                           ; SOURCE LINE # 2281
                                           ; SOURCE LINE # 2282
000C 120000      R     LCALL   InitPMICReg
                                           ; SOURCE LINE # 2283
000F 7FC0              MOV     R7,#0C0H
0011 120000      E     LCALL   _RamDebug
                                           ; SOURCE LINE # 2284
0014 900000      E     MOV     DPTR,#PowerInitOK
0017 7401              MOV     A,#01H
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2285
                                           ; SOURCE LINE # 2286
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 105 

                                           ; SOURCE LINE # 2287
001A         ?C0304:
001A 22                RET     
             ; FUNCTION InitPMIC (END)

             ; FUNCTION _PowerIICWriteByte (BEGIN)
                                           ; SOURCE LINE # 2289
0000 900000      R     MOV     DPTR,#Reg_offset
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2290
                                           ; SOURCE LINE # 2291
0008 E4                CLR     A
0009 900000      E     MOV     DPTR,#PMIC_counter
000C F0                MOVX    @DPTR,A
000D         ?C0305:
                                           ; SOURCE LINE # 2293
                                           ; SOURCE LINE # 2294
                                           ; SOURCE LINE # 2295
000D 900000      R     MOV     DPTR,#Reg_offset
0010 E0                MOVX    A,@DPTR
0011 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
0014 F0                MOVX    @DPTR,A
0015 A3                INC     DPTR
0016 7400        R     MOV     A,#HIGH PS_data
0018 F0                MOVX    @DPTR,A
0019 A3                INC     DPTR
001A 7400        R     MOV     A,#LOW PS_data
001C F0                MOVX    @DPTR,A
001D E4                CLR     A
001E A3                INC     DPTR
001F F0                MOVX    @DPTR,A
0020 7B68              MOV     R3,#068H
0022 7D88              MOV     R5,#088H
0024 FF                MOV     R7,A
0025 120000      E     LCALL   _bRWSMBus
0028 EF                MOV     A,R7
0029 7008              JNZ     ?C0307
                                           ; SOURCE LINE # 2296
                                           ; SOURCE LINE # 2297
002B 120000      R     LCALL   L?0379
                                           ; SOURCE LINE # 2298
002E E4                CLR     A
002F FF                MOV     R7,A
0030 120000      E     LCALL   _ResetSMBus
                                           ; SOURCE LINE # 2299
0033         ?C0307:
                                           ; SOURCE LINE # 2300
0033 900000      R     MOV     DPTR,#Reg_offset
0036 E0                MOVX    A,@DPTR
0037 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
003A F0                MOVX    @DPTR,A
003B 7E00        E     MOV     R6,#HIGH PowerReturnData
003D A3                INC     DPTR
003E 7400        E     MOV     A,#HIGH PowerReturnData
0040 F0                MOVX    @DPTR,A
0041 7400        E     MOV     A,#LOW PowerReturnData
0043 120000      R     LCALL   L?0366
0046 120000      E     LCALL   _bRWSMBus
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 106 

0049 EF                MOV     A,R7
004A 7008              JNZ     ?C0308
                                           ; SOURCE LINE # 2301
                                           ; SOURCE LINE # 2302
004C 120000      R     LCALL   L?0380
                                           ; SOURCE LINE # 2303
004F E4                CLR     A
0050 FF                MOV     R7,A
0051 120000      E     LCALL   _ResetSMBus
                                           ; SOURCE LINE # 2304
0054         ?C0308:
                                           ; SOURCE LINE # 2305
0054 900000      R     MOV     DPTR,#PS_data
0057 E0                MOVX    A,@DPTR
0058 FF                MOV     R7,A
0059 900000      E     MOV     DPTR,#PowerReturnData
005C E0                MOVX    A,@DPTR
005D 6F                XRL     A,R7
005E 7003              JNZ     ?C0309
                                           ; SOURCE LINE # 2306
                                           ; SOURCE LINE # 2307
0060 7F01              MOV     R7,#01H
0062 22                RET     
                                           ; SOURCE LINE # 2308
0063         ?C0309:
                                           ; SOURCE LINE # 2310
                                           ; SOURCE LINE # 2311
0063 900000      E     MOV     DPTR,#PMIC_counter
0066 E0                MOVX    A,@DPTR
0067 B40503            CJNE    A,#05H,?C0312
                                           ; SOURCE LINE # 2312
                                           ; SOURCE LINE # 2313
006A 7F00              MOV     R7,#00H
006C 22                RET     
                                           ; SOURCE LINE # 2314
006D         ?C0312:
                                           ; SOURCE LINE # 2315
006D 900000      R     MOV     DPTR,#Reg_offset
0070 E0                MOVX    A,@DPTR
0071 900000      E     MOV     DPTR,#PowerInitErrorCMD
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2316
0075 900000      E     MOV     DPTR,#PowerReturnData
0078 E0                MOVX    A,@DPTR
0079 900000      E     MOV     DPTR,#PowerInitErrorDATA
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2317
007D 900000      E     MOV     DPTR,#PMIC_counter
0080 E0                MOVX    A,@DPTR
0081 04                INC     A
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 2318
                                           ; SOURCE LINE # 2319
0083 020000      R     LJMP    ?C0305
             ; FUNCTION _PowerIICWriteByte (END)

             ; FUNCTION PollingOTP (BEGIN)
                                           ; SOURCE LINE # 2322
                                           ; SOURCE LINE # 2323
                                           ; SOURCE LINE # 2324
0000 900000      E     MOV     DPTR,#PowerInitOK
0003 E0                MOVX    A,@DPTR
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 107 

0004 6401              XRL     A,#01H
0006 706C              JNZ     ?C0318
                                           ; SOURCE LINE # 2325
                                           ; SOURCE LINE # 2327
0008 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
000B 74D6              MOV     A,#0D6H
000D F0                MOVX    @DPTR,A
000E 7E00        E     MOV     R6,#HIGH PowerOVP_REG
0010 A3                INC     DPTR
0011 7400        E     MOV     A,#HIGH PowerOVP_REG
0013 F0                MOVX    @DPTR,A
0014 A3                INC     DPTR
0015 7400        E     MOV     A,#LOW PowerOVP_REG
0017 120000      R     LCALL   L?0367
001A 120000      E     LCALL   _bRWSMBus
001D EF                MOV     A,R7
001E 7003              JNZ     ?C0314
                                           ; SOURCE LINE # 2328
                                           ; SOURCE LINE # 2329
0020 120000      R     LCALL   L?0380
                                           ; SOURCE LINE # 2330
0023         ?C0314:
                                           ; SOURCE LINE # 2331
0023 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
0026 74D7              MOV     A,#0D7H
0028 F0                MOVX    @DPTR,A
0029 7E00        E     MOV     R6,#HIGH PowerUVP_REG
002B A3                INC     DPTR
002C 7400        E     MOV     A,#HIGH PowerUVP_REG
002E F0                MOVX    @DPTR,A
002F A3                INC     DPTR
0030 7400        E     MOV     A,#LOW PowerUVP_REG
0032 120000      R     LCALL   L?0367
0035 120000      E     LCALL   _bRWSMBus
0038 EF                MOV     A,R7
0039 7003              JNZ     ?C0315
                                           ; SOURCE LINE # 2332
                                           ; SOURCE LINE # 2333
003B 120000      R     LCALL   L?0380
                                           ; SOURCE LINE # 2334
003E         ?C0315:
                                           ; SOURCE LINE # 2335
003E 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
0041 74D8              MOV     A,#0D8H
0043 F0                MOVX    @DPTR,A
0044 7E00        E     MOV     R6,#HIGH PowerOCP_REG
0046 A3                INC     DPTR
0047 7400        E     MOV     A,#HIGH PowerOCP_REG
0049 F0                MOVX    @DPTR,A
004A A3                INC     DPTR
004B 7400        E     MOV     A,#LOW PowerOCP_REG
004D 120000      R     LCALL   L?0367
0050 120000      E     LCALL   _bRWSMBus
0053 EF                MOV     A,R7
0054 7003              JNZ     ?C0316
                                           ; SOURCE LINE # 2336
                                           ; SOURCE LINE # 2337
0056 120000      R     LCALL   L?0380
                                           ; SOURCE LINE # 2338
0059         ?C0316:
                                           ; SOURCE LINE # 2340
0059 900000      E     MOV     DPTR,#?_bRWSMBus?BYTE+03H
C51 COMPILER V8.12   OEM_POWER                                                             07/28/2018 12:03:46 PAGE 108 

005C 74D9              MOV     A,#0D9H
005E F0                MOVX    @DPTR,A
005F 7E00        E     MOV     R6,#HIGH PowerOTP_REG
0061 A3                INC     DPTR
0062 7400        E     MOV     A,#HIGH PowerOTP_REG
0064 F0                MOVX    @DPTR,A
0065 A3                INC     DPTR
0066 7400        E     MOV     A,#LOW PowerOTP_REG
0068 120000      R     LCALL   L?0367
006B 120000      E     LCALL   _bRWSMBus
006E EF                MOV     A,R7
006F 7003              JNZ     ?C0318
                                           ; SOURCE LINE # 2341
                                           ; SOURCE LINE # 2342
0071 120000      R     LCALL   L?0380
                                           ; SOURCE LINE # 2344
                                           ; SOURCE LINE # 2345
                                           ; SOURCE LINE # 2346
0074         ?C0318:
0074 22                RET     
             ; FUNCTION PollingOTP (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4533    ----
   CONSTANT SIZE    =    350    ----
   XDATA SIZE       =   ----       5
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
